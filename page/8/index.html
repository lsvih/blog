<!DOCTYPE html>













<html class="theme-next pisces" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '6U6P1RGK4F',
      apiKey: 'b14e73cdd627eabe947b5decbe14850f',
      indexName: 'lsvih',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="My note">
<meta property="og:url" content="https://lsvih.com/page/8/index.html">
<meta property="og:site_name" content="My note">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My note">



  <link rel="alternate" href="/atom.xml" title="My note" type="application/atom+xml">




  <link rel="canonical" href="https://lsvih.com/page/8/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>My note – lsvih</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4de170e51b04cee02fbdb1b7cb7a8a60";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">lsvih</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/04/10/模块化-vs-微服务/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/10/模块化-vs-微服务/" class="post-title-link" itemprop="url">模块化 vs. 微服务</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-10 14:50:00" itemprop="dateCreated datePublished" datetime="2017-04-10T14:50:00+08:00">2017-04-10</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Translate/" itemprop="url" rel="index"><span itemprop="name">Translate</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>使用模块化系统设计原则来避免微服务的复杂性。</p>
<p><img src="/images/pasted-118.png" alt="upload successful"></p>
<p>从单体式应用向微服务架构迁移已经是老生常谈的话题了。除了过过嘴瘾，似乎真的动手将单体式应用拆分成微服务也不是什么很困难的事。但是这种做法真的是你们团队的最佳选择吗？维护一个凌乱的单体式应用的确很伤脑筋，但是还有另一种优秀但常常被人忽视的替代方案：模块化应用开发。本文将探讨这种替代方案，并展现其与构建微服务的关系。</p>
<h2 id="模块化微服务"><a href="#模块化微服务" class="headerlink" title="模块化微服务"></a>模块化微服务</h2><p>“通过微服务，我们终于能够让团队独立工作了”或者“我们的单体式应用实在太复杂了，它降低了我们的工作效率”之类的话，只是让团队改用微服务架构的诸多原因中的一小部分；还有一种说法是需要可拓展性与弹性。所有开发人员似乎都渴望系统设计和开发的模块化。软件开发中的模块化可以总结为以下三个原则：</p>
<ul>
<li><strong>强大的封装性</strong>：隐藏了各个组件内部实现的细节，减少了不同组件之间的耦合性。团队可以在系统的各个非耦合部分中独立地工作。</li>
<li><strong>定义良好的接口</strong>：你不可能隐藏组件内的所有东西（否则你的系统将毫无意义），因此有必要在组件之间定义良好且可靠的 API。任意一个组件都可以被符合接口规范的其它组件替换。</li>
<li><strong>显式依赖</strong>：模块化系统意味着不同的组件需要在一起工作。因此你最好能有一种途径来表达（与验证）它们之间关系。</li>
</ul>
<p>这些原则都可以用微服务架构来实现。只要做到对其它服务暴露定义明确的接口（通常是一个 REST API），就能以任意方式来实现一个微服务。它的实现细节是这个服务内部的事情，你可以改变这些实现细节而不影响整个系统。微服务之间的依赖关系通常在开发时是不明确的，这可能会导致在运行时服务编排失败。只能说在大多数微服务架构中，实现最后一条模块化原则还需要再接再厉。</p>
<p>因此，微服务架构实现了重要的模块化原则，并带来了以下三点实实在在的好处：</p>
<ul>
<li>团队能够独立地工作与扩张。</li>
<li>微服务小巧、专一，降低了复杂度。</li>
<li>服务可以在不会影响全局的情况下内部进行更改或者替换。</li>
</ul>
<p>那么微服务架构的缺点是什么呢？当你从一个单体式（虽然有点臃肿）应用切换成微服务分布式系统的时候，给表操作带来了巨大的复杂性。突然间，你发现你要不断地部署各种不同的（可能是由容器包装的）服务。这时，服务发现、分布式日志记录、跟踪等新的问题出现了。现在，你更加容易出现<a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing" target="_blank" rel="noopener">分布式计算的谬论</a>造成的错误。接口的版本管理与配置管理成为你面对的主要问题。各种问题将数不胜数向你涌来。</p>
<p>事实证明，由于所有的微服务个体都需要联合起来实现业务逻辑，微服务之间的连接将变得无比复杂。看到这里，你应该意识到不能简单地将单体式应用拆分成微服务了。单体式应用中的“意大利面条式代码”问题重重，在其中再加上网络边界会将这些纠缠在一起的问题升级成彻头彻尾的痛苦。</p>
<ul>
<li>译注：<a href="http://www.ituring.com.cn/article/10311" target="_blank" rel="noopener">什么是意大利面式代码</a></li>
</ul>
<h2 id="模块化的替代方案"><a href="#模块化的替代方案" class="headerlink" title="模块化的替代方案"></a>模块化的替代方案</h2><p>这是否意味着我们要么沉没在混乱的单体式应用中，要么淹没在令人抓狂的微服务复杂性中呢？其实，模块化也可以通过其它方式实现。在开发时最重要的是正确地规划项目边界并实施方案，我们也可以通过创建一个结构良好的单体式应用来实现这一点。当然，这意味着我们将尽可能利用编程语言与开发工具的协助来实现模块化原则。</p>
<p>例如在 Java 中，有几个可以帮助你构建应用的模块系统。OSGi 是其中最著名的一个，不过随着 Java 9 的发布，Java 平台将加入一个原生的模块系统。现在模块作为一等结构（first-class construct），成为了语言和平台的一部分。Java 模块可以表明对其它模块的依赖，以及在强封装实现类的时候公开暴露接口。甚至 Java 平台本身（一个庞大的代码库）已经使用了新的 Java 模块系统进行模块化。你可以在我即将出版的书<a href="https://www.safaribooksonline.com/library/view/java-9-modularity/9781491954157/?utm_source=newsite&amp;utm_medium=content&amp;utm_campaign=lgen&amp;utm_content=modules-vs-microservices-inline" target="_blank" rel="noopener">Java 9 Modularity</a>中了解有关 Java 9 模块化开发的更多信息。（现早期版本已经发布）</p>
<p>其它的语言也提供了类似的机制。例如，JavaScript 在 ES2015 规范中提供了一个<a href="http://exploringjs.com/es6/ch_modules.html" target="_blank" rel="noopener">模块系统</a>。在此之前，Node.js 也为 JavaScript 后端提供了一个非标准的模块系统。然而 JavaScript 作为一种动态语言，对于强制接口（类型）与模块封装的支持还是较弱。你可以考虑在 JavaScript 的基础上使用 TypeScript 来重新获得这些优点。微软的 .Net 框架与 Java 一样都有着强类型，但就强封装以及程序集（Assemblies）间的显式依赖而言，它与 Java 即将推出的模块系统并不相同。尽管如此，你可以通过使用 <a href="https://msdn.microsoft.com/en-us/magazine/mt707534.aspx" target="_blank" rel="noopener">.Net Core</a> 中标准化的反转控制模式（IOC）以及创建逻辑相关的程序集来实现良好的模块化架构。即使是 C++ 也在以后的版本中<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4610.pdf" target="_blank" rel="noopener">考虑添加</a>模块系统。许多语言都在向模块化靠近，这本身就是一个显著的进步。</p>
<p>当你有意识地使用你的开发平台的模块化特性时，你就可以实现之前提及的微服务的模块化优势。基本上模块系统越好，你在开发过程中获得的帮助就越多。只要在不同团队间的接触点定义好明确的接口，不同的团队也可以独立进行不同部分的工作。当然，在部署时还是要将模块在一个单独的部署单元中组合起来。这样可以防止过于复杂，以及减少迁移到微服务所需要的开发与管理成本。诚然，这也意味着你不能使用不同的技术栈来构建不同的模块，但你的团队应该不会真的这么做吧？</p>
<h2 id="模块设计"><a href="#模块设计" class="headerlink" title="模块设计"></a>模块设计</h2><p>创建好的模块和创建好的微服务一样，都需要严谨的设计。一个模块应该基于其域的有界上下文建模（DDD）。选择微服务的边界是架构上重要的决策，一旦出错就可能要付出沉重的代价。相较而言，模块化应用程序模块的边界更容易修改一些。模块间的重构通常由类型系统和编译器支持。微服务边界的重新划分则涉及大量的进程间通信（IPC），以确保运行时稳定性。老实说，你真的只用一次两次就能正确的划分好边界？</p>
<p>在许多方面，静态语言的模块为了定义明确的接口而提供了更好的结构。通过调用另一个模块暴露的接口提供的方法，比去调用另一个微服务的 REST 端点健壮性要强的多。REST+JSON 现在无处不在，但在没有编译器检查的情况下，它并没有”类型良好的互通性“这个特点。而事实上，通过网络序列化（或者反序列化）数据并不是无开销的，甚至这种传输方式更加逊色。此外，许多模块化系统允许你表明此模块对于其它模块的依赖关系，模块系统将不允许违背这些依赖关系的情况出现。而微服务之间的依赖关系只在运行时实现，导致系统难以调试。</p>
<p>模块也是代码所有权中的自然单位。一个团队可以负责系统中的一个或者多个模块，而只需要给其它团队提供模块的公共 API。在运行时，模块之间的隔离比微服务少，毕竟模块化单体式应用的所有模块都运行在同一个进程中。</p>
<ul>
<li>译注：<a href="http://blog.csdn.net/mfowler/article/details/974251" target="_blank" rel="noopener">什么是代码所有权</a></li>
</ul>
<p>毫无疑问，单体式应用的模块不可能像微服务一样有自己的数据。模块化应用内部的数据交流是通过定义良好的接口或者模块间的消息进行的，而不是通过共享数据存储进行。它与微服务最大的差别就是它的一切都发生在同一个进程中，因此同样不能低估最终的数据一致性问题。对于模块来说，最终的一致性问题可以是一个策略问题，或者你也可以仅将数据”逻辑地“分开存储在同一数据库内并仍然使用跨域事务。而对于微服务来说，这个问题别无选择：必须保证最终的一致性。</p>
<h2 id="何时微服务才适用于你的团队？"><a href="#何时微服务才适用于你的团队？" class="headerlink" title="何时微服务才适用于你的团队？"></a>何时微服务才适用于你的团队？</h2><p>那么何时迁移到微服务架构才合适呢？到目前为止，我们主要关注的是如何通过模块化来解决复杂性问题。对于这一点，微服务与模块化应用都可以做到，只不过各有所难。</p>
<p>当你的团队有如同 Google 或者 Netflix 般的规模的时候，拥抱微服务是毋庸置疑的。你有能力去建立你自己的平台与工具库，并且工程师的数量排除了任何使用单体式解决方案的可能。但是大多数的组织都达不到这个规模。即使你认为你的公司有朝一日将成为一个市值十亿美元的独角兽，在刚起步时使用模块化的单体式应用也无伤大雅。</p>
<p>另一个拆分微服务的理由是：不同的服务在实现上更适合使用不同的技术栈。那么，你必须有足够的规模来吸引人才以解决这些迥然不同的技术栈，并支持这些平台的运行。</p>
<p>微服务还可以做到独立部署系统的不同部分，这在大多数模块化平台中很难（甚至不可能）实现。隔离部署增加了系统的弹性与容错能力。此外，每个微服务的缩放特性可以是不同的，可以部署不同的微服务以匹配硬件。模块化的单体式应用可以进行水平缩放，但是只能将所有模块捆绑在一起同时进行拓展。虽然你可以通过这种方法得到很多好处，但这可能并不是最好的解决方案。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总之，最好的方案就是找到一个折中的点。这两种方案都有可取之处，需要根据实际环境、组织和应用本身进行选择。既然你可以在之后迁移成微服务架构，那为什么最开始不直接使用模块化应用呢？如果你之前就已经划分好了模块边界，那也就不需要再去拆分你的单体式应用了。甚至你还可以在模块内部搭建微服务架构。那么问题就变成了：为什么微服务一定要是“微”的呢？</p>
<p>即使你的应用刚从模块化应用转成微服务架构，服务也不必非得很“微”才具备可维护性。在服务中应用模块化原则能让它们在复杂度的可扩展性上超越通常的微服务。现在这份蓝图中既有微服务也有模块，减少架构中的服务的数量可以节约成本；而其中的模块可以像构建单体式应用一样，构建和扩展服务。</p>
<p>如果你追求模块化的好处，请确保自己不要自嗨进入一种“非微服务不可”的心态。探索你喜爱的技术栈中的同进程模块化功能或框架，你将会得到支持去真正的执行模块化设计，而不是仅靠着约定来避免“意大利面条式代码”。最后，请深思熟虑后再选择：你是否愿意接受引入微服务造成的复杂度成本。有的时候你别无选择，但更多的时候其实你可以找到更好的解决方案。</p>
<blockquote>
<p>发布于掘金 <a href="https://juejin.im/post/58eb2627da2f60005f0b2d60" target="_blank" rel="noopener">https://juejin.im/post/58eb2627da2f60005f0b2d60</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/04/01/一名-iOS-开发者的-React-Native-开发经历-md/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/04/01/一名-iOS-开发者的-React-Native-开发经历-md/" class="post-title-link" itemprop="url">一名 iOS 开发者的 React Native 开发经历.md</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-04-01 15:12:00" itemprop="dateCreated datePublished" datetime="2017-04-01T15:12:00+08:00">2017-04-01</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Translate/" itemprop="url" rel="index"><span itemprop="name">Translate</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>如果你是一名 iOS 开发者，你应该听说过 React Native。它给出了简单而吸引人的承诺：一次编写，两处部署，同时搞定 iOS 与安卓版本的 app。我是一名资深的 iOS 开发者（还是一名更资深的 macOS 开发者），我想分享我应用这门神奇技术的经历。</p>
<p>去年，我们和一个客户进行过交谈。他们来找我们是因为他们想尽快完成他们的 iOS app。在讨论的过程中，他们提到了这个叫做 React Native 的东西。他们有个善于使用 Javascript 的 web 开发人员，那个人指出使用 RN 可以让开发速度快很多。这场谈判最终我们没有达成共识而是以失败告终，但这件事也让我开始思考是否应该将 RN 纳入我们的技术栈中</p>
<p>几周后一位老友来访，让我为他出版的一本书制作一个 app 作为补充参考资料。因为这个工作我找到了一线机会：这是一个很棒的时机来试一试 React Native。由于他的读者大多数使用安卓系统，因此「一次编写，两处部署」的理念在此深得我心。</p>
<p>我不会带你亲历一遍我的各种尝试和遇到的问题。但我要说的是，就这么一个简单的 app，并不能使用 RN 很好的进行开发。以下是原因。</p>
<p>首先，我必须说一下除开「一次编写，两处部署」的承诺，我喜欢 React Native 的地方。</p>
<ul>
<li>React.js，RN 由它而生。它是一种描述与更新 UI 的优雅方法。它的基本原理是组件使用一组传递给它的属性由上到下渲染其 UI。感谢 React 的虚拟 DOM，当属性变化时 UI 会立即更新，使得 model 与 view 能够自动且无缝地同步。我多么希望 iOS 的 UIKit 也这样设计啊！</li>
<li>更新 JSX 代码就可以在模拟器中更新 app 而不需要重新编译与重新运行，这点真的很棒。</li>
<li>蓬勃发展的 RN 社区提供了数以百计的预制组件，你可以在你的 app 中使用它们。（实际上我非常讨厌这种看似专业的「脚本小子」的编程方法。构建一个大部分都不是你自己写的，并且弄不明白的 app，将会导致之后的维护如同陷入泥潭一般困难）</li>
<li>我很担心 RN 的性能，但是在我的经历中它并没有出现问题。滚动和动画都很流畅。毕竟 RN app 大部分使用的是平台原生的 UI 控件，RN 的工程师们也对它们进行了很好的优化。</li>
</ul>
<p>那么为什么我不喜欢它呢？老实说，我并不是 React Native 的目标用户。我熟悉 Javascript 但我并不精通它，我精通的是 Swift/Objective-C。我很快就意识到，如果我使用 RN 来完成这个 app，将会比我用 Swift 慢 10-20 倍。当然，安卓版本还要单独写，但是考虑到我学习 RN 的学习曲线，我还不如去学习 Java。</p>
<p>除此之外，我认为采用 RN 的解决方案还有一些严重的问题。</p>
<h3 id="脆弱的依赖链"><a href="#脆弱的依赖链" class="headerlink" title="脆弱的依赖链"></a>脆弱的依赖链</h3><p>React Native 并不是一个一站式解决方案。我制作了一个粗略的必要组件依赖图：</p>
<p><img src="/images/pasted-117.png" alt="upload successful"></p>
<p>React Native 的依赖链</p>
<p>如果你来自 web 开发的世界，这可能对你来说很正常；但是对我来说，这很不正常。我的世界中有 Xcode，任何创建 Swift/Obj-C/iOS/Mac/Apple TV 等 app 所需要的东西都已经封装好并由 Xcode 管理。依赖链和前面的图一样（甚至更长），<strong>但是依赖链中的东西都保证是同步且兼容的。</strong></p>
<p>我现在肯定 RN 依赖链中的大多数组件都是互相兼容的。但我遇到了四五个需要在 StackOverflow 上花几小时寻求解决方案的问题。在我心中更重要的是之后会发生的事情。例如，升级 Nuclide（IDE 的 RN 拓展）可能需要新版的 Atom。我系统中的另一个工具需要新版的 <code>winston</code>，如果那个版本不兼容 RN 怎么办？后果可想而知。</p>
<h3 id="被打破的承诺"><a href="#被打破的承诺" class="headerlink" title="被打破的承诺"></a>被打破的承诺</h3><p>事实证明「一次编写，两处部署」的承诺只有部分实现了。我遇到了必须要把我的 RN app 根据目标平台（iOS 或安卓）进行「分支」的问题。例如 tab bar，你可能认为像它这么随处可见的组件会被 RN 列为「一等公民」，但事实不是这样的。RN 为 iOS 收录了 <code>TabBarIOS</code> 组件，但是因为某些原因它在安卓上并不相同。相反，在 GitHub 上有一堆的教程和解决方案教你如何从头做起。又例如 nav bar，iOS 的 <code>NavigatorIOS</code> 与安卓的 <code>Navigator</code> 工作方式差别巨大。这些核心的导航功能结构在两个平台上的差异会导致要为每个平台分别编写大量的不同的文件与组件。我开始感觉到，尽管承诺很神奇，尽管我在用同一种语言，但其实我仍然在写两个不同的 app。</p>
<ul>
<li>实际上，这个「承诺」其实是别人推断的，并不是官方宣称的（至少 Facebook/RN 的人没有这么宣称过）。官方宣传的是「一次学习，随处编写」。</li>
</ul>
<h3 id="令人惊讶的技术限制"><a href="#令人惊讶的技术限制" class="headerlink" title="令人惊讶的技术限制"></a>令人惊讶的技术限制</h3><p>我在做的这个项目其实是一个层级化的参考指南。书作者和我为目录与文章用我们设计的 UI 范式规划了一套挺合理的布局。根据我们的想法，我们可以通过链接或导航跳转到数百个使用静态内容的详情页中。我写好了代码，但奇怪的是我调用 <code>require()</code> 一直不成功。我经过一段时间的研究，了解到 RN 限制<strong>您无法从任意路径读取文件</strong>。显然你的 RN app 在编译时收集了所有可能用到的路径，任何编译器无法找到的路径都将不能读取。所以你可以用 <code>require(‘../file1.json’)</code> 但不能用 <code>require(‘../file’ + ‘1’ + ‘.json’)</code>。这个让人惊讶的限制使得我们的架构无法实现。</p>
<h3 id="冒牌货般的-UI"><a href="#冒牌货般的-UI" class="headerlink" title="冒牌货般的 UI"></a>冒牌货般的 UI</h3><p>你最终完成的 RN app 可能既不像原生的 iOS app 也不像原生的安卓 app。大多数用户可能不会察觉这个问题，但有些人会发现更大的问题。你有可能会丢失一些用户会注意到的平台特有的细节，例如不能从左侧右滑来返回。（当你用 <code>NavigatorIOS</code> 完成两个平台的导航时会出现这个问题）</p>
<p>总而言之，iOS 开发者不应该将 React Native 视为两个平台的跨平台解决方案。写一个原生的 iOS app 将会花费<strong>更少</strong>的时间并可能得到更棒的 UX。对于安卓 app 也一样，所以我认为大家应该更多的去专注于平台原生解决方案。</p>
<p>什么时候用 RN 才是正确的呢？如果你是一个专业的 Javascript 程序员或者你有这么一个员工，并且你<strong>不打算</strong>配置 iOS 开发或安卓开发人员，那么你<strong>可能</strong>会从中获益。还记得那个想要尽快做好跨平台 app 的那个客户吗？他们<strong>曾</strong>有一名 Javascript 工程师，他们 app 的 v1.0 版本最近才出现在应用商店中。此时，距他们联系我们已经过去了 8 个月。</p>
<blockquote>
<p>发布于掘金 <a href="https://juejin.im/post/58df4c3fa0bb9f0069e2f2bd" target="_blank" rel="noopener">https://juejin.im/post/58df4c3fa0bb9f0069e2f2bd</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/23/EM-algorithm-in-python/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/03/23/EM-algorithm-in-python/" class="post-title-link" itemprop="url">EM algorithm in python</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-23 01:15:00" itemprop="dateCreated datePublished" datetime="2017-03-23T01:15:00+08:00">2017-03-23</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由<a href="http://lsvih.com/?p=515">之前的学习笔记</a> 使用python实现EM算法。</p>
<p><a href="https://github.com/lsvih/algorithm-practice/tree/master/em" target="_blank" rel="noopener">代码地址</a></p>
<h2 id="EM-algorithm"><a href="#EM-algorithm" class="headerlink" title="EM algorithm"></a>EM algorithm</h2><script type="math/tex; mode=display">\text{Repeat until convergence}\{\\
\text{(E-step) For each i,set}\\
 Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)\\
 \text{(M-step) set}\\
 \theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}\}</script><h2 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h2><p>和上一篇k-means一样，从准备数据开始。EM算法可以用来对数据集中数据的分布参数进行极大似然估计。因此，为它准备两组一维高斯分布数据。</p>
<p>使用numpy的randn函数来生成正态分布数据，使用matplotlib来对其进行可视化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.randn.html#numpy.random.randn" target="_blank" rel="noopener">参考numpy的文档</a>，生成一个[latex]N(mu,sigma^2)[/latex]的正态分布，需要使用</p>
<p>mu + sigma * np.random.randn(..)</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateDataAndShow</span><span class="params">()</span>:</span></span><br><span class="line">    x1,x2 = mu1 + sigma * np.random.randn(<span class="number">500</span>),mu2 + sigma * np.random.randn(<span class="number">500</span>)</span><br><span class="line">    x = np.append(x1,x2)</span><br><span class="line">    plt.hist(x,<span class="number">50</span>,normed=<span class="keyword">True</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    data = generateDataAndShow()</span><br></pre></td></tr></table></figure>
<p>这样，就得到了两组分别以[latex]N(mu_1,sigma^2)[/latex]与[latex]N(mu_2,sigma^2)[/latex]分布的数据集。通过matplotlib可以看到它们的分布概率图大致如下：</p>
<p><img src="/images/pasted-115.png" alt="upload successful"></p>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p>算法的推导与分析在<a href="http://lsvih.com/?p=515">http://lsvih.com/?p=515</a> 进行过了。总体来说是一个迭代渐进的过程。渐进的变量有两个，一个是实现分类的隐藏变量z，另一个是决定分布函数的参数[latex]theta[/latex]。</p>
<h3 id="E-step"><a href="#E-step" class="headerlink" title="E-step"></a>E-step</h3><p>已知高斯函数的概率密度函数(PDF)为</p>
<script type="math/tex; mode=display">f(x,\sigma,\mu)=\frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i,X <span class="keyword">in</span> enumerate(data):</span><br><span class="line">    p1 = np.exp(-(X-mu1)**<span class="number">2</span>/(<span class="number">2</span>*sigma**<span class="number">2</span>))/(sigma*(np.sqrt(<span class="number">2</span>*np.pi)))</span><br><span class="line">    p2 = np.exp(-(X-mu2)**<span class="number">2</span>/(<span class="number">2</span>*sigma**<span class="number">2</span>))/(sigma*(np.sqrt(<span class="number">2</span>*np.pi)))</span><br><span class="line">    Z[i,<span class="number">0</span>],Z[i,<span class="number">1</span>] = p1/(p1+p2),p2/(p1+p2)</span><br></pre></td></tr></table></figure>
<p>即实现$Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)$</p>
<h3 id="M-step"><a href="#M-step" class="headerlink" title="M-step"></a>M-step</h3><p>data为矩阵</p>
<script type="math/tex; mode=display">\begin{bmatrix}x_1\\x_2\\...\\x_n\end{bmatrix}</script><p>而Z为矩阵</p>
<script type="math/tex; mode=display">\begin{bmatrix}Z^{(1)}_1&Z^{(1)}_2\\Z^{(2)}_1&Z^{(2)}_2\\...\\Z^{(n)}_1&Z^{(n)}_2\end{bmatrix}</script><p>因此完成$\theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}$运算可以使用矩阵的点乘实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mu1,mu2 = np.dot(np.array(data),np.array(Z))/np.sum(Z,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>在对于E-step与M-step不停的迭代优化后，达到一个期望精度值停止运算。因此main()可以写成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    o_mu1,o_mu2 = mu1,mu2</span><br><span class="line">    Z = np.zeros([len(data),<span class="number">2</span>])</span><br><span class="line">    <span class="comment">#E-Step</span></span><br><span class="line">    <span class="comment">#M-Step</span></span><br><span class="line">    <span class="keyword">if</span> abs(o_mu1-mu1)+abs(o_mu2-mu2) &lt;= <span class="number">0.001</span>:</span><br><span class="line">        <span class="keyword">print</span> mu1,mu2</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>在迭代至指定精度后，将得到的mu1与mu2与sigma决定的正态分步曲线画出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Darw Gaussian function</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.mlab <span class="keyword">as</span> mlab</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">n,bins,p = ax.hist(data,<span class="number">50</span>,normed=<span class="keyword">True</span>)</span><br><span class="line">y1,y2 = mlab.normpdf(bins, mu1, sigma), mlab.normpdf(bins, mu2, sigma)</span><br><span class="line">ax.plot(bins, y1/<span class="number">2</span>)</span><br><span class="line">ax.plot(bins, y2/<span class="number">2</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>可以看到，最初的generateData函数中画出的图形为</p>
<p><img src="/images/pasted-115.png" alt="upload successful"></p>
<p>得到结果后画出的曲线为</p>
<p><img src="/images/pasted-116.png" alt="upload successful"></p>
<p>基本能匹配之前生成的数据。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/22/python实现k-means分类算法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/03/22/python实现k-means分类算法/" class="post-title-link" itemprop="url">python实现k-means分类算法</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-22 01:51:00" itemprop="dateCreated datePublished" datetime="2017-03-22T01:51:00+08:00">2017-03-22</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>准备实现一些算法，顺带复习numpy，因此将比较简单的k-means算法用python实现一次。</p>
<h2 id="k-means算法"><a href="#k-means算法" class="headerlink" title="k-means算法"></a>k-means算法</h2><p><img src="/images/pasted-109.png" alt="upload successful"></p>
<h2 id="准备数据集"><a href="#准备数据集" class="headerlink" title="准备数据集"></a>准备数据集</h2><p>首先，考虑数据集来源。懒得去找数据，因此直接用scikit的dataset模块随机生成一组聚类数据。既然要生成聚类数据，用make_blobs是再好不过了。<a href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs" target="_blank" rel="noopener">sklearn.dataset.make_blobs文档</a></p>
<p>为了直观地展示数据，用matplotlib来进行数据可视化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateDataAndShow</span><span class="params">()</span>:</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.title(<span class="string">"Dataset"</span>, fontsize=<span class="string">'small'</span>)</span><br><span class="line">    datas, class_info = make_blobs(n_samples=<span class="number">200</span> ,n_features=<span class="number">2</span>, centers=<span class="number">3</span>)</span><br><span class="line">    plt.scatter(datas[:, <span class="number">0</span>], datas[:, <span class="number">1</span>], marker=<span class="string">'o'</span>, c=class_info)</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="keyword">return</span> datas</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    data = generateDataAndShow()</span><br></pre></td></tr></table></figure>
<p>可以得到一个有三个聚类，共200个点的数据集。如图所示</p>
<p><img src="/images/pasted-110.png" alt="upload successful"></p>
<p>且每次运行都会生成不同的数据。</p>
<p>此时，得到200对坐标数据以及相应的分类数据。仅将坐标数据拿出来进行计算。</p>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p>1、随机生成3个点，作为初始聚类中心。为了减少计算量，所以将3个点生成在所有点的值域中。此时data的数据结构是Float[][]，第一重数组为一个点，第二重数组为点的两个坐标。因此需要用到numpy的amax函数与amin函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x_max, y_max], [x_min, y_min] = np.amax(data,axis=<span class="number">0</span>),np.amin(data,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>使用numpy.random的rand生成一组点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">centers = np.random.rand(<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">centers[<span class="number">0</span>:,<span class="number">0</span>] = (x_max-x_min)*centers[<span class="number">0</span>:,<span class="number">0</span>]+x_min</span><br><span class="line">centers[<span class="number">0</span>:,<span class="number">1</span>] = (y_max-y_min)*centers[<span class="number">0</span>:,<span class="number">1</span>]+y_min</span><br></pre></td></tr></table></figure>
<p>这样就得到了在值域内的3个随机点。</p>
<p>2、计算距离。二维平面内两个点的距离公式为</p>
<script type="math/tex; mode=display">d=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}</script><p>因此可以计算出每个点分别到三个聚类中心的距离：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(data, dots)</span>:</span></span><br><span class="line">    rs = []</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">        rs.append([])</span><br><span class="line">        <span class="keyword">for</span> dot <span class="keyword">in</span> dots:</span><br><span class="line">            rs[<span class="number">-1</span>].append(((d[<span class="number">0</span>]-dot[<span class="number">0</span>])**<span class="number">2</span>+(d[<span class="number">1</span>]-dot[<span class="number">1</span>])**<span class="number">2</span>)**<span class="number">0.5</span>)</span><br><span class="line">    <span class="keyword">return</span> rs</span><br></pre></td></tr></table></figure>
<p>3、分组。根据计算得到的各个点距离聚类中心的距离，可以判断这个点是属于哪一个聚类的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify</span><span class="params">(dis)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [i.index(min(i)) <span class="keyword">for</span> i <span class="keyword">in</span> dis]</span><br></pre></td></tr></table></figure>
<p>返回一个分类索引数组。这个时候也可以用plt将此时的分类打印出来，和最开始的正确聚类对比一下：</p>
<p><img src="/images/pasted-111.png" alt="upload successful"></p>
<p><img src="/images/pasted-112.png" alt="upload successful"> </p>
<p>考虑一种特殊情况：只分出两个聚类。这时候将无法继续计算下去，应当重新随机生成中心。</p>
<p>4、移动聚类中心。根据随机得到的初始聚类，重新计算每个聚类的质心作为其新的聚类中心。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calCenters</span><span class="params">(data, clazz)</span>:</span></span><br><span class="line">    clz = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>)]</span><br><span class="line">    <span class="keyword">for</span> index,dot <span class="keyword">in</span> enumerate(data):</span><br><span class="line">        clz[clazz[index]].append(dot)</span><br><span class="line">    <span class="keyword">return</span> [sum(x)/len(x) <span class="keyword">for</span> x <span class="keyword">in</span> clz]</span><br></pre></td></tr></table></figure>
<p>得到了新的聚类中心</p>
<p>5、循环上述步骤，直到收敛。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    new_centers = calCenters(data, clazz)</span><br><span class="line">    <span class="keyword">if</span> equal(new_centers,centers):<span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        centers = new_centers</span><br><span class="line">        clazz = classify(distance(data,centers))</span><br></pre></td></tr></table></figure>
<p>收敛条件是聚类中心点不再变化。</p>
<p>最终代码：<a href="https://github.com/lsvih/algorithm-practice/blob/master/k-means/k-means.py" target="_blank" rel="noopener">https://github.com/lsvih/algorithm-practice/blob/master/k-means/k-means.py</a> (_src=undefined)</p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>生成的聚类：</p>
<p><img src="/images/pasted-113.png" alt="upload successful"></p>
<p>k-means运行后的聚类：</p>
<p><img src="/images/pasted-114.png" alt="upload successful"></p>
<p>可以看到分类算法运行良好。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/21/EM-algorithm最大似然算法学习笔记/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/03/21/EM-algorithm最大似然算法学习笔记/" class="post-title-link" itemprop="url">EM algorithm最大似然算法学习笔记</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-21 12:55:00" itemprop="dateCreated datePublished" datetime="2017-03-21T12:55:00+08:00">2017-03-21</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="琴生不等式-Jensen’s-inequality"><a href="#琴生不等式-Jensen’s-inequality" class="headerlink" title="琴生不等式(Jensen’s inequality)"></a>琴生不等式(Jensen’s inequality)</h2><p>最大似然函数应用到了琴生不等式。琴生不等式给出了积分的凸函数值和凸函数的积分值间的关系。它由以下两部分组成：</p>
<p>当$f(x)$是(a,b)区间上的凸函数时，则对任意的点$x_1,x_2,…,x_n \in (a,b)$有</p>
<script type="math/tex; mode=display">f(\frac{x_1+x_2+...+x_n}{n}) \geq \frac{1}{n}[f(x_1)+f(x_2)+...+f(x_n)]</script><p>当$x_1=x_2=…=x_n$时取等号。</p>
<p>当$f(x)$是(a,b)区间上的凹函数时，则对任意的点$x_1,x_2,…,x_n in (a,b)$有</p>
<script type="math/tex; mode=display">f(\frac{x_1+x_2+...+x_n}{n}) \leq \frac{1}{n}[f(x_1)+f(x_2)+...+f(x_n)]</script><p>当$x_1=x_2=…=x_n$时取等号。</p>
<p>将琴生不等式应用到概率论，有</p>
<p>当$f(x)$是凸函数时</p>
<script type="math/tex; mode=display">E[f(X)]\geq f(EX)</script><p>当$f(x)$是凹函数时</p>
<script type="math/tex; mode=display">E[f(X)]\leq f(EX)</script><p>如图所示：</p>
<p><img src="/images/pasted-108.png" alt="upload successful"></p>
<h2 id="最大似然算法-EM-algorithm-的推导"><a href="#最大似然算法-EM-algorithm-的推导" class="headerlink" title="最大似然算法(EM algorithm)的推导"></a>最大似然算法(EM algorithm)的推导</h2><h3 id="似然函数-likelihood-function"><a href="#似然函数-likelihood-function" class="headerlink" title="似然函数(likelihood function)"></a>似然函数(likelihood function)</h3><p>当有一组数据${ x^{(1)},…,x^{(m)} }$，这一组数据是从更大的未知数据中抽样出来的，每一个x对抽样而言都是独立事件。因此，抽样出每个数据的概率为$p(x)$，抽样出这一组数据集的概率则为$\prod^m_{i=1} p(x)$。而所有的数据都满足某一个分布规律（求的正是这个规律），例如高斯分布等。这个分布规律含有一个分布参数$\theta$，这个参数决定了这个分布规律。此时抽样出数据集的概率为$\prod^m_{i=1} p(x_i;\theta)$，将这个式子记为$L(\theta)$，即</p>
<script type="math/tex; mode=display">L(\theta)=\prod^m_{i=1} p(x_i;\theta)</script><p>当$L(\theta)$最大时，有最大的可能抽出这组数据，就能猜测$\theta$是分布概率的参数。这个式子被称为似然函数。</p>
<blockquote>
<p>p(x;y)表示当参数为y时x的概率</p>
</blockquote>
<p>为了让计算更方便，将乘法运算通过求ln值变化为加法运算</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)</script><p>这个l称为loglikelihood function</p>
<h3 id="最大似然函数"><a href="#最大似然函数" class="headerlink" title="最大似然函数"></a>最大似然函数</h3><p>当有多组数据时，每组数据的分布规律都不同，对于每组数据来说都有一个隐藏的变量z将不同的组别分开。例如对于$x^{(i)}$来说，有$p(z^{(1)})$的可能是聚类1的，有$p(z^{(2)})$的可能是聚类2的。因此将所有的可能加起来，有</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)=\sum^m_{i=1} ln\sum_{z^{(i)}}p(x^{(i)},z^{(i)};\theta)</script><p>为了求其最值，则需要对其进行求导。此时发现，$\sum \ln \sum f(x,y,z)$相当难进行求导，因此对其进行化简：</p>
<p>对于$x^{(i)}$，它的所有z概率之和记为$\sum_{z^{(i)}} Q_i(z^{(i)})=1$，对上式加入这个值，得到</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)=\sum^m_{i=1} \ln\sum_{z^{(i)}} Q_i(z^{(i)}) \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>对于$f(x)=\ln x$来说，$\frac{\mathrm{d}^2 f(x) }{\mathrm{d} x^2}=-\frac{1}{x^2}\leq0$，因此它为凹函数。应用琴生不等式，$E(f(x)) \leq f(EX)$。同理，上式进行不等变换：</p>
<script type="math/tex; mode=display">f(E_{z^{(i)~Q_i}}[\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}]) \geq E_{z^{(i)~Q_i}}[f(\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})})]\Rightarrow
\\
\sum^m_{i=1} ln\sum_{z^{(i)}} Q_i(z^{(i)}) \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} \\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>此时得到的式子是一个不等式，确切的说是似然函数的下界。为了让似然函数达到最大，则需要得到合适的$z,\theta$让下界更高。</p>
<p>此时分两步来进行计算：第一步固定$\theta$调整$Q_i(z^i)$，让下界上升至最高(前式的不等式取到等号)，第二部固定$Q_i(z^i)$调整$\theta$，使似然函数的值升高，下界达到最高，再重复第一步。循环往复直到第二步收敛。</p>
<h4 id="E-step"><a href="#E-step" class="headerlink" title="E-step"></a>E-step</h4><p>根据琴生不等式，当X为常数时，肯定有$E[f(X)]= f(EX)$，即</p>
<script type="math/tex; mode=display">\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} = c</script><p>而$\sum_{z^{(i)}} Q_i(z^{(i)})=1$，因此</p>
<script type="math/tex; mode=display">Q_i(z^{(i)})=\frac{p(x^{(i)},z^{(i)};\theta)}{\sum_z p(x^{(i)},z,\theta)}=p(x^{(i)},z^{(i)};\theta)</script><p>这就是第一步，让琴生不等式中的X为常数，取到f(x)的最大值。这一步记为E-step：</p>
<script type="math/tex; mode=display">Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)</script><h4 id="M-step"><a href="#M-step" class="headerlink" title="M-step"></a>M-step</h4><p>固定$\theta$，下界为</p>
<script type="math/tex; mode=display">\sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>此时要调整$Q_i(z^i)$，让下界升到最高。记第t步为$l(\theta^{t})$，第t+1步为$l(\theta^{t+1})$。由于下界在升高，最大似然函数值也会升高，$Q_i(z^i)$随之升高，直到收敛。因此可以推导</p>
<script type="math/tex; mode=display">l(\theta^{(t+1)})=\sum^m_{i=1} \sum_{z^{(i)}} Q_i^{(t+1)}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{(t+1)})}{Q^{(t+1)}_i(z^{(i)})}\\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i^{t}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{(t+1)})}{Q^{t}_i(z^{(i)})}\\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i^{t}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{t})}{Q^{t}_i(z^{(i)})}=l(\theta^{t})</script><p>最终得到</p>
<script type="math/tex; mode=display">l(\theta^{(t+1)}) \geq l(\theta^t)</script><p>因此可得知M-step中，$Q_i(z^i)$的值会不断增加直到收敛。</p>
<p>M-step记为</p>
<script type="math/tex; mode=display">\theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>最终得到最大似然算法：</p>
<script type="math/tex; mode=display">
\text{Repeat until convergence}\{ \\
\text{(E-step) For each i,set}\\
 Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta) \\
 \text{(M-step) set}\\
 \theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}\\
 \}</script><hr>
<blockquote>
<p>Reference</p>
<p>Stanford CS229 <a href="http://cs229.stanford.edu/notes/cs229-notes8.pdf" target="_blank" rel="noopener">http://cs229.stanford.edu/notes/cs229-notes8.pdf</a><br><a href="https://lsvih.com/img/1490063106133851.pdf">cs229-notes8-EM算法.pdf</a><br>从最大似然到EM算法浅解 <a href="http://blog.csdn.net/zouxy09/article/details/8537620/" target="_blank" rel="noopener">http://blog.csdn.net/zouxy09/article/details/8537620/</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/08/swift持久化存储轻量数据/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/03/08/swift持久化存储轻量数据/" class="post-title-link" itemprop="url">swift持久化存储轻量数据</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-08 16:43:00" itemprop="dateCreated datePublished" datetime="2017-03-08T16:43:00+08:00">2017-03-08</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>做个简单的记事本,效果如下：</p>
<p>主要使用UserDefaults(以前是NSUserDefaults)实现数据的持久化,将Array<string>数据存储在沙盒里。</string></p>
<p>直接使用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">syncStore</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>(objects, forKey: <span class="string">"history"</span>)</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.synchronize()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>存数据。</p>
<p>读取数据使用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objects = <span class="type">UserDefaults</span>.standard.value(forKey: <span class="string">"history"</span>) <span class="keyword">as</span>! <span class="type">Array</span>&lt;<span class="type">Any</span>&gt;</span><br></pre></td></tr></table></figure>
<p>在第一次启动的时候读数据会出错，因此需要判断是否为第一次启动，如果是第一次启动则需要初始化存储结构。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isFirstLaunch = <span class="type">UserDefaults</span>.standard.string(forKey: <span class="string">"FirstLaunch"</span>) == <span class="literal">nil</span></span><br><span class="line"><span class="keyword">if</span>(isFirstLaunch)&#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>(<span class="string">"false"</span>, forKey: <span class="string">"FirstLaunch"</span>)</span><br><span class="line">    syncStore()</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    objects = <span class="type">UserDefaults</span>.standard.value(forKey: <span class="string">"history"</span>) <span class="keyword">as</span>! <span class="type">Array</span>&lt;<span class="type">Any</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>插入数据的function:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertNewObject</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> alertController = <span class="type">UIAlertController</span>(</span><br><span class="line">    title: <span class="string">"添加备忘"</span>, </span><br><span class="line">    message: <span class="string">"请输入备忘内容"</span>, </span><br><span class="line">    preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</span><br><span class="line">    <span class="keyword">let</span> insertAction = <span class="type">UIAlertAction</span>(</span><br><span class="line">    title: <span class="string">"确认"</span>, </span><br><span class="line">    style: .<span class="keyword">default</span>, </span><br><span class="line">    handler: &#123;</span><br><span class="line">    (action: <span class="type">UIAlertAction</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(alertController.textFields![<span class="number">0</span>].text!)</span><br><span class="line">        <span class="keyword">self</span>.objects.insert(alertController.textFields![<span class="number">0</span>].text!, at: <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">let</span> indexPath = <span class="type">IndexPath</span>(row: <span class="number">0</span>, section: <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">self</span>.tableView.insertRows(at: [indexPath], with: .automatic)</span><br><span class="line">        <span class="keyword">self</span>.syncStore()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">let</span> cancelAction = <span class="type">UIAlertAction</span>(title: <span class="string">"取消"</span>, style: .cancel)</span><br><span class="line">    alertController.addTextField &#123; (textField:<span class="type">UITextField</span>) <span class="keyword">in</span></span><br><span class="line">        textField.placeholder = <span class="string">"请输入内容"</span></span><br><span class="line">    &#125;</span><br><span class="line">    alertController.addAction(insertAction)</span><br><span class="line">    alertController.addAction(cancelAction)</span><br><span class="line">    <span class="keyword">self</span>.present(alertController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/02/18/旋转生成矩阵-Spiral-Matrix/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/02/18/旋转生成矩阵-Spiral-Matrix/" class="post-title-link" itemprop="url">旋转生成矩阵(Spiral Matrix)</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-02-18 05:18:00" itemprop="dateCreated datePublished" datetime="2017-02-18T05:18:00+08:00">2017-02-18</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Given an integer *n*, generate a square matrix filled with elements from 1 to *n*2 in spiral order.</p>
<p>For example,</p>
<p>Given *n* = 3,</p>
<p>You should return the following matrix:</p>
<p>[[ 1, 2, 3 ],</p>
<p> [ 8, 9, 4 ],</p>
<p> [ 7, 6, 5 ]]</p>
<p>与之前蛇形遍历一个思路，给定几个状态x,y,state(说明当前生成的方向)</p>
<p>在这个问题中，只有以下几种情况：向上生成到顶时，向右生成；向右生成到顶时，向下生成；向下生成到顶时，向左生成；向左生成到顶时，向上生成。最终的结束条件是生成了n^2个数字。</p>
<p>首先生成一个n*n的矩阵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">    rs.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">        rs[i].append(<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure>
<p>这样就得到了一个n*n的空矩阵。</p>
<p>开始时尝试过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="keyword">None</span>]*n]*n</span><br></pre></td></tr></table></figure>
<p>与</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="keyword">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]]*n</span><br></pre></td></tr></table></figure>
<p>的方式，发现均会出现问题。原因是以这种方式生成的二维数组的子项指向的是同一个对象。其后果是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [[<span class="keyword">None</span>]*<span class="number">5</span>]*<span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="number">1</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="number">1</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="number">1</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="number">1</span>, <span class="keyword">None</span>, <span class="keyword">None</span>], </span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="number">1</span>, <span class="keyword">None</span>, <span class="keyword">None</span>]]</span><br></pre></td></tr></table></figure>
<p>使用built-in查看它们的id发现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>id(a[<span class="number">2</span>]),id(a[<span class="number">3</span>])</span><br><span class="line">(<span class="number">4337281432</span>, <span class="number">4337281432</span>)</span><br></pre></td></tr></table></figure>
<p>因此放弃看上去简洁的写法。</p>
<blockquote>
<p>更新：发现一个简洁有效的写法：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = [[<span class="keyword">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)] <span class="keyword">for</span> j <span class="keyword">in</span> range(n)]</span><br></pre></td></tr></table></figure>
<hr>
<p>之后找出每个方向的条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> step &lt;= n**<span class="number">2</span>:</span><br><span class="line"><span class="comment"># print x,y,state,step,layer,tmp</span></span><br><span class="line">    rs[x][y] = step</span><br><span class="line">    <span class="keyword">if</span> state == <span class="string">'up'</span>:</span><br><span class="line">        <span class="keyword">if</span> x == layer:</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">            state = <span class="string">'right'</span></span><br><span class="line">        <span class="keyword">else</span>:x -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">'right'</span>:</span><br><span class="line">        <span class="keyword">if</span> y+<span class="number">1</span> == n-layer:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            state = <span class="string">'down'</span></span><br><span class="line">        <span class="keyword">else</span>:y+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">'down'</span>:</span><br><span class="line">        <span class="keyword">if</span> x+<span class="number">1</span> == n-layer:</span><br><span class="line">            y -= <span class="number">1</span></span><br><span class="line">            state = <span class="string">'left'</span></span><br><span class="line">        <span class="keyword">else</span>:x+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">'left'</span>:</span><br><span class="line">        <span class="keyword">if</span> y == layer:</span><br><span class="line">            x-=<span class="number">1</span></span><br><span class="line">            state= <span class="string">'up'</span></span><br><span class="line">        <span class="keyword">else</span>:y-=<span class="number">1</span></span><br><span class="line">    step += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>大意如此。其中layer为当前从外向内已生成完的层数，由</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> step == n**<span class="number">2</span>-(n-layer*<span class="number">2</span><span class="number">-2</span>)**<span class="number">2</span>:layer+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>可以得到。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/02/07/蛇形遍历-Diagonal-Traverse/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2017/02/07/蛇形遍历-Diagonal-Traverse/" class="post-title-link" itemprop="url">蛇形遍历(Diagonal Traverse)</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-02-07 14:30:00" itemprop="dateCreated datePublished" datetime="2017-02-07T14:30:00+08:00">2017-02-07</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>Input:</strong></p>
<p>[[ 1, 2, 3 ],</p>
<p> [ 4, 5, 6 ],</p>
<p> [ 7, 8, 9 ]]</p>
<p><strong>Output:</strong>  [1,2,4,7,5,3,6,8,9]</p>
<p><strong>Explanation:</strong></p>
<p><img src="/images/pasted-107.png" alt="upload successful"></p>
<p>像蛇爬行一样沿着对角线来回遍历整个矩阵。</p>
<p>提供一种很容易实现的解题思路：</p>
<p>在遍历过程中有几种情况：向右遍历、向下遍历、向左下遍历、向右上遍历。</p>
<p>给定两个变量x,y(记做matrix[x][y])记录当前坐标，就能通过判断这几个方向决定下一个坐标位置。</p>
<p>例如，向左下遍历即x++,y—，如果x已经到矩阵下边界则转向右遍历；如果x未到矩阵下边界,y到矩阵左边界则向下遍历；如果xy都未到矩阵边界则继续向左下遍历。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">state,x,y,M,N = <span class="string">'right_up'</span>,<span class="number">0</span>,<span class="number">0</span>,len(matrix),len(matrix[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">if</span> state == <span class="string">'left_down'</span>:</span><br><span class="line">    rs.append(matrix[x][y])</span><br><span class="line">    <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x == M<span class="number">-1</span>:</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">            state = <span class="string">'right_after_left_down'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            state = <span class="string">'down_after_left_down'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            y -= <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>依次类推，可以将所有情况与边界情况都列出来。</p>
<p>同时需要排除三种特殊情况：当矩阵为空时不存在遍历结果；当矩阵行或列为1时直接将矩阵从上至下遍历。</p>
<p>经简化可写出解法(result)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findDiagonalOrder</span><span class="params">(matrix)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :type matrix: List[List[int]]</span></span><br><span class="line"><span class="string">    :rtype: List[int]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> matrix == []:<span class="keyword">return</span> []</span><br><span class="line">    rs,state,x,y,M,N = [],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,len(matrix),len(matrix[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> M == <span class="number">1</span> <span class="keyword">or</span> N == <span class="number">1</span>:<span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y:x+y,matrix)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        rs.append(matrix[x][y])</span><br><span class="line">        <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">and</span> y == N<span class="number">-1</span>:<span class="keyword">return</span> rs</span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x == <span class="number">0</span> <span class="keyword">or</span> y == N<span class="number">-1</span>:</span><br><span class="line">                <span class="keyword">if</span> y == N<span class="number">-1</span>:x,state = x+<span class="number">1</span>,<span class="number">2</span></span><br><span class="line">                <span class="keyword">else</span>:y,state = y+<span class="number">1</span>,<span class="number">5</span></span><br><span class="line">            <span class="keyword">else</span>:x,y = x<span class="number">-1</span>,y+<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> x == M<span class="number">-1</span>:y,state = y+<span class="number">1</span>,<span class="number">4</span></span><br><span class="line">                <span class="keyword">else</span>:x,state = x+<span class="number">1</span>,<span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:x,y = x+<span class="number">1</span>,y<span class="number">-1</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">3</span> <span class="keyword">or</span> state == <span class="number">4</span>:x,y,state = x<span class="number">-1</span>,y+<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">2</span> <span class="keyword">or</span> state == <span class="number">5</span>:x,y,state = x+<span class="number">1</span>,y<span class="number">-1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>其中每个元素都被处理过一遍，其时间复杂度为O(n)</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/12/31/Python-collections模块中的Counter/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2016/12/31/Python-collections模块中的Counter/" class="post-title-link" itemprop="url">Python collections模块中的Counter</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-12-31 09:02:04" itemprop="dateCreated datePublished" datetime="2016-12-31T09:02:04+08:00">2016-12-31</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>除了内置(build-in)数据结构(dict,list,set,tuple)之外，python还提供了一些额外的数据结构。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br></pre></td></tr></table></figure>
<p>collections提供了5种可选的数据结构:Counter,deque,OrderDict,defaultdict,namedtuple()</p>
<h2 id="collections-Counter"><a href="#collections-Counter" class="headerlink" title="collections.Counter"></a>collections.Counter</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br></pre></td></tr></table></figure>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Counter是dict的一个子集，它可以用来计算dict中的可哈希对象。它是一个无排序集合，它的元素作为dict的key存储，对应的计数则以其value存储，例如Counter({‘a’:1,’b’:2,’c’:4})代表有1个a,2个b,4个c。Counter接受所有的整数作为其计数(包括0和负数在内)。</p>
<h3 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h3><p>构造一个空的Counter</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter()</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter()</span><br></pre></td></tr></table></figure>
<p>从迭代器创建Counter</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">"asdf"</span>)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'s'</span>:<span class="number">1</span>,<span class="string">'d'</span>:<span class="number">1</span>,<span class="string">'f'</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>由字典mapping创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(&#123;<span class="string">'ss'</span>:<span class="number">1</span>,<span class="string">'dd'</span>:<span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'dd'</span>:<span class="number">2</span>,<span class="string">'ss'</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>由参数的keyword创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(hh = <span class="number">2</span>,ss = <span class="number">6</span>)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'ss'</span>:<span class="number">6</span>,<span class="string">'hh'</span>:<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><p>Counter有一些很有用的特性。例如，作为一个计数器，当读取Counter中不存在的key时，不会像通常dict那样返回错误，而是会返回0(意思是Counter里有0个这种key)</p>
<p>例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter([<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>])</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'a'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用dict</span></span><br><span class="line">t = &#123;<span class="string">'a'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">1</span>&#125;</span><br><span class="line">t[<span class="string">'b'</span>]</span><br><span class="line"><span class="comment">#此时报错</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用Counter</span></span><br><span class="line">c[<span class="string">'b'</span>]</span><br><span class="line"><span class="comment">#输出0</span></span><br></pre></td></tr></table></figure>
<p>将Counter中的一个key的value设置为0(即将其计数清零)并不会删除这个元素，只有使用del才能将其中的元素删除。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c = Counter([<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>])</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'a'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">1</span>&#125;)</span><br><span class="line">c[<span class="string">'a'</span>] = <span class="number">0</span></span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'c'</span>:<span class="number">1</span>,<span class="string">'a'</span>:<span class="number">0</span>&#125;)</span><br><span class="line"><span class="keyword">del</span> c[<span class="string">'c'</span>]</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'a'</span>:<span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="elements"><a href="#elements" class="headerlink" title="elements()"></a>elements()</h4><p>返回Counter()中计数大于1的所有元素。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(&#123;<span class="string">'a'</span>:<span class="number">2</span>,<span class="string">'b'</span>:<span class="number">1</span>,<span class="string">'d'</span>:<span class="number">0</span>,<span class="string">'e'</span>:<span class="number">-2</span>&#125;)</span><br><span class="line">list(c.elements())</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">[<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>]</span><br></pre></td></tr></table></figure>
<h4 id="most-common-n"><a href="#most-common-n" class="headerlink" title="most_common([n])"></a>most_common([n])</h4><p>返回Counter()中计数最多的n个元素。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">"asdfaas"</span>)</span><br><span class="line">c.most_common(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">[(<span class="string">'a'</span>,<span class="number">3</span>),(<span class="string">'b'</span>,<span class="number">2</span>)]</span><br></pre></td></tr></table></figure>
<h4 id="subtract"><a href="#subtract" class="headerlink" title="subtract()"></a>subtract()</h4><p>由一个Counter()减去另一个Counter()或迭代器或mapping。得到的数字可以为0或负数。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">"addaw"</span>)</span><br><span class="line">b = <span class="string">"adddf"</span></span><br><span class="line">c.subtract(b)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'w'</span>:<span class="number">1</span>,<span class="string">'d'</span>:<span class="number">-1</span>,<span class="string">'f'</span>:<span class="number">-1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>除此之外，Counter()还有一些dict本身有的特性。</p>
<p>比如 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Counter(<span class="string">"asdf"</span>) == Counter(<span class="string">"fdsa"</span>) &gt;&gt;&gt;&gt; <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">Counter(<span class="string">"wwww"</span>) + Counter(<span class="string">"ssss"</span>) &gt;&gt;&gt;&gt; Counter(&#123;<span class="string">'w'</span>:<span class="number">4</span>,<span class="string">'s'</span>:<span class="number">4</span>&#125;)</span><br><span class="line"></span><br><span class="line">list(Counter(<span class="string">"asdf"</span>)) &gt;&gt;&gt;&gt; [<span class="string">'a'</span>,<span class="string">'s'</span>,<span class="string">'d'</span>,<span class="string">'f'</span>]</span><br></pre></td></tr></table></figure>
<p>等等。</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>Counter()计数器可以用在很多需要统计key出现字数的情景中。</p>
<p>例如求同素异构词（由相同的字母不同的顺序组成的词）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">same</span><span class="params">(s,d)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> Counter(s) == Counter(d)</span><br></pre></td></tr></table></figure>
<p>求句子中出现次数最多的字母:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">(d)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> Counter(d).most_common(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>等等</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/12/20/计算笛卡尔积/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2016/12/20/计算笛卡尔积/" class="post-title-link" itemprop="url">计算笛卡尔积</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-12-20 20:10:00" itemprop="dateCreated datePublished" datetime="2016-12-20T20:10:00+08:00">2016-12-20</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>笛卡尔积又名直积，是所有可能的有序对组成的集合，其中有序对的第一个对象是X的成员，第二个对象是Y的成员。可以表示如下：</p>
<script type="math/tex; mode=display">X\times Y={<x,y>|x\in X\land y\in Y}</script><p>例如，[[a,b],[1,2,3]]的笛卡尔积为[[a,1],[a,2],[a,3],[b,1],[b,2],[b,3]]</p>
<p>在实际应用中，笛卡尔积常用于在电商中生成商品的sku信息，将所有的属性组合起来。</p>
<p>当空间数量固定时，可以直接使用嵌套的循环来完成，例如上面的二元笛卡尔积：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">'a'</span>,<span class="string">'b'</span>]</span><br><span class="line"><span class="keyword">let</span> b = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>]</span><br><span class="line"><span class="keyword">let</span> result = []</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;b.length;j++)&#123;</span><br><span class="line">        result.push([a[i],b[j]])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ [ <span class="string">'a'</span>, <span class="string">'1'</span> ],</span><br><span class="line">  [ <span class="string">'a'</span>, <span class="string">'2'</span> ],</span><br><span class="line">  [ <span class="string">'a'</span>, <span class="string">'3'</span> ],</span><br><span class="line">  [ <span class="string">'b'</span>, <span class="string">'1'</span> ],</span><br><span class="line">  [ <span class="string">'b'</span>, <span class="string">'2'</span> ],</span><br><span class="line">  [ <span class="string">'b'</span>, <span class="string">'3'</span> ] ]</span><br></pre></td></tr></table></figure>
<p>推广到n元笛卡尔积：</p>
<script type="math/tex; mode=display">X_{1}\times X_{2}\times ...\times X_{n}={(x_{1},...,x_{n})|x_{1}\in X_{1}\land ...\land x_{n}in X_{n}}</script><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;b.length;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>()&#123;</span><br><span class="line">            ...(n次循环)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当n不为固定数值的时候，不能以这种嵌套循环的方式表示。因此考虑使用嵌套</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">combination</span><span class="params">(array)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :type array: List[][]</span></span><br><span class="line"><span class="string">    :rtype: List[str]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">if</span> len(array) <span class="keyword">is</span> <span class="number">0</span>: <span class="keyword">return</span> result</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cartsianProduct</span><span class="params">(index,rs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> index <span class="keyword">is</span> len(array):</span><br><span class="line">            result.append(rs)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> array[index]:</span><br><span class="line">                next_rs = copy.copy(rs)</span><br><span class="line">                next_rs.append(item)</span><br><span class="line">                cartsianProduct(index+<span class="number">1</span>,next_rs)</span><br><span class="line">    cartsianProduct(<span class="number">0</span>,[])</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">combination([[<span class="string">'a'</span>,<span class="string">'b'</span>],[<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>]])</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">'a'</span>, <span class="string">'1'</span>], [<span class="string">'a'</span>, <span class="string">'2'</span>], [<span class="string">'a'</span>, <span class="string">'3'</span>], [<span class="string">'b'</span>, <span class="string">'1'</span>], [<span class="string">'b'</span>, <span class="string">'2'</span>], [<span class="string">'b'</span>, <span class="string">'3'</span>]]</span><br></pre></td></tr></table></figure>
<p>对于python来说，除了使用遍历之外也可以使用py自带的迭代器itertools:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">rs = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> itertools.product([<span class="string">'a'</span>,<span class="string">'b'</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]):</span><br><span class="line">    rs.append(x)</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'a'</span>, <span class="number">2</span>), (<span class="string">'a'</span>, <span class="number">3</span>), (<span class="string">'b'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'b'</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lsvih</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">145</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">177</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/lsvih" title="GitHub &rarr; https://github.com/lsvih" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:lsvih@qq.com" title="E-Mail &rarr; mailto:lsvih@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
                
              
              
              
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
             </div>
          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">  <a href="http://www.miitbeian.gov.cn" rel="noopener" target="_blank">京ICP备18029472号 </a>&copy; 2016 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lsvih</span>

  

  
</div>






  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.7.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="/lib/reading_progress/reading_progress.js"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.7.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.7.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script>



  



  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=6.7.0"></script>



  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
  

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: "AMS"
      }
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
      for (i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

<style>
.MathJax_Display {
  overflow: auto hidden;
}
</style>

    
  


  

  

  

  

  

  

  

  

</body>
</html>
