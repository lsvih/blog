<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lsvih.com","root":"/","scheme":"Pisces","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"algolia":{"appID":"6U6P1RGK4F","apiKey":"b14e73cdd627eabe947b5decbe14850f","indexName":"lsvih","hits":{"per_page":10}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="My note">
<meta property="og:url" content="https://lsvih.com/page/12/index.html">
<meta property="og:site_name" content="My note">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="lsvih">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lsvih.com/page/12/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>My note - lsvih</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-142893470-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-142893470-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="My note" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">My note</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">lsvih</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="https://cv.lsvih.com/" rel="noopener" target="_blank"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">lsvih</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">164</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">208</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/lsvih" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lsvih" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lsvih@qq.com" title="E-Mail → mailto:lsvih@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/10/03/%E5%9C%A8less%E4%B8%AD%E4%BD%BF%E7%94%A8calc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/10/03/%E5%9C%A8less%E4%B8%AD%E4%BD%BF%E7%94%A8calc/" class="post-title-link" itemprop="url">在less中使用calc()</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-10-03 04:22:00" itemprop="dateCreated datePublished" datetime="2016-10-03T04:22:00+08:00">2016-10-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>calc()在css中可以很方便的使用，但是在使用less时calc()内的东西会被编译器当作算式进行计算，例如</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">height</span><span class="selector-pseudo">:calc(</span> 100% <span class="selector-tag">-</span> 20<span class="selector-tag">px</span> );</span><br></pre></td></tr></table></figure>
<p>会被编译成<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">height</span><span class="selector-pseudo">:calc</span> ( 80% );</span><br></pre></td></tr></table></figure></p>
<p>此时，需要用到less的e()字符串函数来让其以css方式解析</p>
<blockquote>
<h3 id="e"><a href="#e" class="headerlink" title="e"></a>e<a target="_blank" rel="noopener" href="http://lesscss.cn/functions/#string-functions-e"></a></h3><p>CSS escaping, replaced with <code>~&quot;value&quot;</code> syntax.</p>
<p>It expects string as a parameter and return its content as is, but without quotes. It can be used to output CSS value which is either not valid CSS syntax, or uses proprietary syntax which Less doesn’t recognize.</p>
<p>Parameters: <code>string</code> - a string to escape.</p>
<p>Returns: <code>string</code> - the escaped string, without quotes.</p>
<p>Example:</p>
<pre style="box-sizing: border-box; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; white-space: pre-wrap; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: 1px solid rgb(204, 204, 204); border-radius: 4px; background-color: rgb(245, 245, 245);">filter: e("ms:alwaysHasItsOwnSyntax.For.Stuff()");</pre>

<p>Output:</p>
<pre style="box-sizing: border-box; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; white-space: pre-wrap; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; word-wrap: break-word; color: rgb(51, 51, 51); border: 1px solid rgb(204, 204, 204); border-radius: 4px; background-color: rgb(245, 245, 245);">filter: ms:alwaysHasItsOwnSyntax.For.Stuff();</pre>

<p>Note: The function accepts also <code>~&quot;&quot;</code> escaped values and numbers as parameters. Anything else returns an error.</p>
</blockquote>
<p>因此，需要这样写<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">height</span>: <span class="selector-tag">calc</span>( <span class="selector-tag">e</span>(&quot;100% <span class="selector-tag">-</span> 20<span class="selector-tag">px</span>&quot;) );</span><br></pre></td></tr></table></figure></p>
<p>或<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">height</span>: <span class="selector-tag">calc</span>(~&quot;100% <span class="selector-tag">-</span> 20<span class="selector-tag">px</span>&quot;);</span><br></pre></td></tr></table></figure></p>
<p>这时就能满足需求，编译成css后会保持<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">height</span>: <span class="selector-tag">calc</span>( 100% <span class="selector-tag">-</span> 20<span class="selector-tag">px</span> );</span><br></pre></td></tr></table></figure></p>
<p>的样子。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/09/30/js%E5%AE%9E%E7%8E%B0async-parallel%E5%8A%9F%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/09/30/js%E5%AE%9E%E7%8E%B0async-parallel%E5%8A%9F%E8%83%BD/" class="post-title-link" itemprop="url">js实现async.parallel功能</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-09-30 16:25:46" itemprop="dateCreated datePublished" datetime="2016-09-30T16:25:46+08:00">2016-09-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在有多个异步请求的情况下，如何将它们全部正确的返回请求是个问题。如果不适用async,一般有几种实现的情况。</p>
<p>1、对于result需要按照顺序请求的情况直接使用回调-回调-回调</p>
<p>  直接使用这样的回调就能完成相应需求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> allResult = &#123;&#125;</span><br><span class="line">asyncFunction(<span class="string">&quot;1&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error==<span class="literal">null</span>)</span><br><span class="line">    allResult[<span class="string">&quot;1&quot;</span>]=result</span><br><span class="line">    asyncFunction(<span class="string">&quot;2&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(error==<span class="literal">null</span>)</span><br><span class="line">        allResult[<span class="string">&quot;2&quot;</span>]=result</span><br><span class="line">        asyncFunction(<span class="string">&quot;3&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(error==<span class="literal">null</span>)</span><br><span class="line">            allResult[<span class="string">&quot;3&quot;</span>]=result </span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          <span class="built_in">console</span>.error(error)</span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">console</span>.error(error)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">     <span class="built_in">console</span>.error(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这种请求方式虽然能很明确地描述出整个流程，能保证result按顺序输出，但是代码一层套一层，不利于阅读。</p>
<p>这种情况可以使用async.series进行控制，暂且不提</p>
<p>2、如果不要求按照顺序输出result，因此上面那种做法就显得非常浪费时间，因为每个请求都要等到前一个请求完成后才会进行下一个请求，它们的时间是相加的。因此可以同时进行所有的请求，将所有请求的result都拿到，不需要管它们哪个先输出哪个后输出。</p>
<p>在async中，可以这样实现:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span>.parallel(&#123;</span><br><span class="line">  one:<span class="function"><span class="keyword">function</span>(<span class="params">done</span>)</span>&#123;</span><br><span class="line">    asyncFunction(<span class="string">&#x27;1&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(!error)</span><br><span class="line">        done(<span class="literal">null</span>,result)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        done(error,<span class="literal">null</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  two:<span class="function"><span class="keyword">function</span>(<span class="params">done</span>)</span>&#123;</span><br><span class="line">    asyncFunction(<span class="string">&#x27;2&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(!error)</span><br><span class="line">        done(<span class="literal">null</span>,result)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        done(error,<span class="literal">null</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  three:<span class="function"><span class="keyword">function</span>(<span class="params">done</span>)</span>&#123;</span><br><span class="line">    asyncFunction(<span class="string">&#x27;3&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(!error)</span><br><span class="line">        done(<span class="literal">null</span>,result)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        done(error,<span class="literal">null</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!error)</span><br><span class="line">    callback(<span class="literal">null</span>,result)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    callback(error,<span class="literal">null</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>以上代码的含义是，同时调用3个asyncFunction，当三个函数都成功取到result之后将result输出，如果其中有任何一个函数出现了错误(收到了error)则输出错误信息。通过这种方式可以节省请求时间且便于查看代码。</p>
<h3 id="实现async-parallel"><a href="#实现async-parallel" class="headerlink" title="实现async.parallel"></a>实现async.parallel</h3><p>async.parallel参数由2部分，第一部分是由请求组成的对象，第二部分是全部完成时处理的函数</p>
<p>需要处理的第一点就是如何判断所有的asyncFunction都成功完成，且在那时候调用之后的函数.</p>
<p>可以采用for in 来获取第一部分参数的请求数量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span>.parallel = <span class="function"><span class="keyword">function</span>(<span class="params">actions,allDone</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> Result = &#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> action <span class="keyword">in</span> actions)&#123;</span><br><span class="line">       <span class="keyword">if</span>(actions.hasOwnProperty(action)) n++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样就能获得请求总数，hasOwnproperty防止计数时遍历到其原型的属性</p>
<p>接着，就可以遍历请求，分别处理它们的回调了<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span>.parallel = <span class="function"><span class="keyword">function</span>(<span class="params">actions,allDone</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> Result = &#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> action <span class="keyword">in</span> actions)&#123;</span><br><span class="line">       <span class="keyword">if</span>(actions.hasOwnProperty(action)) n++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到了n</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> action <span class="keyword">in</span> actions)&#123;</span><br><span class="line">       <span class="keyword">var</span> done = <span class="function"><span class="keyword">function</span>(<span class="params">error,result</span>)</span>&#123;</span><br><span class="line">           <span class="keyword">if</span>(error==<span class="literal">null</span>)&#123;</span><br><span class="line">               Result[action] = result</span><br><span class="line">               n--</span><br><span class="line">               <span class="keyword">if</span>(n==<span class="number">0</span>) allDone(<span class="literal">null</span>,Result)</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               allDone(error,Result)<span class="comment">//如果asyncFunction发生错误,将错误返回</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       action(done)<span class="comment">//将done作为参数放入每个请求中，用于处理result和error</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过这种方式，简单实现了async.parallel的功能。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/09/28/%E5%9C%A8%E8%BF%9C%E7%A8%8Bgit%E4%BB%93%E5%BA%93%E5%9B%9E%E9%80%80%E7%89%88%E6%9C%AC%EF%BC%8C%E6%92%A4%E9%94%80commit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/09/28/%E5%9C%A8%E8%BF%9C%E7%A8%8Bgit%E4%BB%93%E5%BA%93%E5%9B%9E%E9%80%80%E7%89%88%E6%9C%AC%EF%BC%8C%E6%92%A4%E9%94%80commit/" class="post-title-link" itemprop="url">在远程git仓库回退版本，撤销commit</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-09-28 04:52:00" itemprop="dateCreated datePublished" datetime="2016-09-28T04:52:00+08:00">2016-09-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>当做出了不正确的commit还push到远程仓库后，可以用强推的方法回退远程仓库</p>
<ol>
<li>先从远程仓库clone下最新的版本</li>
<li>使用git reset —hard HEAD^ 来将仓库所有内容回退到上一个版本，在运行命令的时候可以看到当前的commit点<br><img src="/images/pasted-104.png" alt="upload successful"></li>
<li>使用git status确认信息是否正确<br><img src="/images/pasted-105.png" alt="upload successful"><br>可以看到本地仓库是处于远程仓库4个commit版本前的位置</li>
<li>强行将本地仓库推送到远程仓库，覆盖原来的master</li>
</ol>
<p>使用 git push origin +master:master</p>
<p>此时远程仓库就回到了4个commit版本前。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/09/26/%E8%87%AA%E5%8A%A8%E5%9C%A8%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E5%9C%A8%E5%BE%AE%E4%BF%A1%E4%B8%AD%E5%88%86%E4%BA%AB%E7%9F%A5%E4%B9%8E%E6%97%A5%E6%8A%A5%E7%9A%84%E6%B6%88%E6%81%AF%E2%86%92-%E2%86%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/09/26/%E8%87%AA%E5%8A%A8%E5%9C%A8%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E5%9C%A8%E5%BE%AE%E4%BF%A1%E4%B8%AD%E5%88%86%E4%BA%AB%E7%9F%A5%E4%B9%8E%E6%97%A5%E6%8A%A5%E7%9A%84%E6%B6%88%E6%81%AF%E2%86%92-%E2%86%92/" class="post-title-link" itemprop="url">自动在指定时间在微信中分享知乎日报的消息→_→</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-09-26 05:42:00" itemprop="dateCreated datePublished" datetime="2016-09-26T05:42:00+08:00">2016-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>情景：老板规定在指定日期必须分享文章</p>
<p>使用selenium进行微信的自动化操作，适用requests获取目标网站的内容，适用BeautifulSoup快速获得需要选择的元素及内容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> BeautifulSoup <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">browser.get( <span class="string">&quot;https://wx.qq.com/ &quot;</span>)</span><br><span class="line">print( <span class="string">&quot;请登录 &quot;</span>)</span><br><span class="line">time.sleep(<span class="number">10</span>)</span><br><span class="line">chat_elems = browser.find_elements_by_class_name( <span class="string">&quot;ng-scope &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> elem <span class="keyword">in</span> chat_elems:</span><br><span class="line">    <span class="keyword">if</span>(elem.text.encode(<span class="string">&#x27;UTF-8&#x27;</span>) == <span class="string">u&#x27;文件传输助手&#x27;</span>.encode(<span class="string">&#x27;UTF-8&#x27;</span>)):</span><br><span class="line">        elem.click()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    current_time = time.localtime(time.time())</span><br><span class="line">    <span class="keyword">if</span> ((current_time.tm_mday%<span class="number">10</span> == <span class="number">5</span>) <span class="keyword">and</span> (current_time.tm_hour == <span class="number">1</span>)):</span><br><span class="line">        headers = &#123; <span class="string">&quot;Accept &quot;</span>:  <span class="string">&quot;text/html,application/xhtml+xml,application/xml; &quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Accept-Encoding &quot;</span>:  <span class="string">&quot;gzip &quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Accept-Language &quot;</span>:  <span class="string">&quot;zh-CN,zh;q=0.8 &quot;</span>,</span><br><span class="line">                    <span class="string">&quot;Referer &quot;</span>:  <span class="string">&quot;http://daily.zhihu.com/ &quot;</span>,</span><br><span class="line">                    <span class="string">&quot;User-Agent &quot;</span>:  <span class="string">&quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36 &quot;</span></span><br><span class="line">                   &#125;</span><br><span class="line">        zhihu = BeautifulSoup(requests.get(url= <span class="string">&quot;http://daily.zhihu.com/ &quot;</span>,headers=headers).text)</span><br><span class="line">        frist_q = zhihu.find(attrs=&#123;<span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;wrap&#x27;</span>&#125;).find( <span class="string">&quot;a &quot;</span>)</span><br><span class="line">        frist_q_content = frist_q.text</span><br><span class="line">        frist_q_link = <span class="string">&#x27;http://daily.zhihu.com&#x27;</span> + frist_q.get( <span class="string">&quot;href &quot;</span>)</span><br><span class="line">        browser.find_element_by_id( <span class="string">&quot;editArea &quot;</span>).send_keys(frist_q_content)</span><br><span class="line">        browser.find_element_by_id( <span class="string">&quot;editArea &quot;</span>).send_keys(frist_q_link)</span><br><span class="line">        browser.find_element_by_class_name( <span class="string">&quot;btn_send &quot;</span>).click()</span><br><span class="line">    time.sleep(<span class="number">60</span>*<span class="number">59</span>)</span><br></pre></td></tr></table></figure>
<p>其中，headers 为了反防爬虫策略。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/08/14/%E4%BD%BF%E7%94%A8swift%E5%88%B6%E4%BD%9C%E7%AE%80%E6%98%93%E5%9B%BE%E7%89%87%E6%BB%A4%E9%95%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/08/14/%E4%BD%BF%E7%94%A8swift%E5%88%B6%E4%BD%9C%E7%AE%80%E6%98%93%E5%9B%BE%E7%89%87%E6%BB%A4%E9%95%9C/" class="post-title-link" itemprop="url">使用swift制作简易图片滤镜</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-08-14 12:30:00" itemprop="dateCreated datePublished" datetime="2016-08-14T12:30:00+08:00">2016-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>图片是由许多像素组成的，每个像素都有r，g，b，a4个值。如果对像素的这些值进行改变，就会改变像素的颜色或透明度。</p>
<p>对整个图片的像素进行有选择的改变就能改变整个图片的现实效果(图片滤镜)</p>
<p>首先要确定，rgba值的数据格式是UInt8，不能随意和Int值进行计算，因此在一些求平均值的情况要先将rgba用Int()将这些值转换为int再计算。</p>
<p>源码地址：<a target="_blank" rel="noopener" href="https://github.com/lsvih/ImageProcessor">https://github.com/lsvih/ImageProcessor</a></p>
<p>首先读取图片</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> image = <span class="type">UIImage</span>(named: <span class="string">&quot;sample&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<p><img src="/images/pasted-97.png" alt="upload successful"></p>
<p>写一个滤镜，用于在遍历像素时去掉照片中所有的红色<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeRed</span><span class="params">(<span class="keyword">var</span> pixel: Pixel)</span></span> -&gt;<span class="type">Pixel</span>&#123;</span><br><span class="line">    pixel.red = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述函数的作用为将每个读取到的像素的red值设为0之后再返回。</p>
<p>测试一下这个滤镜：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testRemoveRedFilter</span><span class="params">(image: UIImage)</span></span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> thisImage = <span class="type">RGBAImage</span>(image: image)!</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="number">0</span>..&lt;thisImage.height &#123;</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">0</span>..&lt;thisImage.width &#123;</span><br><span class="line">            <span class="keyword">let</span> sub = y * thisImage.width + x</span><br><span class="line">            <span class="keyword">let</span> pixel = thisImage.pixels[sub]<span class="comment">//遍历每个像素</span></span><br><span class="line">            thisImage.pixels[sub] = removeRed(pixel)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> thisImage.toUIImage()!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述函数作用为遍历图片中的每一个像素，应用上面取出红色的函数后，将像素返回图片。最终得到了如下图片：</p>
<p><img src="/images/pasted-98.png" alt="upload successful"></p>
<p>根据这个原理，可以进行各种滤镜的编写。</p>
<h3 id="1、去除指定颜色"><a href="#1、去除指定颜色" class="headerlink" title="1、去除指定颜色"></a>1、去除指定颜色</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeColor</span><span class="params">(<span class="keyword">var</span> pixel:Pixel,conf:Int)</span></span> -&gt; <span class="type">Pixel</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(conf == <span class="number">0</span>)&#123;</span><br><span class="line">        pixel.red = <span class="number">0</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(conf == <span class="number">1</span>)&#123;</span><br><span class="line">        pixel.green = <span class="number">0</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(conf == <span class="number">2</span>)&#123;</span><br><span class="line">        pixel.blue = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传值0为去除红色，1为去除绿色，2为去除蓝色</p>
<p>运行结果如下</p>
<p><img src="/images/pasted-99.png" alt="upload successful"></p>
<h3 id="2、灰度图"><a href="#2、灰度图" class="headerlink" title="2、灰度图"></a>2、灰度图</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">grayScale</span><span class="params">(<span class="keyword">var</span> pixel:Pixel,conf:Int)</span></span>-&gt;<span class="type">Pixel</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> gray = <span class="type">UInt8</span>((<span class="type">Int</span>(pixel.red)+<span class="type">Int</span>(pixel.green)+<span class="type">Int</span>(pixel.blue))/conf)</span><br><span class="line">    pixel.red = gray</span><br><span class="line">    pixel.green = gray</span><br><span class="line">    pixel.blue = gray</span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>conf可以控制图片灰度，通常为3.对每个像素把他们的rgb值求平均值，这个像素就变成相应的灰色了。</p>
<p>运行结果如下</p>
<p><img src="/images/pasted-100.png" alt="upload successful"></p>
<h3 id="3、更改透明度"><a href="#3、更改透明度" class="headerlink" title="3、更改透明度"></a>3、更改透明度</h3><p>像素rgba中的a值即为透明度，改变a值照片的透明度将发生变化<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">transparentFilter</span><span class="params">(<span class="keyword">var</span> pixel:Pixel,opacity:Int)</span></span>-&gt;<span class="type">Pixel</span>&#123;</span><br><span class="line">    pixel.alpha = <span class="type">UInt8</span>(opacity)</span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由于a为UInt8，因此需要转换。输入的opacity为透明度，从0-255</p>
<p>效果如下</p>
<p><img src="/images/pasted-101.png" alt="upload successful"></p>
<h3 id="4、黑白照片"><a href="#4、黑白照片" class="headerlink" title="4、黑白照片"></a>4、黑白照片</h3><p>定义一个阀值，rgb平均值超过这个阀值的为白否则为黑</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">blackAndWhite</span><span class="params">(<span class="keyword">var</span> pixel:Pixel,conf:Int)</span></span>-&gt;<span class="type">Pixel</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(conf==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> avg = <span class="type">UInt8</span>((<span class="type">Int</span>(pixel.red)+<span class="type">Int</span>(pixel.green)+<span class="type">Int</span>(pixel.blue))/<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span>(avg&gt;<span class="number">100</span>)&#123;</span><br><span class="line">            pixel.red = <span class="number">255</span></span><br><span class="line">            pixel.green = <span class="number">255</span></span><br><span class="line">            pixel.blue = <span class="number">255</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pixel.red = <span class="number">0</span></span><br><span class="line">            pixel.green = <span class="number">0</span></span><br><span class="line">            pixel.blue = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> avg = <span class="type">UInt8</span>((<span class="type">Int</span>(pixel.red)+<span class="type">Int</span>(pixel.green)+<span class="type">Int</span>(pixel.blue))/<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span>(avg&lt;<span class="number">100</span>)&#123;</span><br><span class="line">            pixel.red = <span class="number">255</span></span><br><span class="line">            pixel.green = <span class="number">255</span></span><br><span class="line">            pixel.blue = <span class="number">255</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pixel.red = <span class="number">0</span></span><br><span class="line">            pixel.green = <span class="number">0</span></span><br><span class="line">            pixel.blue = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传值conf为0时生成黑白图片，如果为1则反色</p>
<p>效果如下</p>
<p><img src="/images/pasted-102.png" alt="upload successful"></p>
<h3 id="5、反相"><a href="#5、反相" class="headerlink" title="5、反相"></a>5、反相</h3><p>用255减去rgb值即为反相效果<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">inverseColor</span><span class="params">(<span class="keyword">var</span> pixel:Pixel,conf:Int)</span></span>-&gt;<span class="type">Pixel</span>&#123;</span><br><span class="line">    pixel.red = <span class="built_in">min</span>(<span class="built_in">max</span>(<span class="type">UInt8</span>(conf) - pixel.red,<span class="number">0</span>),<span class="number">255</span>)</span><br><span class="line">    pixel.green = <span class="built_in">min</span>(<span class="built_in">max</span>(<span class="type">UInt8</span>(conf) - pixel.green,<span class="number">0</span>),<span class="number">255</span>)</span><br><span class="line">    pixel.blue = <span class="built_in">min</span>(<span class="built_in">max</span>(<span class="type">UInt8</span>(conf) - pixel.blue,<span class="number">0</span>),<span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> pixel</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>要对减法得到的值进行约束防止出现负数。</p>
<p>效果如下</p>
<p><img src="/images/pasted-103.png" alt="upload successful"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/08/02/%E4%B8%BAHbuilder-iOS-webapp%E9%9B%86%E6%88%90%E6%9E%81%E5%85%89%E6%8E%A8%E9%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/08/02/%E4%B8%BAHbuilder-iOS-webapp%E9%9B%86%E6%88%90%E6%9E%81%E5%85%89%E6%8E%A8%E9%80%81/" class="post-title-link" itemprop="url">为Hbuilder iOS webapp集成极光推送</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-08-02 12:04:00" itemprop="dateCreated datePublished" datetime="2016-08-02T12:04:00+08:00">2016-08-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DCloud的webapp解决方案功能强大，但是官方所集成的是个推并且版本非常老，许多功能（比如说别名推送等等）不能使用，因此为它集成JPush（极光推送）。</p>
<p>集成具体方法如下：</p>
<h3 id="1、下载极光sdk"><a href="#1、下载极光sdk" class="headerlink" title="1、下载极光sdk"></a>1、下载极光sdk</h3><p>在极光官方网站下载极光推送ios sdk 网址：<a target="_blank" rel="noopener" href="http://docs.jiguang.cn/resources/">http://docs.jiguang.cn/resources/</a></p>
<p>将其库文件(如下图所示)提取出来，</p>
<p><img src="/images/pasted-89.png" alt="upload successful"></p>
<p>将其导入Hbuilder XCode工程的Frameworks中（如下图所示）</p>
<p>（1）导入步骤1</p>
<p><img src="/images/pasted-90.png" alt="upload successful"></p>
<p>（2）导入步骤2</p>
<p><img src="/images/pasted-91.png" alt="upload successful"></p>
<h2 id="2、添加文件"><a href="#2、添加文件" class="headerlink" title="2、添加文件"></a>2、添加文件</h2><p>在inc/tools（或其它文件夹）下建立文件PGJiguanPush.h与PGJiguanPush.m，内容如下:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//=========PGJiguanPush.h========</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;PGPlugin.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;PGMethod.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PGJiguanPush</span> : <span class="title">PGPlugin</span></span></span><br><span class="line"><span class="comment">// +(id)alloc</span></span><br><span class="line"><span class="comment">// +(PGJiguanPush *)sharePGJGManager</span></span><br><span class="line">- (<span class="keyword">void</span>)PluginSetTagsFunction:(PGMethod*)commands;</span><br><span class="line">- (<span class="keyword">void</span>)PluginGetRegistrationIDFunction:(PGMethod*)commands;</span><br><span class="line">- (<span class="keyword">void</span>)changeStatus;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="comment">//=========PGJiguanPush.m========</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;JPUSHService.h&quot;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&quot;PGJiguanPush.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PGJiguanPush</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  Boolean registeredStatus ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">PGJiguanPush</span></span></span><br><span class="line"><span class="comment">//获取自定义消息</span></span><br><span class="line"><span class="comment">//static PGJiguanPush * manager = Nil;</span></span><br><span class="line"><span class="comment">// +(PGJiguanPush *)sharePGJGManager</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   @synchronized(self)</span></span><br><span class="line"><span class="comment">//   &#123;</span></span><br><span class="line"><span class="comment">//     if (!manager) &#123;</span></span><br><span class="line"><span class="comment">//       manager = [[PGJiguanPush alloc]init];</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     return manager;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// +(id)alloc</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   @synchronized(self)</span></span><br><span class="line"><span class="comment">//   &#123;</span></span><br><span class="line"><span class="comment">//     if (!manager) &#123;</span></span><br><span class="line"><span class="comment">//       manager =[super alloc];</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     return manager;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// -(id)init</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   if (self = [super init])</span></span><br><span class="line"><span class="comment">//   &#123;</span></span><br><span class="line"> <span class="comment">//    NSNotificationCenter *defaultCenter = [NSNotificationCenter defaultCenter];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(networkDidSetup:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFNetworkDidSetupNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(networkDidClose:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFNetworkDidCloseNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(networkDidRegister:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFNetworkDidRegisterNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(networkDidLogin:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFNetworkDidLoginNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(networkDidReceiveMessage:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFNetworkDidReceiveMessageNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"> <span class="comment">// [defaultCenter addObserver:self</span></span><br><span class="line"> <span class="comment">//          selector:@selector(serviceError:)</span></span><br><span class="line"> <span class="comment">//            name:kJPFServiceErrorNotification</span></span><br><span class="line"> <span class="comment">//           object:nil];</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   return self;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="pragma-mark-插件方法"><a href="#pragma-mark-插件方法" class="headerlink" title="pragma mark 插件方法"></a>pragma mark 插件方法</h1><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置tags 、alias</span></span><br><span class="line">- (<span class="keyword">void</span>)PluginSetTagsFunction:(PGMethod*)commands</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( commands ) &#123;</span><br><span class="line">    <span class="built_in">NSString</span>* cbId = [commands.arguments objectAtIndex:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSString</span>* pArgument1 = [commands.arguments objectAtIndex:<span class="number">1</span>]; <span class="comment">// tags</span></span><br><span class="line">    <span class="built_in">NSString</span>* pArgument2 = [commands.arguments objectAtIndex:<span class="number">2</span>]; <span class="comment">// alias</span></span><br><span class="line">    <span class="built_in">NSSet</span> * tags = [<span class="built_in">NSSet</span> setWithObject:pArgument1];</span><br><span class="line">   [JPUSHService setTags:tags alias:pArgument2 fetchCompletionHandle:^(<span class="keyword">int</span> iResCode, <span class="built_in">NSSet</span> *iTags, <span class="built_in">NSString</span> *iAlias)&#123;</span><br><span class="line">    <span class="built_in">NSArray</span>* pResultString = [<span class="built_in">NSArray</span> arrayWithObjects:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;%d&quot;</span>,iResCode], iTags, iAlias, <span class="literal">nil</span>];</span><br><span class="line">   PDRPluginResult * result = [PDRPluginResult resultWithStatus:PDRCommandStatusOK messageAsArray: pResultString];</span><br><span class="line">    [<span class="keyword">self</span> toCallback:cbId withReslut:[result toJSONString]];</span><br><span class="line">    &#125;];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取 RegistrationID</span></span><br><span class="line">- (<span class="keyword">void</span>)PluginGetRegistrationIDFunction:(PGMethod*)commands</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSNotificationCenter</span> *defaultCenter = [<span class="built_in">NSNotificationCenter</span> defaultCenter];</span><br><span class="line">  [defaultCenter addObserver:<span class="keyword">self</span></span><br><span class="line">           selector:<span class="keyword">@selector</span>(changeStatus)</span><br><span class="line">             name:kJPFNetworkDidLoginNotification</span><br><span class="line">            object:<span class="literal">nil</span>];</span><br><span class="line">  <span class="keyword">if</span> ( commands &amp;amp;&amp;amp; registeredStatus) &#123;</span><br><span class="line">    <span class="built_in">NSString</span>* cbId = [commands.arguments objectAtIndex:<span class="number">0</span>];</span><br><span class="line">    [<span class="keyword">self</span> toCallback:cbId withReslut:[JPUSHService registrationID]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-(<span class="keyword">void</span>)changeStatus</span><br><span class="line">&#123;</span><br><span class="line">  registeredStatus = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//- (void)networkDidSetup:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="comment">//- (void)networkDidClose:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="comment">// - (void)networkDidRegister:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="comment">// - (void)networkDidLogin:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="comment">//- (void)networkDidReceiveMessage:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="comment">// - (void)serviceError:(NSNotification *)notification &#123;｝</span></span><br><span class="line"><span class="comment">// - (void)unObserveAllNotifications &#123;</span></span><br><span class="line"><span class="comment">//  NSNotificationCenter *defaultCenter = [NSNotificationCenter defaultCenter];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFNetworkDidSetupNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFNetworkDidCloseNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFNetworkDidRegisterNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFNetworkDidLoginNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFNetworkDidReceiveMessageNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">//  [defaultCenter removeObserver:self</span></span><br><span class="line"><span class="comment">//              name:kJPFServiceErrorNotification</span></span><br><span class="line"><span class="comment">//             object:nil];</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//- (void)serviceError:(NSNotification *)notification &#123;&#125;</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>(根据业务需求，没有具体写自定义消息的方法，只使用了标准消息，如果有需要可以自己弄)</p>
<h2 id="3、增加全局描述"><a href="#3、增加全局描述" class="headerlink" title="3、增加全局描述"></a>3、增加全局描述</h2><p>在Supporting Files目录下找到pch文件，在文件最后加上</p>
<p>static NSString *appKey = @”你的appkey”;// appkey,极光创建app时能拿到</p>
<p>static NSString *channel = @”0”;// App Store等渠道，乱填也行~</p>
<p>static BOOL isProduction = 0; //值要与Build Settings的Code Signing配置的证书环境一致 0开发 1生产</p>
<h2 id="4、添加注册、接收等方法"><a href="#4、添加注册、接收等方法" class="headerlink" title="4、添加注册、接收等方法"></a>4、添加注册、接收等方法</h2><p>参考极光官方文档，网址：<a target="_blank" rel="noopener" href="http://docs.jiguang.cn/guideline/ios_guide/">http://docs.jiguang.cn/guideline/ios_guide/</a></p>
<p>修改inc/AppDelegate.m如下：</p>
<p>（1）在头部添加引用</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;JPUSHService.h&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>如下图所示</p>
<p><img src="/images/pasted-92.png" alt="upload successful"></p>
<p>（2）在官方注释”程序启动时收到push消息”的代码做如下修改：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 设置当前SDK运行模式</span></span><br><span class="line">  <span class="built_in">BOOL</span> ret = [PDRCore initEngineWihtOptions:launchOptions</span><br><span class="line">                 withRunMode:PDRCoreRunModeNormal];</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改成<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 设置当前SDK运行模式</span></span><br><span class="line">  <span class="built_in">BOOL</span> ret = [PDRCore initEngineWihtOptions:launchOptions</span><br><span class="line">                 withRunMode:PDRCoreRunModeNormal];</span><br><span class="line">  [JPUSHService registerForRemoteNotificationTypes:(<span class="built_in">UIUserNotificationTypeBadge</span> |</span><br><span class="line">                           <span class="built_in">UIUserNotificationTypeSound</span> |</span><br><span class="line">                           <span class="built_in">UIUserNotificationTypeAlert</span>)</span><br><span class="line">                     categories:<span class="literal">nil</span>];</span><br><span class="line">  [JPUSHService setupWithOption:launchOptions appKey:appKey</span><br><span class="line">             channel:channel</span><br><span class="line">        apsForProduction:isProduction</span><br><span class="line">      advertisingIdentifier:<span class="literal">nil</span>];</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>（3）官方注释“远程push注册成功收到DeviceToken回调”的代码做如下修改：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken</span><br><span class="line">&#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRevDeviceToken withObject:deviceToken];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改成</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken</span><br><span class="line">&#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRevDeviceToken withObject:deviceToken];</span><br><span class="line">  [JPUSHService registerDeviceToken:deviceToken];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（4）官方注释“远程push注册失败”的代码做如下修改：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRegRemoteNotificationsError withObject:error];</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo &#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRevRemoteNotification withObject:userInfo];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>改成<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRegRemoteNotificationsError withObject:error];</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@&quot;did Fail To Register For Remote Notifications With Error: %@&quot;</span>, error);</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo &#123;</span><br><span class="line">  [PDRCore handleSysEvent:PDRCoreSysEventRevRemoteNotification withObject:userInfo];</span><br><span class="line">  [JPUSHService handleRemoteNotification:userInfo];</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@&quot;JPush成功接收消息，可以在webview中获取了&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="5、在webview中获取推送事件"><a href="#5、在webview中获取推送事件" class="headerlink" title="5、在webview中获取推送事件"></a>5、在webview中获取推送事件</h2><p>完成以上修改后，使用XCode运行APP可以在LOG中看到类似</p>
<p><strong>2016-08-02 19:03:07.690 | JPUSH | I - [JPUSHDeviceTokenReport] upload device token success</strong></p>
<p>的消息则说明极光推送已经集成成功，如果在极光推送后台统计页面可以看到此时的应用安装数量增加了1</p>
<p>由于是直接在AppDelegate.m的didReceiveRemoteNotification中写的[JPUSHService handleRemoteNotification:userInfo]，因此消息直接传给了基座，可以直接在webview网页中用plus.push获取消息。</p>
<p>例如，我直接在index.html中写了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mui.plusReady(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> plus.push.addEventListener( <span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> msg </span>) </span>&#123;</span><br><span class="line">   alert( <span class="string">&quot;用户点击了消息: &quot;</span> + <span class="built_in">JSON</span>.stringify(msg) );</span><br><span class="line"> &#125;, <span class="literal">false</span> );</span><br><span class="line"> plus.push.addEventListener( <span class="string">&quot;receive&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"> msg </span>) </span>&#123;</span><br><span class="line">   alert( <span class="string">&quot;app收到了消息: &quot;</span> + <span class="built_in">JSON</span>.stringify(msg) );</span><br><span class="line"> &#125;, <span class="literal">false</span> );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="6、测试"><a href="#6、测试" class="headerlink" title="6、测试"></a>6、测试</h2><p>在极光开发者后台增加一条推送消息试试</p>
<p><img src="/images/pasted-93.png" alt="upload successful"></p>
<p>在app中弹出了对应消息</p>
<p><img src="/images/pasted-94.png" alt="upload successful"></p>
<p>静默发送参数试试</p>
<p><img src="/images/pasted-95.png" alt="upload successful"></p>
<p>成功地获取了传送的参数</p>
<p><img src="/images/pasted-96.png" alt="upload successful"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/31/Javascript%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/31/Javascript%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/" class="post-title-link" itemprop="url">Javascript的作用域与作用域链</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-07-31 10:35:00" itemprop="dateCreated datePublished" datetime="2016-07-31T10:35:00+08:00">2016-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>不提ES6新声明的作用域声明(let等)，单纯看js的作用域。</p>
<p>作用域的定义：作用域是某一变量和方法具有访问权限的代码控件。</p>
<p>在JS中作用域主要由全局作用域和本地（函数）作用域两种，全局变量在所有函数中都能被访问到，本地作用域声明的变量只能在当前函数代码块中被访问；</p>
<p>例如：</p>
<p>1、全局变量能被直接访问<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure></p>
<p>2、全局变量能再函数内部访问<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure></p>
<p>3、本地作用域（函数内部）声明的变量能被本作用域（本函数）内部直接访问</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure>
<p>4、本地作用域（函数内部）声明的变量不能在作用域外（函数外部）被访问<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line">alert(a);<span class="comment">//=&gt; undefined</span></span><br></pre></td></tr></table></figure></p>
<p>5、本地作用域声明的变量不能在其外部的别的本地作用域中被访问<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line">run();<span class="comment">//=&gt; undefined</span></span><br></pre></td></tr></table></figure></p>
<p>6、本地作用域内部的作用域能访问到上级声明的变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt;0</span></span><br></pre></td></tr></table></figure>
<p>7、本地作用域声明的变量级别比全局变量高，能在作用域内覆盖全局变量声明<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a - <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 1</span></span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure></p>
<p>由此可知，js的作用域是从上往下继承，作用域内部函数能访问本作用域声明的函数与外部作用域生成的函数。</p>
<p>由此可以明确js的作用域链概念。</p>
<p>例如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">parent();<span class="comment">//=&gt; 0,=&gt; 1,=&gt;0</span></span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure></p>
<p>parent()内第一个alert(a)的作用域链是parent()-&gt;window，所以此时a是0；</p>
<p>child1()内alert(a)的作用域链是child1()-&gt;parent()-&gt;window，在child1中重新声明了a的值，覆盖了全局变量的值因此此时a是1；</p>
<p>child2()中alert(a)的作用域链是child2()-&gt;parent()-&gt;window，与child1中声明的a=1毫无关联，因此此时的a的值还是0;</p>
<p>最后一个alert(a)作用域链是window，此时a的值为0；</p>
<p>js的作用域与作用域链的概念可以简单清晰的按如上描述。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/27/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%8C%89%E9%92%AE%E8%BF%87%E5%B0%8F%E7%82%B9%E5%87%BB%E5%9B%B0%E9%9A%BE%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/27/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%8C%89%E9%92%AE%E8%BF%87%E5%B0%8F%E7%82%B9%E5%87%BB%E5%9B%B0%E9%9A%BE%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">移动端按钮过小点击困难的解决方案</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-07-27 11:20:00" itemprop="dateCreated datePublished" datetime="2016-07-27T11:20:00+08:00">2016-07-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/pasted-87.png" alt="upload successful"></p>
<p>按钮如图所示，长宽都很小，导致在使用时点击困难。</p>
<p>解决方案：在按钮之上覆盖一层点击区域，将按钮的触发事件放在此区域之上</p>
<p><img src="/images/pasted-88.png" alt="upload successful"></p>
<p>添加点击区域后可操作范围明显增大。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/27/%E8%A7%A3%E5%86%B3%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E6%97%A0%E6%B3%95%E9%A1%BA%E5%88%A9%E7%9B%91%E5%90%AConscroll%E4%BA%8B%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/27/%E8%A7%A3%E5%86%B3%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E6%97%A0%E6%B3%95%E9%A1%BA%E5%88%A9%E7%9B%91%E5%90%AConscroll%E4%BA%8B%E4%BB%B6/" class="post-title-link" itemprop="url">解决在手机上无法顺利监听onscroll事件</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-07-27 09:28:00" itemprop="dateCreated datePublished" datetime="2016-07-27T09:28:00+08:00">2016-07-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在进行制作视差滚动效果时，需要获得每时每刻滚动条的位置以进行计算，因此会使用window.onscroll来监听滚动条的位置。在pc上可以顺利的连续获得滚动条的任意时刻的坐标，然而在手机上无法顺利获得连续的事件触发。原因是移动端为了获得流畅的滚动效果与弹性效果，对于系统原生的滚动事件进行了限制，因此无法获得连续的滚动事件。</p>
<p>为了在移动端上实现视差网页效果，需要手动模拟用户滚动的事件，这样才能连续获取事件触发。通常使用iscroll等帮助实现效果。</p>
<p>在寻找相关滚动库的时候发现了一款小巧又好用的滚动js库 Jroll,大小仅仅只有13KB,比iscroll的lite版本还要小一半，而且能够完整实现需求。</p>
<p>Git地址:<a target="_blank" rel="noopener" href="https://git.oschina.net/chenjianlong/JRoll2">https://git.oschina.net/chenjianlong/JRoll2</a></p>
<p>官网:<a target="_blank" rel="noopener" href="http://www.chjtx.com/JRoll/">http://www.chjtx.com/JRoll/</a></p>
<p>用法：</p>
<p>引用<code>&lt;script src=&#39;jroll.js&#39;&gt;&lt;/script&gt;</code>后，在文档中定义好滚动对象与滚动容器，例如<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;scroller&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>其中scroller为滚动对象，wrapper为滚动容器。需要注意的是滚动对象的高必须大于滚动容器的高才能顺利地进行滚动操作（废话）</p>
<p>接着创建jroll对象，如下所示<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jroll = <span class="keyword">new</span> JRoll(<span class="string">&quot;#wrapper&quot;</span>, &#123;option&#125;);</span><br></pre></td></tr></table></figure></p>
<p>其中option为配置内容，具体使用方法见官网。</p>
<p>另外，当在页面(滚动对象)中存在类似于动态加载与文本展开等情况的时候，在加载完毕与文本展开动画播放完毕的时候必须要使用jroll.refresh()对jroll对象进行刷新，不然jroll的高度不会发生改变从而使页面显示不全。</p>
<p>在项目中，使用jroll完美地完成了视差滚动效果的实现，在ios设备上的webapp中滚动动画打到了40fps以上。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jroll.on(<span class="string">&#x27;scroll&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//视差滚动计算</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/15/%E4%BD%BF%E7%94%A8canvas%E5%88%B6%E4%BD%9C%E7%94%BB%E5%9B%BE%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/07/15/%E4%BD%BF%E7%94%A8canvas%E5%88%B6%E4%BD%9C%E7%94%BB%E5%9B%BE%E6%9D%BF/" class="post-title-link" itemprop="url">使用canvas制作画图板</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-07-15 03:28:00" itemprop="dateCreated datePublished" datetime="2016-07-15T03:28:00+08:00">2016-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>原理：在canvas画布上捕捉鼠标（手指）动作，关注下笔、拖动、抬笔三个事件。</p>
<p>下笔使用onmousedown/ontouchstart，拖动使用onmousemove/ontouchmove，抬笔使用onmouseup/ontouchend，同时需要检测笔尖是否移动到画布外（onmouseout）。</p>
<p>在这三个事件被捕捉后，就能顺利的在画布上生成图像了。</p>
<p>在画布上自由画画：</p>
<p>Html:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;canvas&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1024&quot;</span> <span class="attr">height</span>=<span class="string">&quot;665&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Javascript:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> can = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"><span class="comment">//定义画布</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/****使用自由画笔****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Brush</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> sX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> sY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	<span class="comment">//获取起始坐标</span></span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.moveTo(sX, sY);</span><br><span class="line">	status = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔移动的时候</span></span><br><span class="line">canvas.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">if</span>(status == <span class="number">1</span>) &#123;</span><br><span class="line">		can.lineTo(eX, eY);</span><br><span class="line">		can.stroke();</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔抬起的时候</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	can.closePath();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Brush();</span><br></pre></td></tr></table></figure>
<p>通过以上代码可以实现在画布上自由绘画。</p>
<p>用按钮触发以上函数可实现选择“自由画笔工具”绘画。</p>
<p>相似的，画直线、画圆形、画矩形也是如此：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****画直线****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Line</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.moveTo(sX, sY);</span><br><span class="line">&#125;</span><br><span class="line">canvas.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔抬起时，画笔位置为终点</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	can.lineTo(eX, eY);</span><br><span class="line">	can.closePath();</span><br><span class="line">	can.stroke();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****画空心圆形****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Arc</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画空心圆，鼠标抬起时，当前画笔位置为外圆结束点</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> dX = eX - sX</span><br><span class="line">	<span class="keyword">var</span> dY = eY - sY;</span><br><span class="line"><span class="keyword">var</span> r = <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(dX, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(dY, <span class="number">2</span>)); </span><br><span class="line">	<span class="comment">//计算出半径</span></span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.arc(sX, sY, r, <span class="number">0</span>, <span class="number">360</span>, <span class="literal">false</span>);</span><br><span class="line">	can.closePath();</span><br><span class="line">	can.stroke();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****画矩形****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rect</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画空心矩形，画笔抬起时，当前画笔位置为矩形的右下角</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> w = eX - sX; <span class="comment">//矩形的宽</span></span><br><span class="line">	<span class="keyword">var</span> h = eY - sY; <span class="comment">//矩形的高</span></span><br><span class="line">	can.strokeRect(sX, sY, w, h);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过以上代码可以实现简单的画图板。但是会产生一个问题：画矩形与圆形时 在画笔移动时，画布上不会产生相应的图形，只有在画笔抬起时才会产生图像，所以在画画的时候感知不到自己纠结画出的图形是怎样的，这样的体验非常差。因此，使用双画布来解决这个问题，即在本来的画布上放一个同样大小的画布，移动画笔的时候在临时画布上不断地清除、绘制图像就能使用户感知到画画的过程。</p>
<p>临时画布需要设置position:absolute与z-index来与主画布重叠。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****清除临时画布的函数****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearContext</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    can_bak.clearRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1024</span>, <span class="number">665</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>例如画圆形时，加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">canvas_bak.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	clearContext();</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="built_in">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="built_in">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> dX = eX - sX</span><br><span class="line">	<span class="keyword">var</span> dY = eY - sY;</span><br><span class="line"><span class="keyword">var</span> r = <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(dX, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(dY, <span class="number">2</span>));</span><br><span class="line">	can_bak.beginPath();</span><br><span class="line">	can_bak.arc(sX, sY, r, <span class="number">0</span>, <span class="number">360</span>, <span class="literal">false</span>);</span><br><span class="line">	can_bak.closePath();</span><br><span class="line">	can_bak.stroke();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在ontouchend中加上clearContext();即可。</p>
<p>最终效果：</p>
<p><img src="/images/pasted-86.png" alt="upload successful"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备18029472号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lsvih</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    menuSettings: {
      zoom: "None"
    },
    showMathMenu: false,
    jax: ["input/TeX","output/CommonHTML"],
    extensions: ["tex2jax.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js"],
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [["$", "$"],["\\(", "\\)"]],
      displayMath: [["\\[", "\\]"]]
    }
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  <script src="//cdn.jsdelivr.net/npm/algoliasearch@4.4.0/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4.7.1/dist/instantsearch.production.min.js"></script><script src="/js/algolia-search.js"></script>













  








  

  

  

</body>
</html>
