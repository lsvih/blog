<!DOCTYPE html><html class="theme-next pisces"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0"><link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"6.5.0",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"6U6P1RGK4F",apiKey:"b14e73cdd627eabe947b5decbe14850f",indexName:"lsvih",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="website"><meta property="og:title" content="My note"><meta property="og:url" content="https://lsvih.com/page/12/index.html"><meta property="og:site_name" content="My note"><meta property="og:locale" content="default"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="My note"><link rel="alternate" href="/atom.xml" title="My note" type="application/atom+xml"><link rel="canonical" href="https://lsvih.com/page/12/"><script type="text/javascript" id="page.configurations">CONFIG.page={sidebar:""}</script><title>My note – lsvih</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?4de170e51b04cee02fbdb1b7cb7a8a60";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style type="text/css">.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="default"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">My note</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">lsvih</h1></div><div class="site-nav-toggle"><button aria-label="Toggle navigation bar"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/05/03/机器学习学习笔记（十一）调试算法/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/05/03/机器学习学习笔记（十一）调试算法/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">机器学习学习笔记（十一）调试算法</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-05-03 07:30:00" itemprop="dateCreated datePublished" datetime="2016-05-03T07:30:00+08:00">2016-05-03</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>当发现测试算法时预测的结果有非常大的误差时,有以下几种方法解决问题:</p><ol><li><p>使用更大的训练集</p></li><li><p>使用更少的特征值</p></li><li><p>使用更多的特征值</p></li><li><p>使用更高次幂的特征值</p></li><li><p>减少正则化参数</p></li><li><p>增加正则化参数</p></li></ol><p>判断如何选择方法不应该”凭感觉”选择,而应该科学地使用机器学习诊断法进行判断,以更省时间,更有意义地改进算法.</p><h3 id="过拟合与欠拟合"><a href="#过拟合与欠拟合" class="headerlink" title="过拟合与欠拟合"></a>过拟合与欠拟合</h3><p><img src="/images/pasted-56.png" alt="upload successful"></p><p>(图为过拟合)</p><p>过拟合与欠拟合都将不能很好的匹配新的数据.</p><p>方法:将所有数据分为训练集与测试集.比例可以使用7:3.</p><p>当训练集的$J(\theta )$很小,测试集的$J(\theta )$很大时,此时即为过拟合的情况.</p><script type="math/tex;mode=display">J_{test}(\theta )=\frac{1}{2m_{test}}\sum_{i=1}^{m_{test}}(h_{\theta}(x_{test}^{i})-y_{test}^{i})^{2}</script><p>以上公式即为线性回归测试集误差计算公式;</p><script type="math/tex;mode=display">J_{test}(\theta )=-\frac{1}{m_{test}}\sum_{i=1}^{m_{test}}y_{test}^{i}\log h_{\theta }(x_{test}^{i})+(1-y_{test}^{i})\log h_{\theta }(x_{test}^{i})</script><p>以上公式为逻辑回归测试误差公式;</p><p>可以看到其实误差公式与代价函数的计算是一致的.</p><p>通过以上计算公式可以量化测试集测试训练集的训练结果.</p><hr><h3 id="确定多项式的次数"><a href="#确定多项式的次数" class="headerlink" title="确定多项式的次数"></a>确定多项式的次数</h3><p>已经知道,当多项式的次数过高的时候,会发生过拟合现象.如何根据数据来确定多项式次数d呢?</p><p>与之前加上验证集不同的是,将数据集分成三部分:训练集,测试集,交叉验证级.</p><p>选择不同的多项式次数分别对验证集进行计算,</p><script type="math/tex;mode=display">1. h_{\theta }(x)=\theta _{0}+\theta _{1}x\\2. h_{\theta }(x)=\theta _{0}+\theta _{1}x+\theta _{2}x^{2}\\3. h_{\theta }(x)=\theta _{0}+\theta _{1}x+...+\theta _{3}x^{3}\\\vdots \\10. h_{theta }(x)=\theta _{0}+\theta _{1}x+...+\theta _{10}x^{10}</script><p>得到各自的$J_{cv}(\theta )$,由此可以选择出最合适的多项式次数.</p><hr><p>因此,选择算法使用验证集进行模型选择,使用测试集来评价模型的好坏,这样就能找到合适的模型.</p><h2 id="偏差-bias-与方差-variance"><a href="#偏差-bias-与方差-variance" class="headerlink" title="偏差(bias)与方差(variance)"></a>偏差(bias)与方差(variance)</h2><p><img src="/images/pasted-57.png" alt="upload successful"></p><p>具体来说,欠拟合是高偏差情况,过拟合是高方差情况.</p><p>分别对训练集和验证集的误差情况与多项式次数进行画图</p><p><img src="/images/pasted-58.png" alt="upload successful"></p><p>可以看到当项数次数过少时,错误相当的大,此时是高偏差情况;当项数次数过多时,训练集的误差变得非常小,呈现出过拟合的情况.但是交叉验证集的错误将急剧上升,此时的情况是高方差.</p><p>直接描述就是:训练集误差小验证集误差大时,就是过拟合-高方差情况;</p><h3 id="选择合适的正则化参数lambda"><a href="#选择合适的正则化参数lambda" class="headerlink" title="选择合适的正则化参数lambda"></a>选择合适的正则化参数lambda</h3><p>改变lambda时,训练集$J_{train}$与交叉验证集$J_{cv}$都会发生一定的变化.</p><p>当参数过多过大时，后面的正则化项的值就会很大，因而导致$ J(\theta )$也变大，从而使这个预测方程得到更多的惩罚，使其像参数变量尽量小的地步靠拢。对正则化过程有影响的是lambda，当lambda数值大的时候，函数收到的惩罚更多，会更快地减少参数数值；当lambda为0的时候，函数则不会对参数进行正则化处理。</p><p>如图所示</p><p><img src="/images/pasted-59.png" alt="upload successful"></p><p>当lambda过大时,会处于高偏差情况,$J_{train}$的值会很大,lambda值过小时会处于过拟合情况.</p><p>因此,上图的左端对应着高方差,右端对应着高偏差问题,</p><h3 id="学习曲线"><a href="#学习曲线" class="headerlink" title="学习曲线"></a>学习曲线</h3><p>用于判断算法的学习情况.可以判断此时处于高方差高偏差情况以对于算法进行修改.</p><p>绘出$J_{train}(\theta )$与$J_{cv}(\theta )$的图像.</p><p><img src="/images/pasted-60.png" alt="upload successful"></p><p>上图为训练集大小与两个J的对应情况.</p><p>当训练集过大时,$J_{train}$越来越难对与过大的训练集做出良好的拟合,因此在图上表现出m越大error越多.</p><p>相反,当训练集大的时候,$J_{cv}$更能获得更好的泛化,即对新样品的适应更好,因此可以得到上述曲线.</p><p>如果不使用多项式拟合而直接用一条直线,那么数据集的大小再大也于事无补,无法更加接近实际情况.此时$J_{train}$与$J_{cv}$会很接近,</p><p><img src="/images/pasted-61.png" alt="upload successful"></p><p>这种情况便是高偏差情况.</p><p>反之,如果项数很大的话,学习曲线会如图所示:</p><p><img src="/images/pasted-62.png" alt="upload successful"></p><p>$J_{train}$与$J_{cv}$间会有很大的差距,这种情况是高方差.</p><hr><hr><p>回到最开始的情况</p><ol><li><p>使用更大的训练集可以对于高方差的情况有所帮助(将学习曲线画出来可以看出)</p></li><li><p>使用更少的特征值可以修复一定的高方差情况.</p></li><li><p>使用更多的特征值可以修复高偏差情况</p></li><li><p>使用更高次幂的特征值可以修复高偏差情况</p></li><li><p>减少正则化参数可以修复高偏差</p></li><li><p>增加正则化参数可以修复高方差</p></li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/05/03/爬虫python解析json与python下载图片/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/05/03/爬虫python解析json与python下载图片/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">爬虫python解析json与python下载图片</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-05-03 04:24:00" itemprop="dateCreated datePublished" datetime="2016-05-03T04:24:00+08:00">2016-05-03</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>目标:<a href="http://yun.kujiale.com/api/openfps?query=beijing&amp;start=1&amp;num=50" target="_blank" rel="noopener">http://yun.kujiale.com/api/openfps?query=beijing&amp;start=1&amp;num=50</a> 中的所有户型数据,将其户型图片下载到本地.</p></blockquote><p>目标中的数据以json形式存在,因此使用json.loads.</p><p>全部代码如下:<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> urllib </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">valifile</span><span class="params">(name)</span>:</span></span><br><span class="line">    rstr = <span class="string">r"[/\:*?"</span>&lt;&gt;|]<span class="string">"  # ';/:*?"</span>&lt;&gt;|<span class="string">';</span></span><br><span class="line"><span class="string">    valiname = re.sub(rstr, "", name)</span></span><br><span class="line"><span class="string">    return valiname</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def getkjlimages():</span></span><br><span class="line"><span class="string">	for i in range(0,1000000):</span></span><br><span class="line"><span class="string">		print(i)</span></span><br><span class="line"><span class="string">		i = str(i*6)</span></span><br><span class="line">		surl = ';http://yun.kujiale.com/api/openfps?query=beijing&amp;amp;start=';+i+';&amp;amp;num=6';</span><br><span class="line">		ret=requests.get(url=surl) </span><br><span class="line">		ret.encoding=<span class="string">';utf-8'</span>;</span><br><span class="line">		kjl = json.loads(ret.text)</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">49</span>):</span><br><span class="line">			itmes = kjl[<span class="string">';obsExFps'</span>;][j]</span><br><span class="line">			name = json.dumps(itmes[<span class="string">';name'</span>;])[<span class="number">1</span>:<span class="number">-1</span>].decode(<span class="string">"unicode-escape"</span>)</span><br><span class="line">			src = json.dumps(itmes[<span class="string">';pics'</span>;])[<span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">			<span class="comment">##name和src后面加了[1:-1]的原因是json数据中包含了前后两个引号,要将其去掉</span></span><br><span class="line">			print(<span class="string">';img_src='</span>;+json.dumps(itmes[<span class="string">';pics'</span>;]))</span><br><span class="line">			img = urllib.urlopen(src).read()</span><br><span class="line">			f = file(<span class="string">';imgs/'</span>;+validateTitle(name)+<span class="string">';.jpg'</span>;,<span class="string">"wb"</span>)</span><br><span class="line">			f.write(img)</span><br><span class="line">			f.close</span><br><span class="line">getkjlimages()</span><br></pre></td></tr></table></figure><p></p><p>其中,json.dumps出来的字符串为 uxxxx形式,需要用decode(“unicode-escape”)进行转换成中文.另外,由于爬下来的name要直接用于文件名,其中有””等符号,因此需要将name合法化.<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">valifile</span><span class="params">(name)</span>:</span></span><br><span class="line">    rstr = <span class="string">r"[/\:*?"</span>&lt;&gt;|]<span class="string">"  # ';/:*?"</span>&lt;&gt;|<span class="string">';</span></span><br><span class="line"><span class="string">    valiname = re.sub(rstr, "", name)</span></span><br><span class="line"><span class="string">    return valiname</span></span><br></pre></td></tr></table></figure><p></p><p>通过以上valifile可以将文件名在windows下合法化.</p><p>运行结果:</p><p><img src="/images/pasted-55.png" alt="upload successful"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/29/requests-pyquery爬虫体验/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/29/requests-pyquery爬虫体验/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">requests+pyquery爬虫体验</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-29 08:07:00" itemprop="dateCreated datePublished" datetime="2016-04-29T08:07:00+08:00">2016-04-29</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>目标网站:<a href="http://jc.bjmemc.com.cn/IndexAirReport/AirDailyReport.aspx" target="_blank" rel="noopener">http://jc.bjmemc.com.cn/IndexAirReport/AirDailyReport.aspx</a></p><p>需要将所有数据爬下放到数据库中.中途遇到了各种编码问题,因此使用了requests获取页面.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> pyquery <span class="keyword">import</span> PyQuery <span class="keyword">as</span> pyq</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(text)</span>:</span></span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(text.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getandupload</span><span class="params">()</span>:</span></span><br><span class="line">	conn=MySQLdb.connect(host=<span class="string">'localhost'</span>,user=<span class="string">'root'</span>,passwd=<span class="string">''</span>,port=<span class="number">3306</span>,charset=<span class="string">'utf8'</span>)</span><br><span class="line">	cur=conn.cursor()</span><br><span class="line">	conn.select_db(<span class="string">'pytest'</span>)</span><br><span class="line">	ret=requests.get(url=<span class="string">"http://jc.bjmemc.com.cn/IndexAirReport/AirDailyReport.aspx"</span>) </span><br><span class="line">	doc=pyq(ret.text)</span><br><span class="line">	date = re.findall(<span class="string">r'(w*[0-9]+)w*'</span>,doc.find(<span class="string">'#Label0'</span>).text())</span><br><span class="line">	<span class="comment">#正则,将数字提取出来(为了将yyyy年mm月dd日改成yyyy/mm/dd)</span></span><br><span class="line">	date = date[<span class="number">0</span>]+<span class="string">'/'</span>+date[<span class="number">1</span>]+<span class="string">'/'</span>+date[<span class="number">2</span>]</span><br><span class="line">	table = pyq(pyq(doc.find(<span class="string">'#marqueebox'</span>)).find(<span class="string">'table'</span>))</span><br><span class="line">	stations = re.findall(<span class="string">r'&lt;td style="width:126px"&gt;(.+?)&lt;/td&gt;'</span>,table.html())</span><br><span class="line">	aqis = re.findall(<span class="string">r'&lt;td style="width:90px"&gt;(.+?)&lt;/td&gt;'</span>,table.html())</span><br><span class="line">	<span class="comment">#通过正则将html代码中需要的数据提取出来并存在数组中.</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">35</span>):</span><br><span class="line">		value=[md5(date+stations[i][<span class="number">1</span>:]),date,stations[i][<span class="number">1</span>:],aqis[<span class="number">2</span>*i]]</span><br><span class="line">		cur.execute(<span class="string">'insert ignore into aqi_bjmemc values(%s,%s,%s,%s)'</span>,value)</span><br><span class="line">	        <span class="comment">#设置了md5id为主键,因此当传重复数据的时候md5id重复,避免了重复上传数据.</span></span><br><span class="line">	conn.commit()</span><br><span class="line">	cur.close()</span><br><span class="line">	conn.close()</span><br><span class="line">getandupload()</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/27/python对于时间（hh-mm）进行循环递增/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/27/python对于时间（hh-mm）进行循环递增/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">python对于时间（hh:mm）进行循环递增</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-27 02:52:00" itemprop="dateCreated datePublished" datetime="2016-04-27T02:52:00+08:00">2016-04-27</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>某数据写入数据表时，其中一个字段是time，具体内容是从00:00一直到23:30。因此打算用python对csv文件进行逐行处理，新建time列，其中的数据按照半小时递增。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#对于时间进行处理需要引入time</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">importcsv</span><span class="params">(filename,outfilename)</span>:</span></span><br><span class="line">    print(filename)</span><br><span class="line">    filenamerow = filename.split(<span class="string">'-'</span>)</span><br><span class="line">    filenamerow[<span class="number">2</span>] = filenamerow[<span class="number">2</span>][:<span class="number">-4</span>]</span><br><span class="line">    date = filenamerow[<span class="number">1</span>]</span><br><span class="line">    type = filenamerow[<span class="number">2</span>]</span><br><span class="line">    lctime = <span class="number">1325347200.0</span></span><br><span class="line">    <span class="comment">#设定一个时间戳，对应的是某一天的00:00</span></span><br><span class="line">    g=file(type+ <span class="string">'-'</span> +date+ <span class="string">'.csv'</span>,<span class="string">'w+'</span>)</span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        line = f.readline()</span><br><span class="line">        <span class="keyword">while</span> line:</span><br><span class="line">            line = line.replace(<span class="string">'n'</span>,<span class="string">''</span>)</span><br><span class="line">            line = line.replace(<span class="string">'r'</span>,<span class="string">''</span>)</span><br><span class="line">            line = line + <span class="string">',,'</span></span><br><span class="line">            row = line.split(<span class="string">','</span>)</span><br><span class="line">            row[<span class="number">2</span>] = row[<span class="number">0</span>]</span><br><span class="line">            x = time.localtime(lctime)</span><br><span class="line">            <span class="comment">#对时间戳进行处理,得到</span></span><br><span class="line">            <span class="comment">#time.struct_time(tm_year=2012, tm_mon=1, tm_mday=1, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=6, tm_yday=1, tm_isdst=0)</span></span><br><span class="line">            row[<span class="number">1</span>] = time.strftime(<span class="string">'%H:%M'</span>,x)</span><br><span class="line">            <span class="comment">#对以上的时间进行格式化并写入第二列。格式为HH:MM</span></span><br><span class="line">            row[<span class="number">0</span>] = date</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(row)<span class="number">-1</span>):</span><br><span class="line">                row[i] = row[i] + <span class="string">','</span></span><br><span class="line">            g.writelines(row)</span><br><span class="line">            g.writelines(<span class="string">'n'</span>)</span><br><span class="line">            lctime = lctime + <span class="number">1800.0</span></span><br><span class="line">            <span class="comment">#时间戳加上1800，相当于加上了1800s = 30min</span></span><br><span class="line">            line = f.readline()</span><br><span class="line">    g.close()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ListFiles</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(data_folder):</span><br><span class="line">        <span class="keyword">if</span> i.endswith(<span class="string">'.csv'</span>):</span><br><span class="line">            importcsv(i,i)</span><br></pre></td></tr></table></figure><p></p><p>python中时间戳都是以s为单位，且格式为<strong>浮点</strong></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/21/探究函数矩阵化运算——逐步分析对于线性回归代价函数的矩阵化/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/21/探究函数矩阵化运算——逐步分析对于线性回归代价函数的矩阵化/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">探究函数矩阵化运算——逐步分析对于线性回归代价函数的矩阵化</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-21 10:36:00" itemprop="dateCreated datePublished" datetime="2016-04-21T10:36:00+08:00">2016-04-21</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>在此之前没有接触过矩阵化运算，因此对于矩阵化运算的过程一头雾水。准备对于线性回归的代价函数进行矩阵化以探究其过程。</p><hr><p>CostFuction 数学表达式：</p><script type="math/tex;mode=display">J(\theta)=\frac{1}{2m}\sum^m_{i=1}(h_\theta(x^{(i)})-y^{(i)})^2</script><p>根据数学式之前以for循环写了算法：<br></p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:m</span><br><span class="line">J += (theta(<span class="number">1</span>)+ theta(<span class="number">2</span>)*X(<span class="built_in">i</span>,<span class="number">2</span>)-y(<span class="built_in">i</span>))^<span class="number">2</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">J = J/(<span class="number">2</span>*m);</span><br></pre></td></tr></table></figure><p></p><p>很明确的循环符合数学式。</p><p>尝试对齐进行矩阵化，首先看$h_\theta(x^{(i)})$</p><script type="math/tex;mode=display">h_\theta(x)=\theta^T x = \theta_0 + \theta_1 x_1</script><p>对每个x(i)进行运算：</p><p><img src="/images/pasted-54.png" alt="upload successful"></p><p>对其进行sum与转置操作后可以得到</p><script type="math/tex;mode=display">\sum((\theta'.*X)')-y'= \\ [\theta_1 x^{(1)}_1+\theta_2 x^{(1)}_2 -y^{(1)},\theta_1 x^{(2)}_1+\theta_2 x^{(2)}_2 -y^{(2)},...,\theta_1 x^{(m)}_1+\theta_2 x^{(m)}_2 -y^{(m)}]</script><p>因此可以得知代价函数的矩阵化函数式为：</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">J = sum((sum((theta'.*X)')-y').^<span class="number">2</span>)/(<span class="number">2</span>*m);</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/21/js获取url中的参数传值/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/21/js获取url中的参数传值/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">js获取url中的参数传值</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-21 06:57:00" itemprop="dateCreated datePublished" datetime="2016-04-21T06:57:00+08:00">2016-04-21</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>之前页面只需要传一个值，因此用的是比较简单的方法：获取页面url后以等号进行字符串分割，代码如下：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = <span class="built_in">window</span>.location.search;</span><br><span class="line"><span class="keyword">var</span> loc = url.substring(url.lastIndexOf(<span class="string">"="</span>) + <span class="number">1</span>, url.length);</span><br></pre></td></tr></table></figure><p></p><p>但是这样只能获取最后一个等号所带的值，大多情况无法满足需要。因此需要一个能够获取全部参数部分（“?”之后的部分）<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetRequest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> url = location.search; <span class="comment">//获取url中"?"符后的字串   </span></span><br><span class="line">	<span class="keyword">var</span> theRequest = <span class="keyword">new</span> <span class="built_in">Object</span>();<span class="comment">//新建对象</span></span><br><span class="line">	<span class="keyword">if</span> (url.indexOf(<span class="string">"?"</span>) != <span class="number">-1</span>) &#123; <span class="comment">//排除没有参数的情况</span></span><br><span class="line">		<span class="keyword">var</span> str = url.substr(<span class="number">1</span>);<span class="comment">//抽取从第二个字符到结尾的字符子串</span></span><br><span class="line">		strs = str.split(<span class="string">"&amp;"</span>);<span class="comment">//将str以&amp;作为分隔符分成多个部分，以数组形式存在strs里</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; strs.length; i++) &#123;<span class="comment">//遍历strs数组</span></span><br><span class="line">			theRequest[strs[i].split(<span class="string">"="</span>)[<span class="number">0</span>]] = <span class="built_in">unescape</span>(strs[i].split(<span class="string">"="</span>)[<span class="number">1</span>]);<span class="comment">//使theRsquest[key] = value</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> theRequest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>使用方法：</p><p>GetRequest()[key]</p><p>例如 访问test.html?id=9&amp;type=cat</p><p>在test.html里</p><p>GetRequest()[“id”] //9</p><p>GetRequest()[“type”] //cat</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/20/根据Vuejs制作的可查找多个数值的过滤器/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/20/根据Vuejs制作的可查找多个数值的过滤器/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">根据Vuejs制作的可查找多个数值的过滤器</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-20 14:23:00" itemprop="dateCreated datePublished" datetime="2016-04-20T14:23:00+08:00">2016-04-20</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>在实际项目中，需要制作”我的订单”功能。功能逻辑如下：使用ajax将所有订单数据下载到json数组中，将json数组与div绑定。</p><p>且订单有多个状态，如state=1是待确认订单，state=2是待付款订单，state=3是待配送订单，state=4是待评价订单。</p><p>但是在调支付接口时，发现已付款订单有两种状态:同步状态与异步状态（交易平台需要一定时间确认后才能将确认消息异步发送给服务端），为了用户体验，拟使同步与异步状态的订单都归类在“已付款订单”中，因此Vue原生自带的单个数值搜索的过滤器不足以满足需求，需要一个能够同时搜索多个数值的过滤器来进行过滤。</p><p>过滤器代码如下：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Filter filter array for arrays</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * @param &#123;String&#125; arr</span></span><br><span class="line"><span class="comment">  * @param &#123;String&#125; searcharr</span></span><br><span class="line"><span class="comment">  * @param &#123;String&#125; feature</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">filtersBy</span>(<span class="params">arr, searcharr, feature</span>) </span>&#123;</span><br><span class="line">     searcharr = convertArray(searcharr);</span><br><span class="line">     arr = convertArray(arr);</span><br><span class="line">     <span class="keyword">var</span> res = [];</span><br><span class="line">     <span class="keyword">var</span> item, searchitem;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; searcharr.length; j++) &#123;</span><br><span class="line">             item = arr[i];</span><br><span class="line">             searchitem = searcharr[j];</span><br><span class="line">             <span class="built_in">console</span>.log(feature)</span><br><span class="line">             <span class="keyword">if</span> (item[feature] == searchitem) &#123;</span><br><span class="line">                 res.push(item);</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> res;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p></p><p>插入源码后注册即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> filters = &#123;</span><br><span class="line">    orderBy: orderBy,</span><br><span class="line">    filterBy: filterBy,</span><br><span class="line">    filtersBy: filtersBy,</span><br><span class="line">    limitBy: limitBy</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>运行效果：</p><p>数据:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> DATA = &#123;</span><br><span class="line">	<span class="string">"datas"</span>: [&#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类一的第一项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">2</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类一的第二项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">3</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类一的第三项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">4</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">2</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类二的第一项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">5</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">2</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类二的第二项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">6</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"data"</span>: <span class="string">"这是分类三的第一项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类三的第二项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">8</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类三的第三项"</span></span><br><span class="line">	&#125;, &#123;</span><br><span class="line">	<span class="string">"id"</span>: <span class="number">9</span>,</span><br><span class="line">	<span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">	<span class="string">"data"</span>: <span class="string">"这是分类三的第四项"</span></span><br><span class="line">	&#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>html:<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"type-1"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"data in datas | filtersBy '[2,3]' 'type'"</span> <span class="attr">track-by</span>=<span class="string">"item.id"</span>&gt;</span>&#123;&#123;data.data&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>js:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#type-1'</span>,</span><br><span class="line">    data: DATA</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p></p><p>结果:</p><p><img src="/images/pasted-53.png" alt="upload successful"></p><p>可以满足需求，在数据中搜索多项并过滤。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/20/js中reduce的用法/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/20/js中reduce的用法/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">js中reduce的用法</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-20 07:36:00" itemprop="dateCreated datePublished" datetime="2016-04-20T07:36:00+08:00">2016-04-20</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>从左到右遍历数组的一种方式</p><blockquote><p>arr.reduce(callback(previousValue,currentValue,index,array), [initialValue]);</p></blockquote><p>callback 函数中 <code>previousValue</code> 等于 <code>initialValue</code> 的值或者是上一次 <code>reduce return</code> 回来的值</p><p><code>currentValue</code> 是当前执行到的数组的值</p><p><code>index</code> 是当前执行到的数组的下标</p><p><code>array</code> 是执行 <code>reduce</code> 的 <code>array</code></p><p>尝试：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">a.reduce(</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,d</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log( <span class="string">'previousValue= '</span>+a+ <span class="string">';currentValue= '</span>+b+ <span class="string">';index= '</span>+c+ <span class="string">';array= '</span>+d)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br></pre></td></tr></table></figure><p></p><p>得到结果</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">1</span>;index=<span class="number">0</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">2</span>;index=<span class="number">1</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">3</span>;index=<span class="number">2</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">4</span>;index=<span class="number">3</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">5</span>;index=<span class="number">4</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line">previousValue=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>;currentValue=<span class="number">6</span>;index=<span class="number">5</span>;array=<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br></pre></td></tr></table></figure><p>可以感受到其用法。</p><p>例如数组累加：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">sum = a.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev,cur</span>)</span>&#123;<span class="keyword">return</span> prev+cur&#125;)</span><br><span class="line"><span class="comment">//sum = 13</span></span><br></pre></td></tr></table></figure><p></p><hr><p>因此vuejs中filterBy代码中的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> keys=toArray(<span class="built_in">arguments</span>,n).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev,cur</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> prev.concat(cur);</span><br><span class="line">    &#125;,[]);</span><br></pre></td></tr></table></figure><p>用途是将数组扁平化。</p><p>例如<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a= [</span><br><span class="line">  [<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">  [<span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> b= a.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">prev, cur</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> prev.concat(cur);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//b = [1,2,3,4,5,6]</span></span><br></pre></td></tr></table></figure><p></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/20/Vuejs列表与过滤器的简单应用/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/20/Vuejs列表与过滤器的简单应用/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">Vuejs列表与过滤器的简单应用</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-20 06:51:00" itemprop="dateCreated datePublished" datetime="2016-04-20T06:51:00+08:00">2016-04-20</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>设置一组json数据<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> DATA = &#123;</span><br><span class="line">            <span class="string">"datas"</span>: [&#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类一的第一项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类一的第二项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类一的第三项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">4</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类二的第一项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">5</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类二的第二项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">6</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类三的第一项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">7</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类三的第二项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">8</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类三的第三项"</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">"id"</span>: <span class="number">9</span>,</span><br><span class="line">                <span class="string">"type"</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="string">"data"</span>: <span class="string">"这是分类三的第四项"</span></span><br><span class="line">            &#125;]</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p></p><p>并进行列表的双向绑定，加上过滤器选择type为1的项。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">            el:<span class="string">'#type-1'</span>,</span><br><span class="line">            data:DATA</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"type-1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"data in datas|filterBy '1' in 'type'"</span>&gt;</span>&#123;&#123;data.data&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以看到结果是</p><p><img src="/ueditor/php/upload/image/20160420/1461132398638230.png" alt="blob.png" title="1461132398638230.png"></p><p>显然过滤器发挥了作用。在vuejs源码中可以看到filterby函数的代码如下<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Filter filter for arrays</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * @param &#123;String&#125; search</span></span><br><span class="line"><span class="comment">   * @param &#123;String&#125; [delimiter]</span></span><br><span class="line"><span class="comment">   * @param &#123;String&#125; ...dataKeys</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">filterBy</span>(<span class="params">arr, search, delimiter</span>)</span>&#123;</span><br><span class="line">    arr = convertArray(arr);</span><br><span class="line">    <span class="keyword">if</span> (search == <span class="literal">null</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> arr;</span><br><span class="line">    &#125; <span class="comment">//如果没有指定过滤中搜索的值，则将arr原样返回</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> search === <span class="string">'function'</span>)&#123; <span class="comment">//“===”means 严格等于</span></span><br><span class="line">      <span class="keyword">return</span> arr.filter(search); <span class="comment">//在arr中直接用原生filter过滤出search的项</span></span><br><span class="line">    &#125;</span><br><span class="line">    search = (<span class="string">''</span> + search).toLowerCase();<span class="comment">//toLowerCase 将String转换为小写字符串</span></span><br><span class="line">    <span class="keyword">var</span> n = delimiter === <span class="string">'in'</span> ? <span class="number">3</span> : <span class="number">2</span>;<span class="comment">//x?y:z 若x为true,结果显示y,若x为false,则结果显示z。</span></span><br><span class="line">    <span class="comment">//如果delimiter是in,则n=3，否则n=2</span></span><br><span class="line">    <span class="keyword">var</span> keys=toArray(<span class="built_in">arguments</span>,n).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev,cur</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> prev.concat(cur);<span class="comment">//concat用于连接数组的值或具体的值。</span></span><br><span class="line">    &#125;,[]);<span class="comment">//见reduce用法</span></span><br><span class="line">    <span class="keyword">var</span> res = [];</span><br><span class="line">    <span class="keyword">var</span> item,key,val,j;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++) &#123;<span class="comment">//遍历arr</span></span><br><span class="line">      item=arr[i];</span><br><span class="line">      val=item&amp;&amp;item.$value||item;</span><br><span class="line">      j=keys.length;</span><br><span class="line">      <span class="keyword">if</span>(j)&#123;</span><br><span class="line">        <span class="keyword">while</span> (j--) &#123;</span><br><span class="line">          key = keys[j];</span><br><span class="line">          <span class="keyword">if</span> (key === <span class="string">'$key'</span> &amp;&amp; contains$<span class="number">1</span>(item.$key, search) || contains$<span class="number">1</span>(getPath(val,key),search)) &#123;</span><br><span class="line">          <span class="comment">//如果在item中的delimiter找到了search，则将这个item放到res数组中</span></span><br><span class="line">            res.push(item);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span> (contains$<span class="number">1</span>(item,search)) &#123;<span class="comment">//遍历item各级搜索search,如果有则放入res</span></span><br><span class="line">        res.push(item);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;<span class="comment">//返回结果</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * String contain helper</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * @param &#123;*&#125; val</span></span><br><span class="line"><span class="comment">   * @param &#123;String&#125; search</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">contains$1</span>(<span class="params">val, search</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i;</span><br><span class="line">    <span class="keyword">if</span> (isPlainObject(val)) &#123;</span><br><span class="line">      <span class="keyword">var</span> keys = <span class="built_in">Object</span>.keys(val);</span><br><span class="line">      i = keys.length;</span><br><span class="line">      <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (contains$<span class="number">1</span>(val[keys[i]], search)) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isArray(val)) &#123;</span><br><span class="line">      i = val.length;</span><br><span class="line">      <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (contains$<span class="number">1</span>(val[i], search)) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> val.toString().toLowerCase().indexOf(search) &gt; <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/04/20/js中-与-的区别/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/04/20/js中-与-的区别/" class="post-title-link" itemprop="https://lsvih.com/page/12/index.html">js中==与===的区别</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-04-20 06:23:00" itemprop="dateCreated datePublished" datetime="2016-04-20T06:23:00+08:00">2016-04-20</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>转自<a href="http://blog.csdn.net/wxdzxl/article/details/8502119" target="_blank" rel="noopener">http://blog.csdn.net/wxdzxl/article/details/8502119</a></p></blockquote><p>首先，== equality 等同，=== identity 恒等。<br>==， 两边值类型不同的时候，要先进行类型转换，再比较。<br>===，不做类型转换，类型不同的一定不等。</p><p>下面分别说明：<br>先说 ===，这个比较简单。下面的规则用来判断两个值是否===相等：<br>1、如果类型不同，就[不相等]<br>2、如果两个都是数值，并且是同一个值，那么[相等]；(！例外)的是，如果其中至少一个是NaN，那么[不相等]。（判断一个值是否是NaN，只能用isNaN()来判断）<br>3、如果两个都是字符串，每个位置的字符都一样，那么[相等]；否则[不相等]。<br>4、如果两个值都是true，或者都是false，那么[相等]。<br>5、如果两个值都引用同一个对象或函数，那么[相等]；否则[不相等]。<br>6、如果两个值都是null，或者都是undefined，那么[相等]。<br>再说 ==，根据以下规则：<br>1、如果两个值类型相同，进行 === 比较。<br>2、如果两个值类型不同，他们可能相等。根据下面规则进行类型转换再比较：<br>a、如果一个是null、一个是undefined，那么[相等]。<br>b、如果一个是字符串，一个是数值，把字符串转换成数值再进行比较。<br>c、如果任一值是 true，把它转换成 1 再比较；如果任一值是 false，把它转换成 0 再比较。<br>d、如果一个是对象，另一个是数值或字符串，把对象转换成基础类型的值再比较。对象转换成基础类型，利用它的toString或者valueOf方法。js核心内置类，会尝试valueOf先于toString；例外的是Date，Date利用的是toString转换。非js核心的对象，令说（比较麻烦，我也不大懂）<br>e、任何其他组合，都[不相等]。</p><p>举例：<br>“1” == true<br>类型不等，true会先转换成数值 1，现在变成 “1” == 1，再把”1”转换成 1，比较 1 == 1， 相等。</p><p>= 赋值运算符<br>== 等于<br>=== 严格等于<br>例：<br>var a = 3;<br>var b = “3”;</p><p>a==b 返回 true<br>a===b 返回 false</p><p>因为a,b的类型不一样<br>===用来进行严格的比较判断</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="Next page"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">lsvih</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">140</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">9</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">167</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/lsvih" title="GitHub &rarr; https://github.com/lsvih" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:lsvih@qq.com" title="E-Mail &rarr; mailto:lsvih@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 – <span itemprop="copyrightYear">2019</span> <span class="with-love" id="animate"><i class="fa fa-"></i> </span><span class="author" itemprop="copyrightHolder">lsvih</span></div><div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.5.0</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script><script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script><link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css"><script src="/lib/algolia-instant-search/instantsearch.min.js"></script><script src="/js/src/algolia-search.js?v=6.5.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>