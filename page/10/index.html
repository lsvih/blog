<!DOCTYPE html><html class="theme-next pisces"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0"><link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"6.5.0",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"6U6P1RGK4F",apiKey:"b14e73cdd627eabe947b5decbe14850f",indexName:"lsvih",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="website"><meta property="og:title" content="My note"><meta property="og:url" content="https://lsvih.com/page/10/index.html"><meta property="og:site_name" content="My note"><meta property="og:locale" content="default"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="My note"><link rel="canonical" href="https://lsvih.com/page/10/"><script type="text/javascript" id="page.configurations">CONFIG.page={sidebar:""}</script><title>My note – lsvih</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?4de170e51b04cee02fbdb1b7cb7a8a60";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style type="text/css">.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="default"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">My note</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">lsvih</h1></div><div class="site-nav-toggle"><button aria-label="Toggle navigation bar"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/31/Javascript的作用域与作用域链/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/31/Javascript的作用域与作用域链/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">Javascript的作用域与作用域链</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-31 10:35:00" itemprop="dateCreated datePublished" datetime="2016-07-31T10:35:00+08:00">2016-07-31</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>不提ES6新声明的作用域声明(let等)，单纯看js的作用域。</p><p>作用域的定义：作用域是某一变量和方法具有访问权限的代码控件。</p><p>在JS中作用域主要由全局作用域和本地（函数）作用域两种，全局变量在所有函数中都能被访问到，本地作用域声明的变量只能在当前函数代码块中被访问；</p><p>例如：</p><p>1、全局变量能被直接访问<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure><p></p><p>2、全局变量能再函数内部访问<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure><p></p><p>3、本地作用域（函数内部）声明的变量能被本作用域（本函数）内部直接访问</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure><p>4、本地作用域（函数内部）声明的变量不能在作用域外（函数外部）被访问<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line">alert(a);<span class="comment">//=&gt; undefined</span></span><br></pre></td></tr></table></figure><p></p><p>5、本地作用域声明的变量不能在其外部的别的本地作用域中被访问<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line">run();<span class="comment">//=&gt; undefined</span></span><br></pre></td></tr></table></figure><p></p><p>6、本地作用域内部的作用域能访问到上级声明的变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt;0</span></span><br></pre></td></tr></table></figure><p>7、本地作用域声明的变量级别比全局变量高，能在作用域内覆盖全局变量声明<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a - <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    alert(a);</span><br><span class="line">&#125;</span><br><span class="line">test();<span class="comment">//=&gt; 1</span></span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure><p></p><p>由此可知，js的作用域是从上往下继承，作用域内部函数能访问本作用域声明的函数与外部作用域生成的函数。</p><p>由此可以明确js的作用域链概念。</p><p>例如：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">child2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">parent();<span class="comment">//=&gt; 0,=&gt; 1,=&gt;0</span></span><br><span class="line">alert(a);<span class="comment">//=&gt; 0</span></span><br></pre></td></tr></table></figure><p></p><p>parent()内第一个alert(a)的作用域链是parent()-&gt;window，所以此时a是0；</p><p>child1()内alert(a)的作用域链是child1()-&gt;parent()-&gt;window，在child1中重新声明了a的值，覆盖了全局变量的值因此此时a是1；</p><p>child2()中alert(a)的作用域链是child2()-&gt;parent()-&gt;window，与child1中声明的a=1毫无关联，因此此时的a的值还是0;</p><p>最后一个alert(a)作用域链是window，此时a的值为0；</p><p>js的作用域与作用域链的概念可以简单清晰的按如上描述。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/27/移动端按钮过小点击困难的解决方案/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/27/移动端按钮过小点击困难的解决方案/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">移动端按钮过小点击困难的解决方案</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-27 11:20:00" itemprop="dateCreated datePublished" datetime="2016-07-27T11:20:00+08:00">2016-07-27</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p><img src="/images/pasted-87.png" alt="upload successful"></p><p>按钮如图所示，长宽都很小，导致在使用时点击困难。</p><p>解决方案：在按钮之上覆盖一层点击区域，将按钮的触发事件放在此区域之上</p><p><img src="/images/pasted-88.png" alt="upload successful"></p><p>添加点击区域后可操作范围明显增大。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/27/解决在手机上无法顺利监听onscroll事件/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/27/解决在手机上无法顺利监听onscroll事件/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">解决在手机上无法顺利监听onscroll事件</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-27 09:28:00" itemprop="dateCreated datePublished" datetime="2016-07-27T09:28:00+08:00">2016-07-27</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>在进行制作视差滚动效果时，需要获得每时每刻滚动条的位置以进行计算，因此会使用window.onscroll来监听滚动条的位置。在pc上可以顺利的连续获得滚动条的任意时刻的坐标，然而在手机上无法顺利获得连续的事件触发。原因是移动端为了获得流畅的滚动效果与弹性效果，对于系统原生的滚动事件进行了限制，因此无法获得连续的滚动事件。</p><p>为了在移动端上实现视差网页效果，需要手动模拟用户滚动的事件，这样才能连续获取事件触发。通常使用iscroll等帮助实现效果。</p><p>在寻找相关滚动库的时候发现了一款小巧又好用的滚动js库 Jroll,大小仅仅只有13KB,比iscroll的lite版本还要小一半，而且能够完整实现需求。</p><p>Git地址:<a href="https://git.oschina.net/chenjianlong/JRoll2" target="_blank" rel="noopener">https://git.oschina.net/chenjianlong/JRoll2</a></p><p>官网:<a href="http://www.chjtx.com/JRoll/" target="_blank" rel="noopener">http://www.chjtx.com/JRoll/</a></p><p>用法：</p><p>引用<code>&lt;script src=&#39;jroll.js&#39;&gt;&lt;/script&gt;</code>后，在文档中定义好滚动对象与滚动容器，例如<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"scroller"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>其中scroller为滚动对象，wrapper为滚动容器。需要注意的是滚动对象的高必须大于滚动容器的高才能顺利地进行滚动操作（废话）</p><p>接着创建jroll对象，如下所示<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jroll = <span class="keyword">new</span> JRoll(<span class="string">"#wrapper"</span>, &#123;option&#125;);</span><br></pre></td></tr></table></figure><p></p><p>其中option为配置内容，具体使用方法见官网。</p><p>另外，当在页面(滚动对象)中存在类似于动态加载与文本展开等情况的时候，在加载完毕与文本展开动画播放完毕的时候必须要使用jroll.refresh()对jroll对象进行刷新，不然jroll的高度不会发生改变从而使页面显示不全。</p><p>在项目中，使用jroll完美地完成了视差滚动效果的实现，在ios设备上的webapp中滚动动画打到了40fps以上。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jroll.on(<span class="string">'scroll'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//视差滚动计算</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/15/使用canvas制作画图板/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/15/使用canvas制作画图板/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">使用canvas制作画图板</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-15 03:28:00" itemprop="dateCreated datePublished" datetime="2016-07-15T03:28:00+08:00">2016-07-15</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>原理：在canvas画布上捕捉鼠标（手指）动作，关注下笔、拖动、抬笔三个事件。</p><p>下笔使用onmousedown/ontouchstart，拖动使用onmousemove/ontouchmove，抬笔使用onmouseup/ontouchend，同时需要检测笔尖是否移动到画布外（onmouseout）。</p><p>在这三个事件被捕捉后，就能顺利的在画布上生成图像了。</p><p>在画布上自由画画：</p><p>Html:<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvas"</span> <span class="attr">width</span>=<span class="string">"1024"</span> <span class="attr">height</span>=<span class="string">"665"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>Javascript:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</span><br><span class="line"><span class="keyword">var</span> can = canvas.getContext(<span class="string">'2d'</span>);</span><br><span class="line"><span class="comment">//定义画布</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/****使用自由画笔****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Brush</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> sX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> sY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	<span class="comment">//获取起始坐标</span></span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.moveTo(sX, sY);</span><br><span class="line">	status = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔移动的时候</span></span><br><span class="line">canvas.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">if</span>(status == <span class="number">1</span>) &#123;</span><br><span class="line">		can.lineTo(eX, eY);</span><br><span class="line">		can.stroke();</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔抬起的时候</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	can.closePath();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Brush();</span><br></pre></td></tr></table></figure><p>通过以上代码可以实现在画布上自由绘画。</p><p>用按钮触发以上函数可实现选择“自由画笔工具”绘画。</p><p>相似的，画直线、画圆形、画矩形也是如此：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****画直线****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Line</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.moveTo(sX, sY);</span><br><span class="line">&#125;</span><br><span class="line">canvas.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画笔抬起时，画笔位置为终点</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	can.lineTo(eX, eY);</span><br><span class="line">	can.closePath();</span><br><span class="line">	can.stroke();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****画空心圆形****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Arc</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画空心圆，鼠标抬起时，当前画笔位置为外圆结束点</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> dX = eX - sX</span><br><span class="line">	<span class="keyword">var</span> dY = eY - sY;</span><br><span class="line"><span class="keyword">var</span> r = <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(dX, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(dY, <span class="number">2</span>)); </span><br><span class="line">	<span class="comment">//计算出半径</span></span><br><span class="line">	can.beginPath();</span><br><span class="line">	can.arc(sX, sY, r, <span class="number">0</span>, <span class="number">360</span>, <span class="literal">false</span>);</span><br><span class="line">	can.closePath();</span><br><span class="line">	can.stroke();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****画矩形****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rect</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.ontouchstart = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	sX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	sY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//画空心矩形，画笔抬起时，当前画笔位置为矩形的右下角</span></span><br><span class="line">canvas.ontouchend = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> w = eX - sX; <span class="comment">//矩形的宽</span></span><br><span class="line">	<span class="keyword">var</span> h = eY - sY; <span class="comment">//矩形的高</span></span><br><span class="line">	can.strokeRect(sX, sY, w, h);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>通过以上代码可以实现简单的画图板。但是会产生一个问题：画矩形与圆形时 在画笔移动时，画布上不会产生相应的图形，只有在画笔抬起时才会产生图像，所以在画画的时候感知不到自己纠结画出的图形是怎样的，这样的体验非常差。因此，使用双画布来解决这个问题，即在本来的画布上放一个同样大小的画布，移动画笔的时候在临时画布上不断地清除、绘制图像就能使用户感知到画画的过程。</p><p>临时画布需要设置position:absolute与z-index来与主画布重叠。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/****清除临时画布的函数****/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearContext</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    can_bak.clearRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1024</span>, <span class="number">665</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>例如画圆形时，加上<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">canvas_bak.ontouchmove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">	e = <span class="built_in">window</span>.event || e;</span><br><span class="line">	clearContext();</span><br><span class="line">	<span class="keyword">var</span> eX = e.pageX - <span class="keyword">this</span>.offsetLeft;</span><br><span class="line">	<span class="keyword">var</span> eY = e.pageY - <span class="keyword">this</span>.offsetTop;</span><br><span class="line">	<span class="keyword">var</span> dX = eX - sX</span><br><span class="line">	<span class="keyword">var</span> dY = eY - sY;</span><br><span class="line"><span class="keyword">var</span> r = <span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(dX, <span class="number">2</span>) + <span class="built_in">Math</span>.pow(dY, <span class="number">2</span>));</span><br><span class="line">	can_bak.beginPath();</span><br><span class="line">	can_bak.arc(sX, sY, r, <span class="number">0</span>, <span class="number">360</span>, <span class="literal">false</span>);</span><br><span class="line">	can_bak.closePath();</span><br><span class="line">	can_bak.stroke();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>在ontouchend中加上clearContext();即可。</p><p>最终效果：</p><p><img src="/images/pasted-86.png" alt="upload successful"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/10/vue-v-on获取点击元素/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/10/vue-v-on获取点击元素/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">vue v-on获取点击元素</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-10 11:46:00" itemprop="dateCreated datePublished" datetime="2016-07-10T11:46:00+08:00">2016-07-10</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:tap</span>=<span class="string">"getevent($event)"</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>vm中<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">    getevent: <span class="function"><span class="keyword">function</span>(<span class="params">thisvmObject</span>)</span>&#123;</span><br><span class="line">       thisObject = thisvmObject.currentTarget;</span><br><span class="line">       <span class="built_in">console</span>.log(thisObject.innerHTML);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>output&gt;&gt;</p><p>Hello</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/07/03/MUI-NativeJS-for-iOS判断是否安装了指定应用/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/07/03/MUI-NativeJS-for-iOS判断是否安装了指定应用/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">MUI NativeJS for iOS判断是否安装了指定应用</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-07-03 09:18:00" itemprop="dateCreated datePublished" datetime="2016-07-03T09:18:00+08:00">2016-07-03</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>使用Objective-C可以轻松实现判断应用是否安装：<br></p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> result=[[<span class="built_in">UIApplication</span> sharedApplication] canOpenURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"weixin://"</span>]];</span><br></pre></td></tr></table></figure><p></p><p>转换为NativeJS写法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> NSURL = plus.ios.import(<span class="string">'NSURL'</span>);</span><br><span class="line">    <span class="keyword">var</span> UIA = plus.ios.import(<span class="string">'UIApplication'</span>); </span><br><span class="line">    <span class="keyword">var</span> obj = <span class="keyword">new</span> UIA.sharedApplication();</span><br><span class="line">    <span class="keyword">var</span> result = obj.canOpenURL(NSURL.URLWithString(<span class="string">'weixin://'</span>));</span><br><span class="line">    <span class="comment">//return result;</span></span><br><span class="line">    alert(result);</span><br><span class="line">    <span class="comment">//[[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"weixin://"]];</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>返回值为1则安装了”weixin”,返回0则没安装。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/06/27/禁止手机浏览器与微信浏览器的原生滚动/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/06/27/禁止手机浏览器与微信浏览器的原生滚动/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">禁止手机浏览器与微信浏览器的原生滚动</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-06-27 11:17:00" itemprop="dateCreated datePublished" datetime="2016-06-27T11:17:00+08:00">2016-06-27</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>在微信浏览器中,如果页面内容到头或者到底,手指滑动时会拖动整个页面。如图所示</p><p><img src="/images/pasted-85.png" alt="upload successful"></p><p>在原生滑动过程中,页面中的所有动画(包括canvas动画、gif动图、css变幻、js计时器)会全部停止,在页面回弹到初始位置时才会继续运行,极大地影响了用户的体验。</p><p>因此,在用户有拖动操作时需要将页面的上下原生滑动停止,至少要在用户拖动区域禁止原生滚动事件。</p><p>例如我在项目中碰到需要用户左右滑动的操作,而如果用户向左下滑动,则会造成页面先向下滑动后回弹,然后定义的事件才会产生。</p><p>因此需要使用preventDefault()来禁止原生touchstart动作。但是如果直接使用event.preventDefault()会使整个页面的滚动事件全部失效,达不到想要的效果,因此对其进行有条件的处理。js代码如下:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* 禁止微信原生上下滚动</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> overscroll = <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">	el.addEventListener(<span class="string">'touchstart'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	    <span class="keyword">var</span> top = el.scrollTop,</span><br><span class="line">		totalScroll = el.scrollHeight,</span><br><span class="line">		currentScroll = top + el.offsetHeight;</span><br><span class="line">	    <span class="keyword">if</span> (top === <span class="number">0</span>) &#123;</span><br><span class="line">    	el.scrollTop = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentScroll === totalScroll) &#123;</span><br><span class="line">	        el.scrollTop = top - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    el.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (el.offsetHeight &lt; el.scrollHeight)</span><br><span class="line">      evt._isScroller = <span class="literal">true</span>;</span><br><span class="line">   &#125;);</span><br><span class="line">&#125;</span><br><span class="line">overscroll(<span class="built_in">document</span>.querySelector(<span class="string">'#scroll'</span>));<span class="comment">//此处的scroll为需要禁止原生滚动的Object</span></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!evt._isScroller) &#123;</span><br><span class="line">    evt.preventDefault();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/06/27/使用gulp构建前端工程/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/06/27/使用gulp构建前端工程/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">使用gulp构建前端工程</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-06-27 09:05:57" itemprop="dateCreated datePublished" datetime="2016-06-27T09:05:57+08:00">2016-06-27</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>gulp.js 是一个自动化构建工具,基于 Node.js。通过gulp可以省略前端开发中很多重复无意义的步骤,例如js/css的压缩、less/sass的编译等。</p><p>在公司的项目中,需要在测试环境中反复调试一些内容(需求要求),而我在js中使用了es6的let声明关键词与严格模式,在测试容器–微信浏览器下无法顺利运行。因此使用gulp重新构建项目,利用其特性实现自动化压缩js/css,编译less,替换js中的let为var等功能。</p><p>项目目录结构:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├─node_modules</span><br><span class="line">├─dist</span><br><span class="line">│   ├─css</span><br><span class="line">│   ├─fonts</span><br><span class="line">│   ├─images</span><br><span class="line">│   └─js</span><br><span class="line">└─src</span><br><span class="line">    ├─css</span><br><span class="line">    ├─fonts</span><br><span class="line">    ├─images</span><br><span class="line">    ├─js</span><br><span class="line">    └─less</span><br></pre></td></tr></table></figure><p></p><p>dist目录为构建目录,src为工程目录;</p><p>首先下载nodejs,其中也包含了npm包管理工具。</p><p>切换到项目根目录下,输入:<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --global gulp</span><br></pre></td></tr></table></figure><p></p><p>全局安装gulp。</p><p>输入:<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev gulp</span><br></pre></td></tr></table></figure><p></p><p>使其作为项目的开发依赖安装。此时会自动创建目录node_modules;</p><p>输入:<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-uglify gulp-minify-css gulp-sourcemaps gulp-less gulp-concat gulp-rename gulp-imagemin gulp-replace gulp-htmlmin --save-dev</span><br></pre></td></tr></table></figure><p></p><p>安装项目所需要的插件。</p><p>使用到的插件有:</p><p>gulp-uglify:js混淆、压缩</p><p>gulp-minify-css:css压缩</p><p>gulp-sourcemaps:为less插件创建map</p><p>gulp-less:编译less文件</p><p>gulp-concat:文件合并</p><p>gulp-rename:文件重命名</p><p>gulp-imagemin:图片压缩</p><p>gulp-replace:文本替换(正则式)</p><p>gulp-htmlmin:html文件压缩(html中的css与js也会被压缩)</p><p>在根目录创建gulpfile.js。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp=<span class="built_in">require</span>(<span class="string">"gulp"</span>);<span class="comment">//创建gulp模块</span></span><br><span class="line"><span class="keyword">var</span> uglify=<span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);<span class="comment">//创建js混淆压缩模块</span></span><br><span class="line"><span class="keyword">var</span> minify_css=<span class="built_in">require</span>(<span class="string">"gulp-minify-css"</span>);<span class="comment">//创建css混淆压缩模块</span></span><br><span class="line"><span class="keyword">var</span> less=<span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</span><br><span class="line"><span class="keyword">var</span> gulp_concat=<span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);<span class="comment">//创建文件合并模块</span></span><br><span class="line"><span class="keyword">var</span> del=<span class="built_in">require</span>(<span class="string">'del'</span>);</span><br><span class="line"><span class="keyword">var</span> rename=<span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</span><br><span class="line"><span class="keyword">var</span> imagemin=<span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);<span class="comment">//压缩图片</span></span><br><span class="line"><span class="keyword">var</span> replace=<span class="built_in">require</span>(<span class="string">'gulp-replace'</span>);</span><br><span class="line"><span class="keyword">var</span> htmlmin=<span class="built_in">require</span>(<span class="string">'gulp-htmlmin'</span>);</span><br><span class="line"><span class="keyword">var</span> sourcemaps=<span class="built_in">require</span>(<span class="string">'gulp-sourcemaps'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clean</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Clean:'</span> + path)</span><br><span class="line">    del(path);</span><br><span class="line">&#125;</span><br><span class="line">gulp.task(<span class="string">'less'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'./src/less/*.less'</span>)</span><br><span class="line">        .pipe(sourcemaps.init())</span><br><span class="line">        .pipe(less())</span><br><span class="line">        .pipe(sourcemaps.write())</span><br><span class="line">        .pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">'.min'</span> &#125;))</span><br><span class="line">        .pipe(minify_css())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist/css'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'./src/css/*.css'</span>)</span><br><span class="line">   		.pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">'.min'</span> &#125;))</span><br><span class="line">        .pipe(minify_css())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist/css'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'javascripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">'./src/js/*.js'</span>)</span><br><span class="line">    .pipe(replace(<span class="string">'let '</span>, <span class="string">'var '</span>))<span class="comment">//微信不支持let用法因此换成var</span></span><br><span class="line">    .pipe(replace(<span class="string">'"use strict";'</span>, <span class="string">''</span>))<span class="comment">//微信不支持严格模式</span></span><br><span class="line">    .pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">'.min'</span> &#125;))</span><br><span class="line">    .pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./dist/js'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> options = &#123;</span><br><span class="line">        removeComments: <span class="literal">true</span>,<span class="comment">//清除HTML注释</span></span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,<span class="comment">//压缩HTML</span></span><br><span class="line">        collapseBooleanAttributes: <span class="literal">true</span>,<span class="comment">//省略布尔属性的值 &lt;input checked="true"/&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">        removeEmptyAttributes: <span class="literal">true</span>,<span class="comment">//删除所有空格作属性值 &lt;input id="" /&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">        removeScriptTypeAttributes: <span class="literal">true</span>,<span class="comment">//删除&lt;script&gt;的type="text/javascript"</span></span><br><span class="line">        removeStyleLinkTypeAttributes: <span class="literal">true</span>,<span class="comment">//删除&lt;style&gt;和&lt;link&gt;的type="text/css"</span></span><br><span class="line">        minifyJS: <span class="literal">true</span>,<span class="comment">//压缩页面JS</span></span><br><span class="line">        minifyCSS: <span class="literal">true</span><span class="comment">//压缩页面CSS</span></span><br><span class="line">    &#125;;</span><br><span class="line">    gulp.src(<span class="string">'./src/*.html'</span>)</span><br><span class="line">    .pipe(replace(<span class="string">'let '</span>, <span class="string">'var '</span>))<span class="comment">//微信不支持let用法因此换成var</span></span><br><span class="line">    .pipe(replace(<span class="string">'"use strict";'</span>, <span class="string">''</span>))<span class="comment">//微信不支持严格模式</span></span><br><span class="line">    .pipe(replace(<span class="string">'.css'</span>, <span class="string">'.min.css'</span>))<span class="comment">//将html引用的资源从css与js变成min.css与min.js</span></span><br><span class="line">    .pipe(replace(<span class="string">'.js'</span>, <span class="string">'.min.js'</span>))</span><br><span class="line">    .pipe(htmlmin(options))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./dist/'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src([<span class="string">'./src/images/*.*'</span>,<span class="string">'./src/images/**/*.*'</span>])</span><br><span class="line">    .pipe(imagemin())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./dist/images/'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'fonts'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	gulp.src(<span class="string">'./src/fonts/*.*'</span>)</span><br><span class="line">	.pipe(gulp.dest(<span class="string">'./dist/fonts/'</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    clean(<span class="string">'./dist/*'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'build'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    gulp.run(<span class="string">'less'</span>,<span class="string">'css'</span>,<span class="string">'javascripts'</span>,<span class="string">'html'</span>,<span class="string">'images'</span>,<span class="string">'fonts'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    gulp.run(<span class="string">'build'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">    gulp.watch([<span class="string">'./src/less/*.less'</span>,<span class="string">'./src/js/*.js'</span>,<span class="string">'./src/css/*.css'</span>,<span class="string">'./src/*.html'</span>,<span class="string">'./src/images/*.*'</span>,<span class="string">'./src/images/*/*.*'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        gulp.run(<span class="string">'build'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>与gulp有关的方法主要有以下几种:</p><p>gulp.task 定义gulp任务</p><p>gulp.run 运行gulp任务</p><p>gulp.watch 监控文件变化</p><p>gulp.src 输入文件路径</p><p>gulp.dest 指定处理完后文件输出的路径</p><p>其中参数多是以数组形式输入,例如监控多个目录:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch([<span class="string">'./src/less/*.less'</span>,<span class="string">'./src/js/*.js'</span>,<span class="string">'./src/css/*.css'</span>,<span class="string">'./src/*.html'</span>,<span class="string">'./src/images/*.*'</span>,<span class="string">'./src/images/*/*.*'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//检测到文件变化时执行的操作</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>gulp.task定义了任务的名称与过程。</p><p>例如<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    gulp.run(<span class="string">'build'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Done!'</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>即定义了default任务,在执行default任务时,执行build任务并返回“Done”</p><p>default任务是默认任务,执行时直接在项目目录执行命令<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp</span><br></pre></td></tr></table></figure><p></p><p>即为进行default任务。</p><p>同时也可以通过gulp + 任务名 来运行指定任务,例如<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp clean</span><br></pre></td></tr></table></figure><p></p><p>即为运行名称为clean的任务。</p><p>在任务中,文件以“流”的形式在任务中流转,使用pipe可对其进行操作;.pipe可对与流通至此管道中的文件流进行相关操作。</p><p>例如,输入src/images中的所有图片进行压缩后,输出到dist/images<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src([<span class="string">'./src/images/*.*'</span>,<span class="string">'./src/images/**/*.*'</span>])</span><br><span class="line">    .pipe(imagemin())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./dist/images/'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>gulp.src获取images与images子目录下的所有文件,传入管道中;文件流通过imagemin()管道时,其中的图片被分别压缩,最终输出到dist/images目录中。</p><p>掌握gulp基本用法后就能够使用它进行一般的工程化构建了。当需要达到某种对文件流的处理效果时,可以在网上搜索相关插件,使用<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-xxx --save-dev</span><br></pre></td></tr></table></figure><p></p><p>下载与保存,在gulpfile.js中以var xxx=require(‘gulp-xxx’)形式定义,即可在任务中使用这种插件了。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/06/12/洗牌算法/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/06/12/洗牌算法/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">洗牌算法</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-06-12 12:57:00" itemprop="dateCreated datePublished" datetime="2016-06-12T12:57:00+08:00">2016-06-12</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>目的:将排列好的数据重新以随机的方式排列</p><p>原理:从数组中随机选出一个元素，放入目标数组中后从原数组中删除这个元素。反复进行这个过程，直到原数组中所有的元素都进入了新的数组。此时目标数组中的元素为随机排列，达到了“洗牌”的效果。</p><p>使用Python描述:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle</span><span class="params">(list)</span>:</span>  </span><br><span class="line">  targetlist=[]</span><br><span class="line">  <span class="keyword">while</span> list:   </span><br><span class="line">    i=random.randrange(<span class="number">0</span>,len(list))</span><br><span class="line">    targetlist.append(list[i])    </span><br><span class="line">    list.pop(i)  </span><br><span class="line">  <span class="keyword">return</span> targetlist</span><br></pre></td></tr></table></figure><p>random.randrange(0,len(list))为从0到list长度中随机生成一个整数。</p><p>targetlist.append(list[i])为将list[i]元素放入targetlist数组中。</p><p>list.pop(i)为从list中删除这个元素。</p><p>可以通过这个算法实现对训练集与测试集的分配。例如:<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle_split_data</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">""" Shuffles and splits data into 70% training and 30% testing subsets,</span></span><br><span class="line"><span class="string">        then returns the training and testing subsets. """</span></span><br><span class="line">    <span class="comment"># Shuffle and split the data</span></span><br><span class="line">    split_num = int(<span class="number">0.7</span> * len(X))</span><br><span class="line">    X_t = []</span><br><span class="line">    y_t = []</span><br><span class="line">    X = list(X)</span><br><span class="line">    <span class="keyword">while</span> X:</span><br><span class="line">        p = random.randrange(<span class="number">0</span>, len(X))</span><br><span class="line">        X_t.append(X[p])</span><br><span class="line">        y_t.append(y[p])</span><br><span class="line">        X.pop(p)</span><br><span class="line"></span><br><span class="line">    X_train = X_t[:split_num]</span><br><span class="line">    y_train = y_t[:split_num]</span><br><span class="line">    X_test = X_t[split_num:]</span><br><span class="line">    y_test = y_t[split_num:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Return the training and testing data subsets</span></span><br><span class="line">    <span class="keyword">return</span> X_train, y_train, X_test, y_test</span><br></pre></td></tr></table></figure><p></p><p>X为输入值，y为输出值，将70%的数据放入训练集，将30%的数据放入测试集</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/06/11/使用Numpy与Pandas进行简单数据处理/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="lsvih"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="My note"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2016/06/11/使用Numpy与Pandas进行简单数据处理/" class="post-title-link" itemprop="https://lsvih.com/page/10/index.html">使用Numpy与Pandas进行简单数据处理</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2016-06-11 08:58:00" itemprop="dateCreated datePublished" datetime="2016-06-11T08:58:00+08:00">2016-06-11</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> DataFrame, Series</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"></span><br><span class="line">countries = [<span class="string">'Russian Fed.'</span>, <span class="string">'Norway'</span>, <span class="string">'Canada'</span>, <span class="string">'United States'</span>,</span><br><span class="line">            <span class="string">'Netherlands'</span>, <span class="string">'Germany'</span>, <span class="string">'Switzerland'</span>, <span class="string">'Belarus'</span>,</span><br><span class="line">            <span class="string">'Austria'</span>, <span class="string">'France'</span>, <span class="string">'Poland'</span>, <span class="string">'China'</span>, <span class="string">'Korea'</span>, </span><br><span class="line">            <span class="string">'Sweden'</span>, <span class="string">'Czech Republic'</span>, <span class="string">'Slovenia'</span>, <span class="string">'Japan'</span>,</span><br><span class="line">            <span class="string">'Finland'</span>, <span class="string">'Great Britain'</span>, <span class="string">'Ukraine'</span>, <span class="string">'Slovakia'</span>,</span><br><span class="line">            <span class="string">'Italy'</span>, <span class="string">'Latvia'</span>, <span class="string">'Australia'</span>, <span class="string">'Croatia'</span>, <span class="string">'Kazakhstan'</span>]</span><br><span class="line"></span><br><span class="line">gold = [<span class="number">13</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">silver = [<span class="number">11</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">bronze = [<span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>显示奖牌数据:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">olympic_medal_counts_df = DataFrame(</span><br><span class="line">         &#123;<span class="string">'country_name'</span>: countries,</span><br><span class="line">          <span class="string">'gold'</span>: gold,</span><br><span class="line">          <span class="string">'silver'</span>: silver,</span><br><span class="line">          <span class="string">'bronze'</span>: bronze&#125;) </span><br><span class="line"><span class="keyword">print</span> olympic_medal_counts_df</span><br><span class="line"></span><br><span class="line">df = olympic_medal_counts_df</span><br></pre></td></tr></table></figure><p>output&gt;&gt;</p><p><img src="/images/pasted-82.png" alt="upload successful"></p><p>计算至少获得一枚金牌的国家所获得铜牌的平均数：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">avg_bronze_at_least_one_gold = numpy.mean(df[df.gold &amp;gt; <span class="number">0</span>].bronze)</span><br><span class="line"><span class="keyword">print</span>  avg_bronze_at_least_one_gold</span><br></pre></td></tr></table></figure><p></p><p>output&gt;&gt;4.2380952381</p><p>计算金牌、银牌与铜牌的平均数：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">avg_medal_count=numpy.mean(df[[<span class="string">'gold'</span>,<span class="string">'silver'</span>,<span class="string">'bronze'</span>]])</span><br><span class="line"><span class="keyword">print</span> avg_medal_count</span><br></pre></td></tr></table></figure><p></p><p>output&gt;&gt;</p><p><img src="/images/pasted-83.png" alt="upload successful"></p><p>如果收获一枚金牌得4分，一枚银牌得2分，一枚铜牌得1分，计算所有国家的总分数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'points'</span>] = df[[<span class="string">'gold'</span>,<span class="string">'silver'</span>,<span class="string">'bronze'</span>]].dot([<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>])</span><br><span class="line">olympic_points_df = df[[<span class="string">'country_name'</span>,<span class="string">'points'</span>]]</span><br><span class="line"><span class="keyword">print</span> olympic_points_df</span><br></pre></td></tr></table></figure><p>output&gt;&gt;</p><p><img src="/images/pasted-84.png" alt="upload successful"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="Next page"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">lsvih</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">138</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">9</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">165</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/lsvih" title="GitHub &rarr; https://github.com/lsvih" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:lsvih@qq.com" title="E-Mail &rarr; mailto:lsvih@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 – <span itemprop="copyrightYear">2018</span> <span class="with-love" id="animate"><i class="fa fa-"></i> </span><span class="author" itemprop="copyrightHolder">lsvih</span></div><div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.5.0</div><div class="footer-custom"><a target="_blank" rel="external nofollow" href="http://www.miitbeian.gov.cn">京ICP备18029472号</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script><script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script><link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css"><script src="/lib/algolia-instant-search/instantsearch.min.js"></script><script src="/js/src/algolia-search.js?v=6.5.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>