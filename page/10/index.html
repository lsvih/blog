<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lsvih.com","root":"/","scheme":"Pisces","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"algolia":{"appID":"6U6P1RGK4F","apiKey":"b14e73cdd627eabe947b5decbe14850f","indexName":"lsvih","hits":{"per_page":10}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="My note">
<meta property="og:url" content="https://lsvih.com/page/10/index.html">
<meta property="og:site_name" content="My note">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="lsvih">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lsvih.com/page/10/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>My note - lsvih</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-142893470-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-142893470-1');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="My note" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">My note</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">lsvih</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="https://cv.lsvih.com/" rel="noopener" target="_blank"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">lsvih</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">164</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">208</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/lsvih" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lsvih" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lsvih@qq.com" title="E-Mail → mailto:lsvih@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/04/01/%E4%B8%80%E5%90%8D-iOS-%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84-React-Native-%E5%BC%80%E5%8F%91%E7%BB%8F%E5%8E%86-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/04/01/%E4%B8%80%E5%90%8D-iOS-%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84-React-Native-%E5%BC%80%E5%8F%91%E7%BB%8F%E5%8E%86-md/" class="post-title-link" itemprop="url">一名 iOS 开发者的 React Native 开发经历.md</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-04-01 15:12:00" itemprop="dateCreated datePublished" datetime="2017-04-01T15:12:00+08:00">2017-04-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Translate/" itemprop="url" rel="index"><span itemprop="name">Translate</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>如果你是一名 iOS 开发者，你应该听说过 React Native。它给出了简单而吸引人的承诺：一次编写，两处部署，同时搞定 iOS 与安卓版本的 app。我是一名资深的 iOS 开发者（还是一名更资深的 macOS 开发者），我想分享我应用这门神奇技术的经历。</p>
<p>去年，我们和一个客户进行过交谈。他们来找我们是因为他们想尽快完成他们的 iOS app。在讨论的过程中，他们提到了这个叫做 React Native 的东西。他们有个善于使用 Javascript 的 web 开发人员，那个人指出使用 RN 可以让开发速度快很多。这场谈判最终我们没有达成共识而是以失败告终，但这件事也让我开始思考是否应该将 RN 纳入我们的技术栈中</p>
<p>几周后一位老友来访，让我为他出版的一本书制作一个 app 作为补充参考资料。因为这个工作我找到了一线机会：这是一个很棒的时机来试一试 React Native。由于他的读者大多数使用安卓系统，因此「一次编写，两处部署」的理念在此深得我心。</p>
<p>我不会带你亲历一遍我的各种尝试和遇到的问题。但我要说的是，就这么一个简单的 app，并不能使用 RN 很好的进行开发。以下是原因。</p>
<p>首先，我必须说一下除开「一次编写，两处部署」的承诺，我喜欢 React Native 的地方。</p>
<ul>
<li>React.js，RN 由它而生。它是一种描述与更新 UI 的优雅方法。它的基本原理是组件使用一组传递给它的属性由上到下渲染其 UI。感谢 React 的虚拟 DOM，当属性变化时 UI 会立即更新，使得 model 与 view 能够自动且无缝地同步。我多么希望 iOS 的 UIKit 也这样设计啊！</li>
<li>更新 JSX 代码就可以在模拟器中更新 app 而不需要重新编译与重新运行，这点真的很棒。</li>
<li>蓬勃发展的 RN 社区提供了数以百计的预制组件，你可以在你的 app 中使用它们。（实际上我非常讨厌这种看似专业的「脚本小子」的编程方法。构建一个大部分都不是你自己写的，并且弄不明白的 app，将会导致之后的维护如同陷入泥潭一般困难）</li>
<li>我很担心 RN 的性能，但是在我的经历中它并没有出现问题。滚动和动画都很流畅。毕竟 RN app 大部分使用的是平台原生的 UI 控件，RN 的工程师们也对它们进行了很好的优化。</li>
</ul>
<p>那么为什么我不喜欢它呢？老实说，我并不是 React Native 的目标用户。我熟悉 Javascript 但我并不精通它，我精通的是 Swift/Objective-C。我很快就意识到，如果我使用 RN 来完成这个 app，将会比我用 Swift 慢 10-20 倍。当然，安卓版本还要单独写，但是考虑到我学习 RN 的学习曲线，我还不如去学习 Java。</p>
<p>除此之外，我认为采用 RN 的解决方案还有一些严重的问题。</p>
<h3 id="脆弱的依赖链"><a href="#脆弱的依赖链" class="headerlink" title="脆弱的依赖链"></a>脆弱的依赖链</h3><p>React Native 并不是一个一站式解决方案。我制作了一个粗略的必要组件依赖图：</p>
<p><img src="/images/pasted-117.png" alt="upload successful"></p>
<p>React Native 的依赖链</p>
<p>如果你来自 web 开发的世界，这可能对你来说很正常；但是对我来说，这很不正常。我的世界中有 Xcode，任何创建 Swift/Obj-C/iOS/Mac/Apple TV 等 app 所需要的东西都已经封装好并由 Xcode 管理。依赖链和前面的图一样（甚至更长），<strong>但是依赖链中的东西都保证是同步且兼容的。</strong></p>
<p>我现在肯定 RN 依赖链中的大多数组件都是互相兼容的。但我遇到了四五个需要在 StackOverflow 上花几小时寻求解决方案的问题。在我心中更重要的是之后会发生的事情。例如，升级 Nuclide（IDE 的 RN 拓展）可能需要新版的 Atom。我系统中的另一个工具需要新版的 <code>winston</code>，如果那个版本不兼容 RN 怎么办？后果可想而知。</p>
<h3 id="被打破的承诺"><a href="#被打破的承诺" class="headerlink" title="被打破的承诺"></a>被打破的承诺</h3><p>事实证明「一次编写，两处部署」的承诺只有部分实现了。我遇到了必须要把我的 RN app 根据目标平台（iOS 或安卓）进行「分支」的问题。例如 tab bar，你可能认为像它这么随处可见的组件会被 RN 列为「一等公民」，但事实不是这样的。RN 为 iOS 收录了 <code>TabBarIOS</code> 组件，但是因为某些原因它在安卓上并不相同。相反，在 GitHub 上有一堆的教程和解决方案教你如何从头做起。又例如 nav bar，iOS 的 <code>NavigatorIOS</code> 与安卓的 <code>Navigator</code> 工作方式差别巨大。这些核心的导航功能结构在两个平台上的差异会导致要为每个平台分别编写大量的不同的文件与组件。我开始感觉到，尽管承诺很神奇，尽管我在用同一种语言，但其实我仍然在写两个不同的 app。</p>
<ul>
<li>实际上，这个「承诺」其实是别人推断的，并不是官方宣称的（至少 Facebook/RN 的人没有这么宣称过）。官方宣传的是「一次学习，随处编写」。</li>
</ul>
<h3 id="令人惊讶的技术限制"><a href="#令人惊讶的技术限制" class="headerlink" title="令人惊讶的技术限制"></a>令人惊讶的技术限制</h3><p>我在做的这个项目其实是一个层级化的参考指南。书作者和我为目录与文章用我们设计的 UI 范式规划了一套挺合理的布局。根据我们的想法，我们可以通过链接或导航跳转到数百个使用静态内容的详情页中。我写好了代码，但奇怪的是我调用 <code>require()</code> 一直不成功。我经过一段时间的研究，了解到 RN 限制<strong>您无法从任意路径读取文件</strong>。显然你的 RN app 在编译时收集了所有可能用到的路径，任何编译器无法找到的路径都将不能读取。所以你可以用 <code>require(‘../file1.json’)</code> 但不能用 <code>require(‘../file’ + ‘1’ + ‘.json’)</code>。这个让人惊讶的限制使得我们的架构无法实现。</p>
<h3 id="冒牌货般的-UI"><a href="#冒牌货般的-UI" class="headerlink" title="冒牌货般的 UI"></a>冒牌货般的 UI</h3><p>你最终完成的 RN app 可能既不像原生的 iOS app 也不像原生的安卓 app。大多数用户可能不会察觉这个问题，但有些人会发现更大的问题。你有可能会丢失一些用户会注意到的平台特有的细节，例如不能从左侧右滑来返回。（当你用 <code>NavigatorIOS</code> 完成两个平台的导航时会出现这个问题）</p>
<p>总而言之，iOS 开发者不应该将 React Native 视为两个平台的跨平台解决方案。写一个原生的 iOS app 将会花费<strong>更少</strong>的时间并可能得到更棒的 UX。对于安卓 app 也一样，所以我认为大家应该更多的去专注于平台原生解决方案。</p>
<p>什么时候用 RN 才是正确的呢？如果你是一个专业的 Javascript 程序员或者你有这么一个员工，并且你<strong>不打算</strong>配置 iOS 开发或安卓开发人员，那么你<strong>可能</strong>会从中获益。还记得那个想要尽快做好跨平台 app 的那个客户吗？他们<strong>曾</strong>有一名 Javascript 工程师，他们 app 的 v1.0 版本最近才出现在应用商店中。此时，距他们联系我们已经过去了 8 个月。</p>
<blockquote>
<p>发布于掘金 <a target="_blank" rel="noopener" href="https://juejin.im/post/58df4c3fa0bb9f0069e2f2bd">https://juejin.im/post/58df4c3fa0bb9f0069e2f2bd</a></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/23/EM-algorithm-in-python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/23/EM-algorithm-in-python/" class="post-title-link" itemprop="url">EM algorithm in python</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-03-23 01:15:00" itemprop="dateCreated datePublished" datetime="2017-03-23T01:15:00+08:00">2017-03-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>由<a href="http://lsvih.com/?p=515">之前的学习笔记</a> 使用python实现EM算法。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lsvih/algorithm-practice/tree/master/em">代码地址</a></p>
<h2 id="EM-algorithm"><a href="#EM-algorithm" class="headerlink" title="EM algorithm"></a>EM algorithm</h2><script type="math/tex; mode=display">\text{Repeat until convergence}\{\\
\text{(E-step) For each i,set}\\
 Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)\\
 \text{(M-step) set}\\
 \theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}\}</script><h2 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h2><p>和上一篇k-means一样，从准备数据开始。EM算法可以用来对数据集中数据的分布参数进行极大似然估计。因此，为它准备两组一维高斯分布数据。</p>
<p>使用numpy的randn函数来生成正态分布数据，使用matplotlib来对其进行可视化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.randn.html#numpy.random.randn">参考numpy的文档</a>，生成一个[latex]N(mu,sigma^2)[/latex]的正态分布，需要使用</p>
<p>mu + sigma * np.random.randn(..)</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateDataAndShow</span>():</span></span><br><span class="line">    x1,x2 = mu1 + sigma * np.random.randn(<span class="number">500</span>),mu2 + sigma * np.random.randn(<span class="number">500</span>)</span><br><span class="line">    x = np.append(x1,x2)</span><br><span class="line">    plt.hist(x,<span class="number">50</span>,normed=<span class="literal">True</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = generateDataAndShow()</span><br></pre></td></tr></table></figure>
<p>这样，就得到了两组分别以[latex]N(mu_1,sigma^2)[/latex]与[latex]N(mu_2,sigma^2)[/latex]分布的数据集。通过matplotlib可以看到它们的分布概率图大致如下：</p>
<p><img src="/images/pasted-115.png" alt="upload successful"></p>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p>算法的推导与分析在<a href="http://lsvih.com/?p=515">http://lsvih.com/?p=515</a> 进行过了。总体来说是一个迭代渐进的过程。渐进的变量有两个，一个是实现分类的隐藏变量z，另一个是决定分布函数的参数[latex]theta[/latex]。</p>
<h3 id="E-step"><a href="#E-step" class="headerlink" title="E-step"></a>E-step</h3><p>已知高斯函数的概率密度函数(PDF)为</p>
<script type="math/tex; mode=display">f(x,\sigma,\mu)=\frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i,X <span class="keyword">in</span> enumerate(data):</span><br><span class="line">    p1 = np.exp(-(X-mu1)**<span class="number">2</span>/(<span class="number">2</span>*sigma**<span class="number">2</span>))/(sigma*(np.sqrt(<span class="number">2</span>*np.pi)))</span><br><span class="line">    p2 = np.exp(-(X-mu2)**<span class="number">2</span>/(<span class="number">2</span>*sigma**<span class="number">2</span>))/(sigma*(np.sqrt(<span class="number">2</span>*np.pi)))</span><br><span class="line">    Z[i,<span class="number">0</span>],Z[i,<span class="number">1</span>] = p1/(p1+p2),p2/(p1+p2)</span><br></pre></td></tr></table></figure>
<p>即实现$Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)$</p>
<h3 id="M-step"><a href="#M-step" class="headerlink" title="M-step"></a>M-step</h3><p>data为矩阵</p>
<script type="math/tex; mode=display">\begin{bmatrix}x_1\\x_2\\...\\x_n\end{bmatrix}</script><p>而Z为矩阵</p>
<script type="math/tex; mode=display">\begin{bmatrix}Z^{(1)}_1&Z^{(1)}_2\\Z^{(2)}_1&Z^{(2)}_2\\...\\Z^{(n)}_1&Z^{(n)}_2\end{bmatrix}</script><p>因此完成$\theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}$运算可以使用矩阵的点乘实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mu1,mu2 = np.dot(np.array(data),np.array(Z))/np.sum(Z,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>在对于E-step与M-step不停的迭代优化后，达到一个期望精度值停止运算。因此main()可以写成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    o_mu1,o_mu2 = mu1,mu2</span><br><span class="line">    Z = np.zeros([len(data),<span class="number">2</span>])</span><br><span class="line">    <span class="comment">#E-Step</span></span><br><span class="line">    <span class="comment">#M-Step</span></span><br><span class="line">    <span class="keyword">if</span> abs(o_mu1-mu1)+abs(o_mu2-mu2) &lt;= <span class="number">0.001</span>:</span><br><span class="line">        <span class="keyword">print</span> mu1,mu2</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>在迭代至指定精度后，将得到的mu1与mu2与sigma决定的正态分步曲线画出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Darw Gaussian function</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.mlab <span class="keyword">as</span> mlab</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">n,bins,p = ax.hist(data,<span class="number">50</span>,normed=<span class="literal">True</span>)</span><br><span class="line">y1,y2 = mlab.normpdf(bins, mu1, sigma), mlab.normpdf(bins, mu2, sigma)</span><br><span class="line">ax.plot(bins, y1/<span class="number">2</span>)</span><br><span class="line">ax.plot(bins, y2/<span class="number">2</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>可以看到，最初的generateData函数中画出的图形为</p>
<p><img src="/images/pasted-115.png" alt="upload successful"></p>
<p>得到结果后画出的曲线为</p>
<p><img src="/images/pasted-116.png" alt="upload successful"></p>
<p>基本能匹配之前生成的数据。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/22/python%E5%AE%9E%E7%8E%B0k-means%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/22/python%E5%AE%9E%E7%8E%B0k-means%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">python实现k-means分类算法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-03-22 01:51:00" itemprop="dateCreated datePublished" datetime="2017-03-22T01:51:00+08:00">2017-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>准备实现一些算法，顺带复习numpy，因此将比较简单的k-means算法用python实现一次。</p>
<h2 id="k-means算法"><a href="#k-means算法" class="headerlink" title="k-means算法"></a>k-means算法</h2><p><img src="/images/pasted-109.png" alt="upload successful"></p>
<h2 id="准备数据集"><a href="#准备数据集" class="headerlink" title="准备数据集"></a>准备数据集</h2><p>首先，考虑数据集来源。懒得去找数据，因此直接用scikit的dataset模块随机生成一组聚类数据。既然要生成聚类数据，用make_blobs是再好不过了。<a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs">sklearn.dataset.make_blobs文档</a></p>
<p>为了直观地展示数据，用matplotlib来进行数据可视化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateDataAndShow</span>():</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.title(<span class="string">&quot;Dataset&quot;</span>, fontsize=<span class="string">&#x27;small&#x27;</span>)</span><br><span class="line">    datas, class_info = make_blobs(n_samples=<span class="number">200</span> ,n_features=<span class="number">2</span>, centers=<span class="number">3</span>)</span><br><span class="line">    plt.scatter(datas[:, <span class="number">0</span>], datas[:, <span class="number">1</span>], marker=<span class="string">&#x27;o&#x27;</span>, c=class_info)</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="keyword">return</span> datas</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = generateDataAndShow()</span><br></pre></td></tr></table></figure>
<p>可以得到一个有三个聚类，共200个点的数据集。如图所示</p>
<p><img src="/images/pasted-110.png" alt="upload successful"></p>
<p>且每次运行都会生成不同的数据。</p>
<p>此时，得到200对坐标数据以及相应的分类数据。仅将坐标数据拿出来进行计算。</p>
<h2 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h2><p>1、随机生成3个点，作为初始聚类中心。为了减少计算量，所以将3个点生成在所有点的值域中。此时data的数据结构是Float[][]，第一重数组为一个点，第二重数组为点的两个坐标。因此需要用到numpy的amax函数与amin函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x_max, y_max], [x_min, y_min] = np.amax(data,axis=<span class="number">0</span>),np.amin(data,axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>使用numpy.random的rand生成一组点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">centers = np.random.rand(<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">centers[<span class="number">0</span>:,<span class="number">0</span>] = (x_max-x_min)*centers[<span class="number">0</span>:,<span class="number">0</span>]+x_min</span><br><span class="line">centers[<span class="number">0</span>:,<span class="number">1</span>] = (y_max-y_min)*centers[<span class="number">0</span>:,<span class="number">1</span>]+y_min</span><br></pre></td></tr></table></figure>
<p>这样就得到了在值域内的3个随机点。</p>
<p>2、计算距离。二维平面内两个点的距离公式为</p>
<script type="math/tex; mode=display">d=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}</script><p>因此可以计算出每个点分别到三个聚类中心的距离：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">distance</span>(<span class="params">data, dots</span>):</span></span><br><span class="line">    rs = []</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">        rs.append([])</span><br><span class="line">        <span class="keyword">for</span> dot <span class="keyword">in</span> dots:</span><br><span class="line">            rs[<span class="number">-1</span>].append(((d[<span class="number">0</span>]-dot[<span class="number">0</span>])**<span class="number">2</span>+(d[<span class="number">1</span>]-dot[<span class="number">1</span>])**<span class="number">2</span>)**<span class="number">0.5</span>)</span><br><span class="line">    <span class="keyword">return</span> rs</span><br></pre></td></tr></table></figure>
<p>3、分组。根据计算得到的各个点距离聚类中心的距离，可以判断这个点是属于哪一个聚类的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify</span>(<span class="params">dis</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [i.index(min(i)) <span class="keyword">for</span> i <span class="keyword">in</span> dis]</span><br></pre></td></tr></table></figure>
<p>返回一个分类索引数组。这个时候也可以用plt将此时的分类打印出来，和最开始的正确聚类对比一下：</p>
<p><img src="/images/pasted-111.png" alt="upload successful"></p>
<p><img src="/images/pasted-112.png" alt="upload successful"> </p>
<p>考虑一种特殊情况：只分出两个聚类。这时候将无法继续计算下去，应当重新随机生成中心。</p>
<p>4、移动聚类中心。根据随机得到的初始聚类，重新计算每个聚类的质心作为其新的聚类中心。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calCenters</span>(<span class="params">data, clazz</span>):</span></span><br><span class="line">    clz = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>)]</span><br><span class="line">    <span class="keyword">for</span> index,dot <span class="keyword">in</span> enumerate(data):</span><br><span class="line">        clz[clazz[index]].append(dot)</span><br><span class="line">    <span class="keyword">return</span> [sum(x)/len(x) <span class="keyword">for</span> x <span class="keyword">in</span> clz]</span><br></pre></td></tr></table></figure>
<p>得到了新的聚类中心</p>
<p>5、循环上述步骤，直到收敛。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    new_centers = calCenters(data, clazz)</span><br><span class="line">    <span class="keyword">if</span> equal(new_centers,centers):<span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        centers = new_centers</span><br><span class="line">        clazz = classify(distance(data,centers))</span><br></pre></td></tr></table></figure>
<p>收敛条件是聚类中心点不再变化。</p>
<p>最终代码：<a target="_blank" rel="noopener" href="https://github.com/lsvih/algorithm-practice/blob/master/k-means/k-means.py">https://github.com/lsvih/algorithm-practice/blob/master/k-means/k-means.py</a> (_src=undefined)</p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>生成的聚类：</p>
<p><img src="/images/pasted-113.png" alt="upload successful"></p>
<p>k-means运行后的聚类：</p>
<p><img src="/images/pasted-114.png" alt="upload successful"></p>
<p>可以看到分类算法运行良好。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/21/EM-algorithm%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/21/EM-algorithm%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">EM algorithm最大似然算法学习笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-03-21 12:55:00" itemprop="dateCreated datePublished" datetime="2017-03-21T12:55:00+08:00">2017-03-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="琴生不等式-Jensen’s-inequality"><a href="#琴生不等式-Jensen’s-inequality" class="headerlink" title="琴生不等式(Jensen’s inequality)"></a>琴生不等式(Jensen’s inequality)</h2><p>最大似然函数应用到了琴生不等式。琴生不等式给出了积分的凸函数值和凸函数的积分值间的关系。它由以下两部分组成：</p>
<p>当$f(x)$是(a,b)区间上的凸函数时，则对任意的点$x_1,x_2,…,x_n \in (a,b)$有</p>
<script type="math/tex; mode=display">f(\frac{x_1+x_2+...+x_n}{n}) \geq \frac{1}{n}[f(x_1)+f(x_2)+...+f(x_n)]</script><p>当$x_1=x_2=…=x_n$时取等号。</p>
<p>当$f(x)$是(a,b)区间上的凹函数时，则对任意的点$x_1,x_2,…,x_n in (a,b)$有</p>
<script type="math/tex; mode=display">f(\frac{x_1+x_2+...+x_n}{n}) \leq \frac{1}{n}[f(x_1)+f(x_2)+...+f(x_n)]</script><p>当$x_1=x_2=…=x_n$时取等号。</p>
<p>将琴生不等式应用到概率论，有</p>
<p>当$f(x)$是凸函数时</p>
<script type="math/tex; mode=display">E[f(X)]\geq f(EX)</script><p>当$f(x)$是凹函数时</p>
<script type="math/tex; mode=display">E[f(X)]\leq f(EX)</script><p>如图所示：</p>
<p><img src="/images/pasted-108.png" alt="upload successful"></p>
<h2 id="最大似然算法-EM-algorithm-的推导"><a href="#最大似然算法-EM-algorithm-的推导" class="headerlink" title="最大似然算法(EM algorithm)的推导"></a>最大似然算法(EM algorithm)的推导</h2><h3 id="似然函数-likelihood-function"><a href="#似然函数-likelihood-function" class="headerlink" title="似然函数(likelihood function)"></a>似然函数(likelihood function)</h3><p>当有一组数据${ x^{(1)},…,x^{(m)} }$，这一组数据是从更大的未知数据中抽样出来的，每一个x对抽样而言都是独立事件。因此，抽样出每个数据的概率为$p(x)$，抽样出这一组数据集的概率则为$\prod^m_{i=1} p(x)$。而所有的数据都满足某一个分布规律（求的正是这个规律），例如高斯分布等。这个分布规律含有一个分布参数$\theta$，这个参数决定了这个分布规律。此时抽样出数据集的概率为$\prod^m_{i=1} p(x_i;\theta)$，将这个式子记为$L(\theta)$，即</p>
<script type="math/tex; mode=display">L(\theta)=\prod^m_{i=1} p(x_i;\theta)</script><p>当$L(\theta)$最大时，有最大的可能抽出这组数据，就能猜测$\theta$是分布概率的参数。这个式子被称为似然函数。</p>
<blockquote>
<p>p(x;y)表示当参数为y时x的概率</p>
</blockquote>
<p>为了让计算更方便，将乘法运算通过求ln值变化为加法运算</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)</script><p>这个l称为loglikelihood function</p>
<h3 id="最大似然函数"><a href="#最大似然函数" class="headerlink" title="最大似然函数"></a>最大似然函数</h3><p>当有多组数据时，每组数据的分布规律都不同，对于每组数据来说都有一个隐藏的变量z将不同的组别分开。例如对于$x^{(i)}$来说，有$p(z^{(1)})$的可能是聚类1的，有$p(z^{(2)})$的可能是聚类2的。因此将所有的可能加起来，有</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)=\sum^m_{i=1} ln\sum_{z^{(i)}}p(x^{(i)},z^{(i)};\theta)</script><p>为了求其最值，则需要对其进行求导。此时发现，$\sum \ln \sum f(x,y,z)$相当难进行求导，因此对其进行化简：</p>
<p>对于$x^{(i)}$，它的所有z概率之和记为$\sum_{z^{(i)}} Q_i(z^{(i)})=1$，对上式加入这个值，得到</p>
<script type="math/tex; mode=display">l(\theta)=\sum^m_{i=1} \ln p(x_i;\theta)=\sum^m_{i=1} \ln\sum_{z^{(i)}} Q_i(z^{(i)}) \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>对于$f(x)=\ln x$来说，$\frac{\mathrm{d}^2 f(x) }{\mathrm{d} x^2}=-\frac{1}{x^2}\leq0$，因此它为凹函数。应用琴生不等式，$E(f(x)) \leq f(EX)$。同理，上式进行不等变换：</p>
<script type="math/tex; mode=display">f(E_{z^{(i)~Q_i}}[\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}]) \geq E_{z^{(i)~Q_i}}[f(\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})})]\Rightarrow
\\
\sum^m_{i=1} ln\sum_{z^{(i)}} Q_i(z^{(i)}) \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} \\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>此时得到的式子是一个不等式，确切的说是似然函数的下界。为了让似然函数达到最大，则需要得到合适的$z,\theta$让下界更高。</p>
<p>此时分两步来进行计算：第一步固定$\theta$调整$Q_i(z^i)$，让下界上升至最高(前式的不等式取到等号)，第二部固定$Q_i(z^i)$调整$\theta$，使似然函数的值升高，下界达到最高，再重复第一步。循环往复直到第二步收敛。</p>
<h4 id="E-step"><a href="#E-step" class="headerlink" title="E-step"></a>E-step</h4><p>根据琴生不等式，当X为常数时，肯定有$E[f(X)]= f(EX)$，即</p>
<script type="math/tex; mode=display">\frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} = c</script><p>而$\sum_{z^{(i)}} Q_i(z^{(i)})=1$，因此</p>
<script type="math/tex; mode=display">Q_i(z^{(i)})=\frac{p(x^{(i)},z^{(i)};\theta)}{\sum_z p(x^{(i)},z,\theta)}=p(x^{(i)},z^{(i)};\theta)</script><p>这就是第一步，让琴生不等式中的X为常数，取到f(x)的最大值。这一步记为E-step：</p>
<script type="math/tex; mode=display">Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta)</script><h4 id="M-step"><a href="#M-step" class="headerlink" title="M-step"></a>M-step</h4><p>固定$\theta$，下界为</p>
<script type="math/tex; mode=display">\sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>此时要调整$Q_i(z^i)$，让下界升到最高。记第t步为$l(\theta^{t})$，第t+1步为$l(\theta^{t+1})$。由于下界在升高，最大似然函数值也会升高，$Q_i(z^i)$随之升高，直到收敛。因此可以推导</p>
<script type="math/tex; mode=display">l(\theta^{(t+1)})=\sum^m_{i=1} \sum_{z^{(i)}} Q_i^{(t+1)}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{(t+1)})}{Q^{(t+1)}_i(z^{(i)})}\\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i^{t}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{(t+1)})}{Q^{t}_i(z^{(i)})}\\
\geq \sum^m_{i=1} \sum_{z^{(i)}} Q_i^{t}(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta^{t})}{Q^{t}_i(z^{(i)})}=l(\theta^{t})</script><p>最终得到</p>
<script type="math/tex; mode=display">l(\theta^{(t+1)}) \geq l(\theta^t)</script><p>因此可得知M-step中，$Q_i(z^i)$的值会不断增加直到收敛。</p>
<p>M-step记为</p>
<script type="math/tex; mode=display">\theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>最终得到最大似然算法：</p>
<script type="math/tex; mode=display">
\text{Repeat until convergence}\{ \\
\text{(E-step) For each i,set}\\
 Q_i(z^{(i)}):=p(x^{(i)},z^{(i)};\theta) \\
 \text{(M-step) set}\\
 \theta:=\arg \max_\theta \sum^m_{i=1} \sum_{z^{(i)}} Q_i(z^{(i)}) \ln \frac{p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}\\
 \}</script><hr>
<blockquote>
<p>Reference</p>
<p>Stanford CS229 <a target="_blank" rel="noopener" href="http://cs229.stanford.edu/notes/cs229-notes8.pdf">http://cs229.stanford.edu/notes/cs229-notes8.pdf</a><br><a href="https://lsvih.com/img/1490063106133851.pdf">cs229-notes8-EM算法.pdf</a><br>从最大似然到EM算法浅解 <a target="_blank" rel="noopener" href="http://blog.csdn.net/zouxy09/article/details/8537620/">http://blog.csdn.net/zouxy09/article/details/8537620/</a></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/03/08/swift%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E8%BD%BB%E9%87%8F%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/08/swift%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8%E8%BD%BB%E9%87%8F%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">swift持久化存储轻量数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-03-08 16:43:00" itemprop="dateCreated datePublished" datetime="2017-03-08T16:43:00+08:00">2017-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Front-End/" itemprop="url" rel="index"><span itemprop="name">Front End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>做个简单的记事本,效果如下：</p>
<p>主要使用UserDefaults(以前是NSUserDefaults)实现数据的持久化,将Array<String>数据存储在沙盒里。</p>
<p>直接使用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">syncStore</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>(objects, forKey: <span class="string">&quot;history&quot;</span>)</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.synchronize()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>存数据。</p>
<p>读取数据使用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objects = <span class="type">UserDefaults</span>.standard.value(forKey: <span class="string">&quot;history&quot;</span>) <span class="keyword">as</span>! <span class="type">Array</span>&lt;<span class="type">Any</span>&gt;</span><br></pre></td></tr></table></figure>
<p>在第一次启动的时候读数据会出错，因此需要判断是否为第一次启动，如果是第一次启动则需要初始化存储结构。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isFirstLaunch = <span class="type">UserDefaults</span>.standard.string(forKey: <span class="string">&quot;FirstLaunch&quot;</span>) == <span class="literal">nil</span></span><br><span class="line"><span class="keyword">if</span>(isFirstLaunch)&#123;</span><br><span class="line">    <span class="type">UserDefaults</span>.standard.<span class="keyword">set</span>(<span class="string">&quot;false&quot;</span>, forKey: <span class="string">&quot;FirstLaunch&quot;</span>)</span><br><span class="line">    syncStore()</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    objects = <span class="type">UserDefaults</span>.standard.value(forKey: <span class="string">&quot;history&quot;</span>) <span class="keyword">as</span>! <span class="type">Array</span>&lt;<span class="type">Any</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>插入数据的function:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertNewObject</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> alertController = <span class="type">UIAlertController</span>(</span><br><span class="line">    title: <span class="string">&quot;添加备忘&quot;</span>, </span><br><span class="line">    message: <span class="string">&quot;请输入备忘内容&quot;</span>, </span><br><span class="line">    preferredStyle: <span class="type">UIAlertControllerStyle</span>.alert)</span><br><span class="line">    <span class="keyword">let</span> insertAction = <span class="type">UIAlertAction</span>(</span><br><span class="line">    title: <span class="string">&quot;确认&quot;</span>, </span><br><span class="line">    style: .<span class="keyword">default</span>, </span><br><span class="line">    handler: &#123;</span><br><span class="line">    (action: <span class="type">UIAlertAction</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(alertController.textFields![<span class="number">0</span>].text!)</span><br><span class="line">        <span class="keyword">self</span>.objects.insert(alertController.textFields![<span class="number">0</span>].text!, at: <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">let</span> indexPath = <span class="type">IndexPath</span>(row: <span class="number">0</span>, section: <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">self</span>.tableView.insertRows(at: [indexPath], with: .automatic)</span><br><span class="line">        <span class="keyword">self</span>.syncStore()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">let</span> cancelAction = <span class="type">UIAlertAction</span>(title: <span class="string">&quot;取消&quot;</span>, style: .cancel)</span><br><span class="line">    alertController.addTextField &#123; (textField:<span class="type">UITextField</span>) <span class="keyword">in</span></span><br><span class="line">        textField.placeholder = <span class="string">&quot;请输入内容&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    alertController.addAction(insertAction)</span><br><span class="line">    alertController.addAction(cancelAction)</span><br><span class="line">    <span class="keyword">self</span>.present(alertController, animated: <span class="literal">true</span>, completion: <span class="literal">nil</span>)    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/02/18/%E6%97%8B%E8%BD%AC%E7%94%9F%E6%88%90%E7%9F%A9%E9%98%B5-Spiral-Matrix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/18/%E6%97%8B%E8%BD%AC%E7%94%9F%E6%88%90%E7%9F%A9%E9%98%B5-Spiral-Matrix/" class="post-title-link" itemprop="url">旋转生成矩阵(Spiral Matrix)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-02-18 05:18:00" itemprop="dateCreated datePublished" datetime="2017-02-18T05:18:00+08:00">2017-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Given an integer <em>n</em>, generate a square matrix filled with elements from 1 to <em>n</em>2 in spiral order.</p>
<p>For example,</p>
<p>Given <em>n</em> = 3,</p>
<p>You should return the following matrix:</p>
<p>[[ 1, 2, 3 ],</p>
<p> [ 8, 9, 4 ],</p>
<p> [ 7, 6, 5 ]]</p>
<p>与之前蛇形遍历一个思路，给定几个状态x,y,state(说明当前生成的方向)</p>
<p>在这个问题中，只有以下几种情况：向上生成到顶时，向右生成；向右生成到顶时，向下生成；向下生成到顶时，向左生成；向左生成到顶时，向上生成。最终的结束条件是生成了n^2个数字。</p>
<p>首先生成一个n*n的矩阵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">    rs.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">        rs[i].append(<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>这样就得到了一个n*n的空矩阵。</p>
<p>开始时尝试过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="literal">None</span>]*n]*n</span><br></pre></td></tr></table></figure>
<p>与</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]]*n</span><br></pre></td></tr></table></figure>
<p>的方式，发现均会出现问题。原因是以这种方式生成的二维数组的子项指向的是同一个对象。其后果是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [[<span class="literal">None</span>]*<span class="number">5</span>]*<span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[[<span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[[<span class="literal">None</span>, <span class="literal">None</span>, <span class="number">1</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="number">1</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="number">1</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="number">1</span>, <span class="literal">None</span>, <span class="literal">None</span>], </span><br><span class="line">[<span class="literal">None</span>, <span class="literal">None</span>, <span class="number">1</span>, <span class="literal">None</span>, <span class="literal">None</span>]]</span><br></pre></td></tr></table></figure>
<p>使用built-in查看它们的id发现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>id(a[<span class="number">2</span>]),id(a[<span class="number">3</span>])</span><br><span class="line">(<span class="number">4337281432</span>, <span class="number">4337281432</span>)</span><br></pre></td></tr></table></figure>
<p>因此放弃看上去简洁的写法。</p>
<blockquote>
<p>更新：发现一个简洁有效的写法：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = [[<span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)] <span class="keyword">for</span> j <span class="keyword">in</span> range(n)]</span><br></pre></td></tr></table></figure>
<hr>
<p>之后找出每个方向的条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> step &lt;= n**<span class="number">2</span>:</span><br><span class="line"><span class="comment"># print x,y,state,step,layer,tmp</span></span><br><span class="line">    rs[x][y] = step</span><br><span class="line">    <span class="keyword">if</span> state == <span class="string">&#x27;up&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> x == layer:</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">            state = <span class="string">&#x27;right&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:x -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">&#x27;right&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> y+<span class="number">1</span> == n-layer:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            state = <span class="string">&#x27;down&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:y+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">&#x27;down&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> x+<span class="number">1</span> == n-layer:</span><br><span class="line">            y -= <span class="number">1</span></span><br><span class="line">            state = <span class="string">&#x27;left&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:x+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> state == <span class="string">&#x27;left&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> y == layer:</span><br><span class="line">            x-=<span class="number">1</span></span><br><span class="line">            state= <span class="string">&#x27;up&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:y-=<span class="number">1</span></span><br><span class="line">    step += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>大意如此。其中layer为当前从外向内已生成完的层数，由</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> step == n**<span class="number">2</span>-(n-layer*<span class="number">2</span><span class="number">-2</span>)**<span class="number">2</span>:layer+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>可以得到。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2017/02/07/%E8%9B%87%E5%BD%A2%E9%81%8D%E5%8E%86-Diagonal-Traverse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/07/%E8%9B%87%E5%BD%A2%E9%81%8D%E5%8E%86-Diagonal-Traverse/" class="post-title-link" itemprop="url">蛇形遍历(Diagonal Traverse)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-02-07 14:30:00" itemprop="dateCreated datePublished" datetime="2017-02-07T14:30:00+08:00">2017-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>Input:</strong></p>
<p>[[ 1, 2, 3 ],</p>
<p> [ 4, 5, 6 ],</p>
<p> [ 7, 8, 9 ]]</p>
<p><strong>Output:</strong>  [1,2,4,7,5,3,6,8,9]</p>
<p><strong>Explanation:</strong></p>
<p><img src="/images/pasted-107.png" alt="upload successful"></p>
<p>像蛇爬行一样沿着对角线来回遍历整个矩阵。</p>
<p>提供一种很容易实现的解题思路：</p>
<p>在遍历过程中有几种情况：向右遍历、向下遍历、向左下遍历、向右上遍历。</p>
<p>给定两个变量x,y(记做matrix[x][y])记录当前坐标，就能通过判断这几个方向决定下一个坐标位置。</p>
<p>例如，向左下遍历即x++,y—，如果x已经到矩阵下边界则转向右遍历；如果x未到矩阵下边界,y到矩阵左边界则向下遍历；如果xy都未到矩阵边界则继续向左下遍历。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">state,x,y,M,N = <span class="string">&#x27;right_up&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,len(matrix),len(matrix[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">if</span> state == <span class="string">&#x27;left_down&#x27;</span>:</span><br><span class="line">    rs.append(matrix[x][y])</span><br><span class="line">    <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x == M<span class="number">-1</span>:</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">            state = <span class="string">&#x27;right_after_left_down&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            state = <span class="string">&#x27;down_after_left_down&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">            y -= <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>依次类推，可以将所有情况与边界情况都列出来。</p>
<p>同时需要排除三种特殊情况：当矩阵为空时不存在遍历结果；当矩阵行或列为1时直接将矩阵从上至下遍历。</p>
<p>经简化可写出解法(result)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findDiagonalOrder</span>(<span class="params">matrix</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :type matrix: List[List[int]]</span></span><br><span class="line"><span class="string">    :rtype: List[int]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> matrix == []:<span class="keyword">return</span> []</span><br><span class="line">    rs,state,x,y,M,N = [],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,len(matrix),len(matrix[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> M == <span class="number">1</span> <span class="keyword">or</span> N == <span class="number">1</span>:<span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y:x+y,matrix)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        rs.append(matrix[x][y])</span><br><span class="line">        <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">and</span> y == N<span class="number">-1</span>:<span class="keyword">return</span> rs</span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> x == <span class="number">0</span> <span class="keyword">or</span> y == N<span class="number">-1</span>:</span><br><span class="line">                <span class="keyword">if</span> y == N<span class="number">-1</span>:x,state = x+<span class="number">1</span>,<span class="number">2</span></span><br><span class="line">                <span class="keyword">else</span>:y,state = y+<span class="number">1</span>,<span class="number">5</span></span><br><span class="line">            <span class="keyword">else</span>:x,y = x<span class="number">-1</span>,y+<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> x == M<span class="number">-1</span> <span class="keyword">or</span> y == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> x == M<span class="number">-1</span>:y,state = y+<span class="number">1</span>,<span class="number">4</span></span><br><span class="line">                <span class="keyword">else</span>:x,state = x+<span class="number">1</span>,<span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:x,y = x+<span class="number">1</span>,y<span class="number">-1</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">3</span> <span class="keyword">or</span> state == <span class="number">4</span>:x,y,state = x<span class="number">-1</span>,y+<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> state == <span class="number">2</span> <span class="keyword">or</span> state == <span class="number">5</span>:x,y,state = x+<span class="number">1</span>,y<span class="number">-1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>其中每个元素都被处理过一遍，其时间复杂度为O(n)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/12/31/Python-collections%E6%A8%A1%E5%9D%97%E4%B8%AD%E7%9A%84Counter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/31/Python-collections%E6%A8%A1%E5%9D%97%E4%B8%AD%E7%9A%84Counter/" class="post-title-link" itemprop="url">Python collections模块中的Counter</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-12-31 09:02:04" itemprop="dateCreated datePublished" datetime="2016-12-31T09:02:04+08:00">2016-12-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>除了内置(build-in)数据结构(dict,list,set,tuple)之外，python还提供了一些额外的数据结构。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br></pre></td></tr></table></figure>
<p>collections提供了5种可选的数据结构:Counter,deque,OrderDict,defaultdict,namedtuple()</p>
<h2 id="collections-Counter"><a href="#collections-Counter" class="headerlink" title="collections.Counter"></a>collections.Counter</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br></pre></td></tr></table></figure>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Counter是dict的一个子集，它可以用来计算dict中的可哈希对象。它是一个无排序集合，它的元素作为dict的key存储，对应的计数则以其value存储，例如Counter({‘a’:1,’b’:2,’c’:4})代表有1个a,2个b,4个c。Counter接受所有的整数作为其计数(包括0和负数在内)。</p>
<h3 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h3><p>构造一个空的Counter</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter()</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter()</span><br></pre></td></tr></table></figure>
<p>从迭代器创建Counter</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">&quot;asdf&quot;</span>)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>由字典mapping创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(&#123;<span class="string">&#x27;ss&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;dd&#x27;</span>:<span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;dd&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;ss&#x27;</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>由参数的keyword创建</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(hh = <span class="number">2</span>,ss = <span class="number">6</span>)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;ss&#x27;</span>:<span class="number">6</span>,<span class="string">&#x27;hh&#x27;</span>:<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><p>Counter有一些很有用的特性。例如，作为一个计数器，当读取Counter中不存在的key时，不会像通常dict那样返回错误，而是会返回0(意思是Counter里有0个这种key)</p>
<p>例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = Counter([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用dict</span></span><br><span class="line">t = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">1</span>&#125;</span><br><span class="line">t[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="comment">#此时报错</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用Counter</span></span><br><span class="line">c[<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="comment">#输出0</span></span><br></pre></td></tr></table></figure>
<p>将Counter中的一个key的value设置为0(即将其计数清零)并不会删除这个元素，只有使用del才能将其中的元素删除。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c = Counter([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">1</span>&#125;)</span><br><span class="line">c[<span class="string">&#x27;a&#x27;</span>] = <span class="number">0</span></span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;c&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>:<span class="number">0</span>&#125;)</span><br><span class="line"><span class="keyword">del</span> c[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="elements"><a href="#elements" class="headerlink" title="elements()"></a>elements()</h4><p>返回Counter()中计数大于1的所有元素。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;e&#x27;</span>:<span class="number">-2</span>&#125;)</span><br><span class="line">list(c.elements())</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br></pre></td></tr></table></figure>
<h4 id="most-common-n"><a href="#most-common-n" class="headerlink" title="most_common([n])"></a>most_common([n])</h4><p>返回Counter()中计数最多的n个元素。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">&quot;asdfaas&quot;</span>)</span><br><span class="line">c.most_common(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>,<span class="number">3</span>),(<span class="string">&#x27;b&#x27;</span>,<span class="number">2</span>)]</span><br></pre></td></tr></table></figure>
<h4 id="subtract"><a href="#subtract" class="headerlink" title="subtract()"></a>subtract()</h4><p>由一个Counter()减去另一个Counter()或迭代器或mapping。得到的数字可以为0或负数。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = Counter(<span class="string">&quot;addaw&quot;</span>)</span><br><span class="line">b = <span class="string">&quot;adddf&quot;</span></span><br><span class="line">c.subtract(b)</span><br><span class="line"><span class="comment">#此时c为</span></span><br><span class="line">Counter(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;w&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">-1</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">-1</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>除此之外，Counter()还有一些dict本身有的特性。</p>
<p>比如 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Counter(<span class="string">&quot;asdf&quot;</span>) == Counter(<span class="string">&quot;fdsa&quot;</span>) &gt;&gt;&gt;&gt; <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">Counter(<span class="string">&quot;wwww&quot;</span>) + Counter(<span class="string">&quot;ssss&quot;</span>) &gt;&gt;&gt;&gt; Counter(&#123;<span class="string">&#x27;w&#x27;</span>:<span class="number">4</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">4</span>&#125;)</span><br><span class="line"></span><br><span class="line">list(Counter(<span class="string">&quot;asdf&quot;</span>)) &gt;&gt;&gt;&gt; [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;f&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>等等。</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>Counter()计数器可以用在很多需要统计key出现字数的情景中。</p>
<p>例如求同素异构词（由相同的字母不同的顺序组成的词）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">same</span>(<span class="params">s,d</span>):</span></span><br><span class="line">    <span class="keyword">return</span> Counter(s) == Counter(d)</span><br></pre></td></tr></table></figure>
<p>求句子中出现次数最多的字母:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>(<span class="params">d</span>):</span></span><br><span class="line">    <span class="keyword">return</span> Counter(d).most_common(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>等等</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/12/20/%E8%AE%A1%E7%AE%97%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/20/%E8%AE%A1%E7%AE%97%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF/" class="post-title-link" itemprop="url">计算笛卡尔积</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-12-20 20:10:00" itemprop="dateCreated datePublished" datetime="2016-12-20T20:10:00+08:00">2016-12-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>笛卡尔积又名直积，是所有可能的有序对组成的集合，其中有序对的第一个对象是X的成员，第二个对象是Y的成员。可以表示如下：</p>
<script type="math/tex; mode=display">X\times Y={<x,y>|x\in X\land y\in Y}</script><p>例如，[[a,b],[1,2,3]]的笛卡尔积为[[a,1],[a,2],[a,3],[b,1],[b,2],[b,3]]</p>
<p>在实际应用中，笛卡尔积常用于在电商中生成商品的sku信息，将所有的属性组合起来。</p>
<p>当空间数量固定时，可以直接使用嵌套的循环来完成，例如上面的二元笛卡尔积：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> b = [<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> result = []</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;b.length;j++)&#123;</span><br><span class="line">        result.push([a[i],b[j]])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ [ <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1&#x27;</span> ],</span><br><span class="line">  [ <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;2&#x27;</span> ],</span><br><span class="line">  [ <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;3&#x27;</span> ],</span><br><span class="line">  [ <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;1&#x27;</span> ],</span><br><span class="line">  [ <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;2&#x27;</span> ],</span><br><span class="line">  [ <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;3&#x27;</span> ] ]</span><br></pre></td></tr></table></figure>
<p>推广到n元笛卡尔积：</p>
<script type="math/tex; mode=display">X_{1}\times X_{2}\times ...\times X_{n}={(x_{1},...,x_{n})|x_{1}\in X_{1}\land ...\land x_{n}in X_{n}}</script><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;a.length;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;b.length;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>()&#123;</span><br><span class="line">            ...(n次循环)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当n不为固定数值的时候，不能以这种嵌套循环的方式表示。因此考虑使用嵌套</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">combination</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :type array: List[][]</span></span><br><span class="line"><span class="string">    :rtype: List[str]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">if</span> len(array) <span class="keyword">is</span> <span class="number">0</span>: <span class="keyword">return</span> result</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cartsianProduct</span>(<span class="params">index,rs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> index <span class="keyword">is</span> len(array):</span><br><span class="line">            result.append(rs)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> array[index]:</span><br><span class="line">                next_rs = copy.copy(rs)</span><br><span class="line">                next_rs.append(item)</span><br><span class="line">                cartsianProduct(index+<span class="number">1</span>,next_rs)</span><br><span class="line">    cartsianProduct(<span class="number">0</span>,[])</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">combination([[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],[<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>]])</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1&#x27;</span>], [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;2&#x27;</span>], [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;3&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;1&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;2&#x27;</span>], [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;3&#x27;</span>]]</span><br></pre></td></tr></table></figure>
<p>对于python来说，除了使用遍历之外也可以使用py自带的迭代器itertools:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">rs = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> itertools.product([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]):</span><br><span class="line">    rs.append(x)</span><br></pre></td></tr></table></figure>
<p>output&gt;&gt;&gt;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">3</span>)]</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lsvih.com/2016/12/11/Support-Vector-Regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lsvih">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My note">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/11/Support-Vector-Regression/" class="post-title-link" itemprop="url">Support Vector Regression</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-12-11 09:13:00" itemprop="dateCreated datePublished" datetime="2016-12-11T09:13:00+08:00">2016-12-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>Intro quote from </p>
<p><a target="_blank" rel="noopener" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.114.4288">“A Tutorial on Support Vector Regression”</a>, Alex J. Smola, Bernhard Schölkopf - Statistics and Computing archive Volume 14 Issue 3, August 2004, p. 199-222</p>
</blockquote>
<p>A support vector machine constructs a hyper-plane or set of hyper-planes in a high or infinite dimensional space, which can be used for classification, regression or other tasks. Intuitively, a good separation is achieved by the hyper-plane that has the largest distance to the nearest training data points of any class (so-called functional margin), since in general the larger the margin the lower the generalization error of the classifier.</p>
<p><img src="/images/pasted-106.png" alt="upload successful"></p>
<h3 id="Mathematical-formulation"><a href="#Mathematical-formulation" class="headerlink" title="Mathematical formulation"></a>Mathematical formulation</h3><p>Given training vectors $x_{i}\in \mathbb{R}^{p}$, i=1,…, n, and a vector $y\in {1,-1}^{n}$,SVC solves the following primal problem:</p>
<script type="math/tex; mode=display">\min \limits_{w,b,\zeta }\frac{1}{2}w^{T}w+C\sum_{i=1}^{n}\zeta _{i}\\  subject \to y_{i}(w^{T}\phi (x_{i}+b))\geq 1-\zeta _{i},\\  \zeta _{i}\geq 0,i=1,...,n</script><p>Its dual is</p>
<script type="math/tex; mode=display">\min \limits_{a} \frac{1}{2}a^{T}Qa-e^{T}a\\ subject \to y^{T}a=0\\  0\leq a_{i}\leq C,i=1,...,n</script><p>where ‘e’ is the vector of all ones,’C’ &gt; 0  is the upper bound,’Q’ is an n by n positive semidefinite matrix,$Q_{ij}\equiv y_{i}y_{j}K(x_{i},x_{j})$,where $K(x_{i},x_{j})=\phi (x_{i})^{T}\phi (x_{j})$  is the kernel. Here training vectors are implicitly mapped into a higher (maybe infinite) dimensional space by the function $\phi$.</p>
<p>The decision function is:</p>
<p>$sgn(\sum_{i=1}^{n}y_{i}a_{i}K(x_{i},x)+\rho )$</p>
<p>These parameters can be accessed through the members dual_coef_ which holds the difference , support_vectors_ which holds the support vectors, and intercept_ which holds the independent term </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备18029472号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lsvih</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    menuSettings: {
      zoom: "None"
    },
    showMathMenu: false,
    jax: ["input/TeX","output/CommonHTML"],
    extensions: ["tex2jax.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js"],
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [["$", "$"],["\\(", "\\)"]],
      displayMath: [["\\[", "\\]"]]
    }
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  <script src="//cdn.jsdelivr.net/npm/algoliasearch@4.4.0/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4.7.1/dist/instantsearch.production.min.js"></script><script src="/js/algolia-search.js"></script>













  








  

  

  

</body>
</html>
